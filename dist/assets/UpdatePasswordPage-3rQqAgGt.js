import{r as s,e as S,u as k,s as x,j as e,m as r,a as A,B as v,L as d,I as f,p as C}from"./index-BLSLQMBf.js";import{A as b}from"./AuthLayout-BT-_UxdJ.js";const L=()=>{const[i,g]=s.useState(""),[c,y]=s.useState(""),[l,u]=s.useState(!1),[m,o]=s.useState(null),[w,j]=s.useState(!1),{toast:n}=S(),p=k();s.useEffect(()=>{const{data:{subscription:a}}=x.auth.onAuthStateChange((t,z)=>{});return()=>a.unsubscribe()},[]);const N=async a=>{if(a.preventDefault(),o(null),i!==c){o("As senhas n√£o coincidem."),n({title:"Erro",description:"As senhas n√£o coincidem.",variant:"destructive"});return}if(i.length<6){o("A senha deve ter pelo menos 6 caracteres."),n({title:"Erro",description:"A senha deve ter pelo menos 6 caracteres.",variant:"destructive"});return}u(!0);try{const{error:t}=await x.auth.updateUser({password:i});if(t)throw t;j(!0),n({title:"Senha Atualizada! üéâ",description:"Sua senha foi alterada com sucesso. Voc√™ pode fazer login agora."}),setTimeout(()=>p("/login"),3e3)}catch(t){o(t.message||"N√£o foi poss√≠vel atualizar a senha. O link pode ter expirado ou ser inv√°lido."),n({title:"Erro ao Atualizar Senha üôÅ",description:t.message||"N√£o foi poss√≠vel atualizar a senha. O link pode ter expirado ou ser inv√°lido.",variant:"destructive"})}finally{u(!1)}},h={hidden:{opacity:0,x:-15},visible:{opacity:1,x:0}};return w?e.jsx(b,{title:"Senha Atualizada!",description:"Sua senha foi alterada com sucesso.",children:e.jsxs(r.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"text-center",children:[e.jsx(A,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:"Voc√™ ser√° redirecionado para a p√°gina de login em breve."}),e.jsx(v,{onClick:()=>p("/login"),className:"bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white shadow-lg",children:"Ir para Login Agora"})]})}):e.jsx(b,{title:"Atualizar Senha",description:"Crie uma nova senha para sua conta.",children:e.jsxs("form",{onSubmit:N,className:"space-y-6",children:[e.jsxs(r.div,{variants:h,initial:"hidden",animate:"visible",transition:{delay:.1,duration:.3},children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400 dark:text-slate-500"}),e.jsx(f,{id:"password",type:"password",value:i,onChange:a=>g(a.target.value),placeholder:"Digite sua nova senha",required:!0,className:"pl-10"})]})]}),e.jsxs(r.div,{variants:h,initial:"hidden",animate:"visible",transition:{delay:.2,duration:.3},children:[e.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-1",children:"Confirme a Nova Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(d,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-slate-400 dark:text-slate-500"}),e.jsx(f,{id:"confirmPassword",type:"password",value:c,onChange:a=>y(a.target.value),placeholder:"Confirme sua nova senha",required:!0,className:"pl-10"})]})]}),m&&e.jsxs(r.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"flex items-center p-3 bg-red-100 dark:bg-red-900/30 border border-red-300 dark:border-red-700 rounded-md text-red-700 dark:text-red-300 text-sm",children:[e.jsx(C,{className:"w-5 h-5 mr-2 shrink-0"}),m]}),e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3,duration:.3},children:e.jsxs(v,{type:"submit",className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 text-white shadow-lg py-3 text-base font-semibold",disabled:l,children:[l?e.jsx(r.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full mr-2"}):e.jsx(d,{className:"w-5 h-5 mr-2"}),l?"Atualizando...":"Atualizar Senha"]})})]})})};export{L as default};
