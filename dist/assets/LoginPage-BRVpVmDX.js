import{r as t,e as q,u as P,f as F,g as I,j as e,m as o,h,M as O,I as w,L as V,i as B,k as d,B as b,l as E,n as T,s as p}from"./index-qkwE8oul.js";import{A as D}from"./AuthLayout-DUond4t2.js";import{A as G}from"./alert-circle-ywz-mxe-.js";import{L as z}from"./log-in-CdfZSQaU.js";const J=()=>{const[l,x]=t.useState(""),[f,L]=t.useState(""),[v,S]=t.useState(!0),[i,c]=t.useState(!1),[y,u]=t.useState(!1),[g,s]=t.useState(""),{toast:j}=q(),C=P(),m=F(),{refreshSettings:k}=I();t.useEffect(()=>{m.state?.showConfirmationMessage&&x(m.state.email)},[m.state]);const A=async a=>{a.preventDefault(),c(!0),u(!1),s("");try{const{data:r,error:n}=await p.auth.signInWithPassword({email:l,password:f},{shouldCreateUser:!1});if(n)throw n.message==="Email not confirmed"?(s("Seu e-mail ainda n√£o foi confirmado. Verifique sua caixa de entrada (e spam)."),u(!0)):n.message==="Invalid login credentials"?s("Credenciais inv√°lidas. Verifique seu email e senha."):s(n.message||"Ocorreu um erro ao tentar fazer login."),new Error(n.message);if(r.user&&r.session){v||await p.auth.setSession(r.session),j({title:"Login bem-sucedido! üéâ",description:"Redirecionando para o painel..."}),await k();const R=m.state?.from?.pathname||"/dashboard";C(R,{replace:!0})}else s("Ocorreu um problema inesperado. Tente novamente.")}catch(r){console.error("Login error:",r.message)}finally{c(!1)}},M=async()=>{if(!l){s("Por favor, insira seu email para reenviar a confirma√ß√£o.");return}c(!0),s("");try{const{error:a}=await p.auth.resend({type:"signup",email:l});if(a)throw a;j({title:"Email de confirma√ß√£o reenviado! üöÄ",description:"Verifique sua caixa de entrada (e spam)."}),u(!1)}catch(a){s(a.message||"N√£o foi poss√≠vel reenviar o email de confirma√ß√£o.")}finally{c(!1)}},N={hidden:{opacity:0,x:-15},visible:{opacity:1,x:0}};return e.jsxs(D,{title:"Bem-vindo de Volta!",description:"Acesse sua conta para gerenciar seu neg√≥cio.",children:[e.jsxs("form",{onSubmit:A,className:"space-y-6",children:[g&&e.jsxs(o.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-destructive/10 border border-destructive/50 text-destructive px-4 py-3 rounded-md relative flex items-start",role:"alert",children:[e.jsx(G,{className:"w-5 h-5 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"block sm:inline text-sm",children:g})]}),e.jsxs(o.div,{variants:N,initial:"hidden",animate:"visible",transition:{delay:.1,duration:.3},children:[e.jsx(h,{htmlFor:"email",children:"Email"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(O,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(w,{id:"email",type:"email",value:l,onChange:a=>x(a.target.value),placeholder:"seu@email.com",required:!0,className:"pl-10"})]})]}),e.jsxs(o.div,{variants:N,initial:"hidden",animate:"visible",transition:{delay:.2,duration:.3},children:[e.jsx(h,{htmlFor:"password",children:"Senha"}),e.jsxs("div",{className:"relative mt-1",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-muted-foreground"}),e.jsx(w,{id:"password",type:"password",value:f,onChange:a=>L(a.target.value),placeholder:"Sua senha",required:!0,className:"pl-10"})]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(B,{id:"remember-me",checked:v,onCheckedChange:S}),e.jsx(h,{htmlFor:"remember-me",className:"font-medium",children:"Mantenha-me conectado"})]}),e.jsx(d,{to:"/forgot-password",className:"font-medium text-primary hover:text-primary/80 transition-colors",children:"Esqueceu a senha?"})]}),y&&e.jsx(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1,duration:.3},children:e.jsxs(b,{type:"button",variant:"outline",className:"w-full",onClick:M,disabled:i,children:[i?e.jsx(E,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(T,{className:"w-4 h-4 mr-2"}),"Reenviar email de confirma√ß√£o"]})}),e.jsx(o.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y?.2:.3,duration:.3},children:e.jsxs(b,{type:"submit",className:"w-full",disabled:i,children:[i?e.jsx(E,{className:"w-5 h-5 mr-2 animate-spin"}):e.jsx(z,{className:"w-5 h-5 mr-2"}),i?"Entrando...":"Entrar"]})})]}),e.jsxs("p",{className:"mt-8 text-center text-sm text-muted-foreground",children:["N√£o tem uma conta?"," ",e.jsx(d,{to:"/signup",className:"font-medium text-primary hover:text-primary/80 transition-colors",children:"Cadastre-se aqui"})]}),e.jsxs("div",{className:"mt-6 text-center text-xs text-muted-foreground",children:[e.jsxs("p",{children:["Ao continuar, voc√™ concorda com nossa"," ",e.jsx(d,{to:"/politica-de-privacidade-e-dados",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-primary transition-colors",children:"Pol√≠tica de Privacidade e Dados"}),"."]}),e.jsx("p",{className:"mt-2",children:e.jsx(d,{to:"/lp",className:"underline hover:text-primary transition-colors",children:"Conhe√ßa o GO.FOT√ìGRAFO"})})]})]})};export{J as default};
