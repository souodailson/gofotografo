import{c as _,j as e,m as b,au as $,B as p,A as L,n as F,u as k,a3 as T,p as R,T as z,Q as S,V as A,W as M,X as B,Y as P,ae as U,r as w,I as W,a5 as Y,q as Q,t as X,v as Z,x as J,av as K,e as ee,s as D}from"./index-BLSLQMBf.js";import{A as te,a as ae,b as se,c as re,d as oe,e as ie,f as ne,g as le,h as ce}from"./alert-dialog-CyCTn1Rm.js";import{S as de}from"./share-2-B4vbJ8gD.js";import{E as me}from"./eye-CLkVh5C4.js";import{P as ue}from"./pen-square-DjD69RmB.js";import{B as xe}from"./badge-CB9TUEzb.js";import{f as he}from"./formatDistanceToNow-DUwD8m_3.js";import{p as pe}from"./pt-BR-DPdF7AXa.js";import{F as fe}from"./file-plus-BEzts9cG.js";import{S as ge}from"./search-DJ0MWB75.js";import{H as je,G as ve,B as be,a as we}from"./heart-handshake-BobhzmYi.js";import{C as Ne}from"./cake-CdFe_PrC.js";import"./constructNow---ucJfcM.js";import"./endOfDay-C8LREYbK.js";import"./endOfMonth-DNVfFewk.js";const y=_("FileSignature",[["path",{d:"M20 19.5v.5a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8.5L18 5.5",key:"kd5d3"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.42 9.61a2.1 2.1 0 1 1 2.97 2.97L16.95 17 13 18l.99-3.95 4.43-4.44Z",key:"johvi5"}]]),Ce=_("SquareStack",[["path",{d:"M4 10c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"4i38lg"}],["path",{d:"M10 16c-1.1 0-2-.9-2-2v-4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2",key:"mlte4a"}],["rect",{width:"8",height:"8",x:"14",y:"14",rx:"2",key:"1fa9i4"}]]),ye={hidden:{opacity:0,y:20},visible:t=>({opacity:1,y:0,transition:{delay:t*.1,duration:.5,ease:"easeOut"}})},C=({icon:t,title:s,description:r,buttonText:d,onClick:n,custom:a,comingSoon:u})=>e.jsxs(b.div,{variants:ye,custom:a,className:"relative group bg-card/50 dark:bg-card/40 backdrop-blur-sm border border-border/20 rounded-2xl p-6 flex flex-col text-center items-center hover:border-primary/50 transition-all duration-300",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-white/5 to-transparent rounded-2xl"}),e.jsxs("div",{className:"relative z-10 flex flex-col items-center h-full",children:[e.jsx("div",{className:"p-4 bg-primary/10 rounded-full mb-4 group-hover:scale-110 transition-transform",children:t}),e.jsx("h3",{className:"text-lg font-bold mb-2 text-foreground",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground mb-6 flex-grow",children:r}),e.jsxs(p,{onClick:n,className:"w-full mt-auto",disabled:u,children:[u?"Em Breve":d,!u&&e.jsx(L,{className:"w-4 h-4 ml-2"})]})]})]}),ke=({onNewProposal:t,onNewContract:s,onViewTemplates:r})=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold tracking-tight text-foreground",children:"GO.STUDIO"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Seu centro de criação para propostas e contratos profissionais."})]}),e.jsxs(b.div,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:[e.jsx(C,{icon:e.jsx($,{className:"w-8 h-8 text-primary"}),title:"Nova Proposta",description:"Crie propostas visuais e interativas para encantar seus clientes.",buttonText:"Começar a criar",onClick:t,custom:0}),e.jsx(C,{icon:e.jsx(y,{className:"w-8 h-8 text-primary"}),title:"Novo Contrato",description:"Gere contratos seguros e com validade jurídica em minutos.",buttonText:"Criar contrato",onClick:s,custom:1}),e.jsx(C,{icon:e.jsx(Ce,{className:"w-8 h-8 text-primary"}),title:"Templates",description:"Use modelos prontos para agilizar a criação de propostas e contratos.",buttonText:"Ver modelos",onClick:r,custom:2,comingSoon:!0})]})]}),De={hidden:{opacity:0,y:20},visible:t=>({opacity:1,y:0,transition:{delay:t*.1,duration:.5,ease:"easeOut"}})},v={default:"https://rouvkvcngmsquebokdyg.supabase.co/storage/v1/object/public/gofiles//fundo%20liquid%20gofotografo%20wihtout%20grain%20-%20vertical.jpg",casamento:"https://plus.unsplash.com/premium_photo-1675003662150-2569448d2b3b?q=80&w=774&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",gestante:"https://images.unsplash.com/photo-1542286322-b1241fe63a5f?q=80&w=808&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",aniversario:"https://images.unsplash.com/photo-1642005950606-dfa0b6f29d43?q=80&w=774&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",ensaio:"https://rouvkvcngmsquebokdyg.supabase.co/storage/v1/object/public/gofiles//fundo%20liquid%20gofotografo%20wihtout%20grain%20-%20vertical.jpg",corporativo:"https://rouvkvcngmsquebokdyg.supabase.co/storage/v1/object/public/gofiles//fundo%20liquid%20gofotografo%20wihtout%20grain%20-%20vertical.jpg"},_e=({proposal:t,onShare:s,onDelete:r,onEdit:d})=>{const n=k(),{getClientById:a}=T(),u=t.client_id?a(t.client_id):null,l=(()=>{if(t.thumbnail_url)return t.thumbnail_url;const o=u?.tags?.find(g=>v[g.toLowerCase()]);if(o)return v[o.toLowerCase()];const f=Object.keys(v).find(g=>t.nome_da_proposta.toLowerCase().includes(g));return f?v[f]:v.default})(),c=!t.thumbnail_url,N=o=>{o.stopPropagation(),d(t.id)},h=(o,f)=>{o.stopPropagation(),f()};return e.jsxs(b.div,{variants:De,className:"relative aspect-[3/4] w-72 flex-shrink-0 overflow-hidden rounded-2xl shadow-lg group cursor-pointer",onClick:N,children:[e.jsx("img",{src:l,alt:t.nome_da_proposta,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/70 via-black/30 to-transparent"}),c&&e.jsxs("div",{className:"absolute top-3 left-3 bg-black/50 text-white text-xs px-2 py-1 rounded-full flex items-center gap-1 z-10",children:[e.jsx(R,{className:"h-3 w-3"}),"Capa ilustrativa"]}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 text-white",children:[e.jsx("h3",{className:"text-xl font-bold truncate",children:t.nome_da_proposta}),e.jsx("p",{className:"text-sm text-white/80 truncate",children:u?`Cliente: ${u.name}`:"Sem cliente vinculado"}),e.jsxs("div",{className:"mt-4 flex justify-end items-center gap-2 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:[e.jsx(p,{variant:"ghost",size:"icon",className:"text-white/80 hover:bg-white/20 hover:text-white rounded-full",onClick:o=>h(o,()=>s(t.id)),children:e.jsx(de,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",className:"text-white/80 hover:bg-white/20 hover:text-white rounded-full",onClick:o=>h(o,()=>n(`/studio/proposals/view/${t.id}`)),children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",className:"text-white/80 hover:bg-white/20 hover:text-white rounded-full",onClick:o=>h(o,()=>d(t.id)),children:e.jsx(ue,{className:"h-4 w-4"})}),e.jsxs(te,{children:[e.jsx(ae,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"text-red-400 hover:bg-red-500/20 hover:text-red-300 rounded-full",onClick:o=>h(o,()=>{}),children:e.jsx(z,{className:"h-4 w-4"})})}),e.jsxs(se,{onClick:o=>o.stopPropagation(),children:[e.jsxs(re,{children:[e.jsx(oe,{children:"Você tem certeza?"}),e.jsx(ie,{children:"Esta ação não pode ser desfeita. Isso excluirá permanentemente a proposta."})]}),e.jsxs(ne,{children:[e.jsx(le,{children:"Cancelar"}),e.jsx(ce,{onClick:()=>r(t.id),children:"Excluir"})]})]})]})]})]})]})},Te=({proposals:t,onShare:s,onDelete:r,onEdit:d})=>e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(F,{className:"w-6 h-6 mr-3 text-primary"})," Propostas Recentes"]}),t.length>0?e.jsx("div",{className:"flex space-x-6 overflow-x-auto pb-4 -mx-6 px-6",children:t.map(n=>e.jsx(_e,{proposal:n,onShare:s,onDelete:r,onEdit:d},n.id))}):e.jsx("p",{className:"text-muted-foreground p-4 text-center border-dashed border rounded-lg",children:"Nenhuma proposta recente."})]}),Se={hidden:{opacity:0,y:20},visible:t=>({opacity:1,y:0,transition:{delay:t*.1,duration:.5,ease:"easeOut"}})},Ae=({icon:t,title:s,subtitle:r,date:d,statusVariant:n,statusText:a,onClick:u})=>e.jsxs(b.div,{variants:Se,className:"bg-card/50 dark:bg-card/40 backdrop-blur-sm border border-border/20 rounded-lg p-3 flex items-center gap-3 hover:bg-muted/30 cursor-pointer transition-colors",onClick:u,children:[e.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:t}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h4",{className:"font-semibold truncate text-sm",children:s}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:r})]}),e.jsxs("div",{className:"text-right flex-shrink-0",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:he(new Date(d),{addSuffix:!0,locale:pe})}),e.jsx(xe,{variant:n,className:"mt-1 text-xs",children:a})]})]}),Me=({contracts:t,getClientById:s})=>{const r=k(),d=a=>{switch(a?.toLowerCase()){case"assinado":return"success";case"pendente":return"warning";case"recusado":return"destructive";case"draft":return"outline";default:return"secondary"}},n=a=>{r(`/contracts/editor/${a.id}`)};return e.jsxs("div",{className:"mt-12",children:[e.jsxs("h2",{className:"text-2xl font-semibold mb-4 flex items-center",children:[e.jsx(y,{className:"w-6 h-6 mr-3 text-primary"})," Contratos Recentes"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.length>0?t.map(a=>e.jsx(Ae,{icon:e.jsx(y,{className:"w-5 h-5 text-primary"}),title:a.titulo_contrato,subtitle:`Cliente: ${s(a.id_cliente)?.name||"N/A"}`,date:a.data_geracao,statusVariant:d(a.status_assinatura),statusText:a.status_assinatura||"Rascunho",onClick:()=>n(a)},a.id)):e.jsx("p",{className:"text-muted-foreground p-4 text-center border-dashed border rounded-lg md:col-span-2",children:"Nenhum contrato recente."})})]})},Be=({isOpen:t,onOpenChange:s,onAction:r})=>e.jsx(S,{open:t,onOpenChange:s,children:e.jsxs(A,{children:[e.jsxs(M,{children:[e.jsx(B,{children:"Novo Contrato"}),e.jsx(P,{children:"Gere contratos seguros e com validade jurídica em minutos."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:[e.jsxs(p,{variant:"outline",className:"h-24 flex flex-col gap-2",onClick:()=>r("blank"),children:[e.jsx(fe,{className:"w-8 h-8"}),e.jsx("span",{children:"Criar em Branco"})]}),e.jsxs(p,{variant:"outline",className:"h-24 flex flex-col gap-2",onClick:()=>r("template"),children:[e.jsx(U,{className:"w-8 h-8"}),e.jsx("span",{children:"Usar um Modelo"})]})]})]})}),Pe=({isOpen:t,onOpenChange:s,templates:r,onUseTemplate:d})=>{const[n,a]=w.useState(""),u=l=>{const c=l.toLowerCase();return c.includes("casamento")||c.includes("noivos")?e.jsx(je,{className:"w-5 h-5 text-primary flex-shrink-0"}):c.includes("formatura")?e.jsx(ve,{className:"w-5 h-5 text-primary flex-shrink-0"}):c.includes("parto")||c.includes("nascimento")||c.includes("newborn")?e.jsx(be,{className:"w-5 h-5 text-primary flex-shrink-0"}):c.includes("aniversário")||c.includes("festa")?e.jsx(Ne,{className:"w-5 h-5 text-primary flex-shrink-0"}):c.includes("ensaio")?e.jsx(K,{className:"w-5 h-5 text-primary flex-shrink-0"}):e.jsx(we,{className:"w-5 h-5 text-primary flex-shrink-0"})},x=r.filter(l=>l.nome_modelo.toLowerCase().includes(n.toLowerCase()));return e.jsx(S,{open:t,onOpenChange:s,children:e.jsxs(A,{className:"sm:max-w-3xl h-[80vh] flex flex-col",children:[e.jsxs(M,{children:[e.jsx(B,{children:"Galeria de Modelos de Contrato"}),e.jsx(P,{children:"Escolha um modelo para começar. Você poderá editá-lo completamente."})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ge,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(W,{placeholder:"Buscar por nome ou nicho...",className:"pl-9",value:n,onChange:l=>a(l.target.value)})]}),e.jsx(Y,{className:"flex-grow pr-4 -mr-4",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 py-4",children:x.map(l=>e.jsxs(Q,{className:"cursor-pointer hover:shadow-lg hover:border-primary transition-all duration-200 flex flex-col",onClick:()=>d(l),children:[e.jsx(X,{className:"pb-2",children:e.jsxs(Z,{className:"text-base flex items-start gap-2",children:[u(l.nome_modelo),e.jsx("span",{className:"flex-1",children:l.nome_modelo})]})}),e.jsx(J,{className:"flex-grow",children:e.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:l.description||"Este modelo não possui uma descrição."})})]},l.id))})})]})})},Qe=()=>{const t=k(),{user:s,proposals:r,contratos:d,getClientById:n,refreshData:a,deleteProposal:u}=T(),{toast:x}=ee(),[l,c]=w.useState(!1),[N,h]=w.useState(!1),[o,f]=w.useState([]),g=()=>{x({title:"🚧 Em breve!",description:"Esta funcionalidade ainda está em desenvolvimento. Fique de olho!"})},E=async i=>{if(c(!1),i==="blank")t("/studio/contracts/new");else if(i==="template")try{const{data:m,error:j}=await D.from("modeloscontrato").select("*").or("status.eq.publico",`user_id.eq.${s.id}`);if(j)throw j;f(m),h(!0)}catch(m){x({title:"Erro",description:`Não foi possível carregar os modelos de contrato: ${m.message}`,variant:"destructive"})}},H=async i=>{h(!1);try{const{data:m,error:j}=await D.from("contratosgerados").insert({id_fotografo:s.id,id_modelo:i.id,titulo_contrato:`${i.nome_modelo} (Cópia)`,conteudo_final:i.conteudo_template,status_assinatura:"draft"}).select("id").single();if(j)throw j;await a("contratos"),t(`/studio/contracts/edit/${m.id}`)}catch(m){x({title:"Erro ao criar contrato do modelo",description:m.message,variant:"destructive"})}},q=i=>{const m=`${window.location.origin}/studio/view/${i}`;navigator.clipboard.writeText(m),x({title:"Link Copiado!",description:"O link da proposta foi copiado para a área de transferência."})},O=async i=>{try{await u(i),x({title:"Proposta Excluída",description:"A proposta foi removida com sucesso."})}catch{x({title:"Erro ao Excluir",description:"Não foi possível remover a proposta.",variant:"destructive"})}},I=i=>{t(`/studio/proposals/edit/${i}`)},V=r.sort((i,m)=>new Date(m.updated_at)-new Date(i.updated_at)),G=(d||[]).sort((i,m)=>new Date(m.data_geracao)-new Date(i.data_geracao)).slice(0,4);return e.jsxs(b.div,{initial:"hidden",animate:"visible",className:"p-4 sm:p-6",children:[e.jsx(ke,{onNewProposal:()=>t("/studio/proposals/new"),onNewContract:()=>c(!0),onViewTemplates:g}),e.jsx(Te,{proposals:V,onShare:q,onDelete:O,onEdit:I}),e.jsx(Me,{contracts:G,getClientById:n}),e.jsx(Be,{isOpen:l,onOpenChange:c,onAction:E}),e.jsx(Pe,{isOpen:N,onOpenChange:h,templates:o,onUseTemplate:H})]})};export{Qe as default};
