import{c as k,r as n,e as R,j as e,Q as I,V as O,W as V,X as q,cn as L,Y as B,h as M,I as S,a2 as z,B as C,l as E,a3 as pe,b as fe,q as $,t as H,v as U,x as W,o as je,aW as ve,m as ge,w as Ne,K as be,N as ye,O as we,P as D,T as Ce}from"./index-hGCyqJo1.js";import{P as Me}from"./progress-BTsvLJtM.js";import{A as K,b as Q,c as X,d as Y,e as J,f as Z,h as ee,a as Se,g as De}from"./alert-dialog-w4HeuV8X.js";import{P as se}from"./pen-line-DZDg-o23.js";import{P as Ae}from"./plus-circle-CG3nqV41.js";import{T as Pe}from"./target-JVkB5JcL.js";import{A as ke}from"./alert-circle-BYWNW9MC.js";import{M as Ee}from"./more-horizontal-BzdU5MR2.js";const ae=k("ArrowDownCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]]),te=k("ArrowUpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]]),Ge=k("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]),Te=({isOpen:s,onClose:h,onSave:g,goalData:o,isLoading:c})=>{const[d,l]=n.useState(""),[i,u]=n.useState(""),[t,p]=n.useState(""),{toast:f}=R();n.useEffect(()=>{o?(l(o.nome_meta||""),u(o.valor_meta?.toString()||""),p(o.icone||"")):(l(""),u(""),p(""))},[o,s]);const N=r=>{if(r.preventDefault(),!d.trim()){f({title:"Campo Obrigatório",description:"Por favor, preencha o Nome da Meta.",variant:"destructive"});return}if(!i||parseFloat(i)<=0){f({title:"Valor Inválido",description:"O Valor da Meta deve ser maior que zero.",variant:"destructive"});return}g({nome_meta:d,valor_meta:parseFloat(i),icone:t})},j=o?"Editar Meta de Reserva":"Nova Meta de Reserva",b=o?"Atualize os detalhes da sua meta de economia.":"Defina um novo objetivo para suas economias.",y=o?e.jsx(se,{className:"mr-2 h-4 w-4"}):e.jsx(Ge,{className:"mr-2 h-4 w-4"}),x=o?"Salvar Alterações":"Criar Meta";return e.jsx(I,{open:s,onOpenChange:h,children:e.jsxs(O,{className:"sm:max-w-md shadow-2xl border-border",children:[e.jsxs(V,{children:[e.jsxs(q,{className:"flex items-center text-2xl font-bold text-foreground",children:[e.jsx(L,{className:"mr-3 h-7 w-7 text-customPurple"}),j]}),e.jsx(B,{className:"text-muted-foreground",children:b})]}),e.jsxs("form",{onSubmit:N,className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"nomeMeta",className:"text-muted-foreground",children:"Nome da Meta*"}),e.jsx(S,{id:"nomeMeta",value:d,onChange:r=>l(r.target.value),placeholder:"Ex: Câmera Nova, Viagem dos Sonhos",className:"mt-1 bg-input border-border focus:border-customPurple",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"valorMeta",className:"text-muted-foreground",children:"Valor da Meta (R$)*"}),e.jsx(S,{id:"valorMeta",type:"number",value:i,onChange:r=>u(r.target.value),placeholder:"Ex: 15000",className:"mt-1 bg-input border-border focus:border-customPurple",min:"0.01",step:"0.01",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"icone",className:"text-muted-foreground",children:"Ícone (Opcional)"}),e.jsx(S,{id:"icone",value:t,onChange:r=>p(r.target.value),placeholder:"Ex: 📸, ✈️, 🏠 (Copie e cole um emoji)",className:"mt-1 bg-input border-border focus:border-customPurple"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Dica: Use um emoji para identificar sua meta visualmente!"})]}),e.jsxs(z,{className:"pt-4",children:[e.jsx(C,{type:"button",variant:"outline",onClick:h,className:"mr-2",children:"Cancelar"}),e.jsxs(C,{type:"submit",disabled:c,className:"btn-custom-gradient",children:[c?e.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"}):y,c?o?"Salvando...":"Criando...":x]})]})]})]})})},_e=({isOpen:s,onClose:h,onSave:g,goalData:o,transactionType:c,isLoading:d})=>{const[l,i]=n.useState(""),[u,t]=n.useState(""),[p,f]=n.useState({});n.useEffect(()=>{s&&(i(""),t(""),f({}))},[s]);const N=()=>{const r={};return(!l||isNaN(parseFloat(l))||parseFloat(l)<=0)&&(r.valor="Por favor, insira um valor válido."),f(r),Object.keys(r).length===0},j=r=>{r.preventDefault(),N()&&g({valor:l,descricao:u})};if(!o)return null;const b=c==="deposit"?"Depositar na Reserva":"Sacar da Reserva",y=c==="deposit"?te:ae,x=c==="deposit"?"text-green-500":"text-red-500";return e.jsx(I,{open:s,onOpenChange:h,children:e.jsxs(O,{className:"sm:max-w-[425px] border-border shadow-xl",children:[e.jsxs(V,{children:[e.jsxs(q,{className:"flex items-center text-xl",children:[e.jsx(y,{className:`w-6 h-6 mr-2 ${x}`}),b,": ",e.jsx("span",{className:"ml-1 font-semibold text-customPurple",children:o.nome_meta})]}),e.jsx(B,{children:c==="deposit"?"Adicione fundos à sua meta de reserva.":"Retire fundos da sua meta de reserva."})]}),e.jsxs("form",{onSubmit:j,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(M,{htmlFor:"valor",className:"text-foreground",children:"Valor (R$)"}),e.jsx(S,{id:"valor",type:"number",step:"0.01",value:l,onChange:r=>i(r.target.value),placeholder:"Ex: 50,00",className:`bg-input border-input-border ${p.valor?"border-red-500":""}`}),p.valor&&e.jsx("p",{className:"text-xs text-red-500 mt-1",children:p.valor})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(M,{htmlFor:"descricao",className:"text-foreground",children:"Descrição (Opcional)"}),e.jsx(S,{id:"descricao",value:u,onChange:r=>t(r.target.value),placeholder:c==="deposit"?"Ex: Bônus de Fim de Ano":"Ex: Conserto da Lente",className:"bg-input border-input-border"})]})]}),e.jsxs(z,{children:[e.jsx(C,{type:"button",variant:"outline",onClick:h,disabled:d,children:"Cancelar"}),e.jsxs(C,{type:"submit",className:"btn-custom-gradient",disabled:d,children:[d?e.jsx(E,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Confirmar ",c==="deposit"?"Depósito":"Saque"]})]})]})]})})},Fe=({goal:s,onEdit:h,onDelete:g,onDeposit:o,onWithdraw:c,toast:d})=>{const l=s.valor_meta>0?s.saldo_atual/s.valor_meta*100:0,i=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),u=t=>t>=100?"bg-green-500":t>=75?"bg-customGreen":t>=50?"bg-yellow-500":t>=25?"bg-orange-500":"bg-red-500";return e.jsx(ge.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"gradient-border-card",children:e.jsxs($,{className:"card-content-inner shadow-lg flex flex-col h-full",children:[e.jsxs(H,{className:"flex flex-row items-start justify-between pb-3",children:[e.jsxs("div",{children:[e.jsxs(U,{className:"text-xl font-semibold text-foreground flex items-center",children:[s.icone&&e.jsx("span",{className:"mr-2 text-2xl",children:s.icone}),s.nome_meta]}),e.jsxs(Ne,{className:"text-sm text-muted-foreground",children:["Meta: ",i(s.valor_meta)]})]}),e.jsxs(be,{children:[e.jsx(ye,{asChild:!0,children:e.jsx(C,{variant:"ghost",size:"icon",className:"h-8 w-8 text-muted-foreground hover:text-foreground",children:e.jsx(Ee,{className:"h-5 w-5"})})}),e.jsxs(we,{align:"end",children:[e.jsxs(D,{onClick:()=>h(s),className:"cursor-pointer",children:[e.jsx(se,{className:"mr-2 h-4 w-4"})," Editar Meta"]}),e.jsxs(D,{onClick:()=>o(s),className:"cursor-pointer",children:[e.jsx(te,{className:"mr-2 h-4 w-4 text-green-500"})," Depositar"]}),e.jsxs(D,{onClick:()=>c(s),className:"cursor-pointer",children:[e.jsx(ae,{className:"mr-2 h-4 w-4 text-red-500"})," Sacar / Gastar"]}),e.jsxs(K,{children:[e.jsx(Se,{asChild:!0,children:e.jsxs(D,{onSelect:t=>t.preventDefault(),className:"text-red-600 hover:!text-red-700 cursor-pointer",children:[e.jsx(Ce,{className:"mr-2 h-4 w-4"})," Excluir Meta"]})}),e.jsxs(Q,{children:[e.jsxs(X,{children:[e.jsx(Y,{children:"Confirmar Exclusão"}),e.jsxs(J,{children:['Tem certeza que deseja excluir a meta "',s.nome_meta,'"? Esta ação não pode ser desfeita.']})]}),e.jsxs(Z,{children:[e.jsx(De,{children:"Cancelar"}),e.jsx(ee,{onClick:()=>g(s.id),className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})]})]})]})]}),e.jsx(W,{className:"flex-grow flex flex-col justify-between",children:e.jsxs("div",{children:[e.jsx("div",{className:"mb-2",children:e.jsx(Me,{value:l,className:"w-full h-3",indicatorClassName:u(l)})}),e.jsxs("p",{className:"text-sm font-medium text-foreground text-center",children:[i(s.saldo_atual)," / ",i(s.valor_meta),e.jsxs("span",{className:`ml-1 font-semibold ${l>=100?"text-green-500":"text-customPurple"}`,children:["(",l.toFixed(1),"%)"]})]})]})})]})})},$e=()=>{const{savingGoals:s,addSavingGoal:h,updateSavingGoal:g,deleteSavingGoal:o,updateSavingGoalBalance:c,loading:d,refreshData:l,user:i}=pe(),[u,t]=n.useState(!1),[p,f]=n.useState(!1),[N,j]=n.useState(null),[b,y]=n.useState(null),[x,r]=n.useState("deposit"),[G,w]=n.useState(!1),[re,A]=n.useState(!1),[T,oe]=n.useState({title:"",message:""}),{toast:v}=R(),{isMobile:le}=fe();n.useEffect(()=>{i?.id&&!d&&l(i,"metas_reserva")},[i?.id,l]);const ne=()=>{j(null),t(!0)},ie=a=>{j(a),t(!0)},ce=async a=>{w(!0);try{await o(a),v({title:"Sucesso!",description:"Meta de reserva excluída."})}catch(m){v({title:"Erro ao excluir",description:m.message||"Não foi possível excluir a meta.",variant:"destructive"})}finally{w(!1)}},de=async a=>{w(!0);const m={nome_meta:a.nome_meta,valor_meta:parseFloat(a.valor_meta)||0,icone:a.icone||null};try{N?(await g(N.id,m),v({title:"Sucesso!",description:"Meta de reserva atualizada."})):(await h({...m,saldo_atual:0}),v({title:"Sucesso!",description:"Nova meta de reserva adicionada."})),t(!1),j(null)}catch(P){v({title:"Erro ao salvar meta",description:P.message||"Não foi possível salvar a meta.",variant:"destructive"})}finally{w(!1)}},_=(a,m)=>{y(a),r(m),f(!0)},me=async a=>{if(!b)return;w(!0);const m=parseFloat(a.valor),P=a.descricao;try{await c(b.id,m,P,x),v({title:"Sucesso!",description:`${x==="deposit"?"Depósito":"Saque"} registrado e saldo da meta atualizado.`}),f(!1),y(null),oe({title:"Ação Registrada com Sucesso!",message:x==="deposit"?"Lembre-se: esta plataforma é uma ferramenta de organização. Para que sua reserva funcione de verdade, não se esqueça de transferir este valor na sua conta bancária real destinada às suas reservas!":"Lembre-se de registrar esta retirada também no seu controle bancário real para manter tudo sincronizado."}),A(!0)}catch(he){v({title:`Erro ao ${x==="deposit"?"depositar":"sacar"}`,description:he.message||`Não foi possível registrar o ${x==="deposit"?"depósito":"saque"}.`,variant:"destructive"})}finally{w(!1)}},ue=s.reduce((a,m)=>a+Number(m.valor_meta),0),xe=s.reduce((a,m)=>a+Number(m.saldo_atual),0),F=a=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(a);return e.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8",children:[e.jsxs("header",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:le?"hidden":"",children:[e.jsxs("h1",{className:"text-3xl sm:text-4xl font-extrabold text-foreground flex items-center titulo-gradiente",children:[e.jsx(L,{className:"w-10 h-10 mr-3 text-customPurple animate-bounce"}),"Reserva Inteligente"]}),e.jsx("p",{className:"text-muted-foreground mt-1 max-w-2xl",children:'Crie suas "caixinhas" de economia e acompanhe o progresso para alcançar seus objetivos financeiros.'})]}),e.jsxs(C,{onClick:ne,className:"btn-custom-gradient shadow-lg hover:opacity-90 transition-opacity",children:[e.jsx(Ae,{className:"w-5 h-5 mr-2"}),"Nova Meta"]})]}),s.length>0&&e.jsxs($,{className:"shadow-lg border-l-4 border-customGreen dark:border-customPurple",children:[e.jsx(H,{children:e.jsxs(U,{className:"text-xl font-semibold text-foreground flex items-center",children:[e.jsx(Pe,{className:"w-6 h-6 mr-2 text-customGreen"}),"Resumo das Metas"]})}),e.jsxs(W,{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-center md:text-left",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Valor Total das Metas"}),e.jsx("p",{className:"text-2xl font-bold text-customPurple",children:F(ue)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-muted-foreground",children:"Saldo Total Atual"}),e.jsx("p",{className:"text-2xl font-bold text-customGreen",children:F(xe)})]})]})]}),d&&s.length===0&&!i?.id?e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-16",children:[e.jsx(E,{className:"h-16 w-16 text-customPurple animate-spin mb-4"}),e.jsx("p",{className:"text-xl font-semibold text-muted-foreground",children:"Carregando suas metas..."})]}):!d&&s.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center text-center py-16 border-2 border-dashed border-border rounded-lg bg-card",children:[e.jsx(ke,{className:"h-16 w-16 text-muted-foreground opacity-50 mb-4"}),e.jsx("p",{className:"text-xl font-semibold text-muted-foreground",children:"Nenhuma meta de reserva criada ainda."}),e.jsx("p",{className:"text-muted-foreground mt-2",children:'Clique em "+ Nova Meta" para começar a planejar seus sonhos!'})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.jsx(je,{children:s.map(a=>e.jsx(Fe,{goal:a,onEdit:ie,onDelete:ce,onDeposit:()=>_(a,"deposit"),onWithdraw:()=>_(a,"withdraw"),toast:v},a.id))})}),e.jsx(Te,{isOpen:u,onClose:()=>{t(!1),j(null)},onSave:de,goalData:N,isLoading:G}),e.jsx(_e,{isOpen:p,onClose:()=>{f(!1),y(null)},onSave:me,goalData:b,transactionType:x,isLoading:G}),e.jsx(K,{open:re,onOpenChange:A,children:e.jsxs(Q,{children:[e.jsxs(X,{children:[e.jsxs(Y,{className:"flex items-center",children:[e.jsx(ve,{className:"w-6 h-6 mr-2 text-customPurple"}),T.title]}),e.jsx(J,{className:"pt-2",children:T.message})]}),e.jsx(Z,{children:e.jsx(ee,{onClick:()=>A(!1),children:"Entendi!"})})]})})]})};export{$e as default};
