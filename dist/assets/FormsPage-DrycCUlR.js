import{c as N,j as e,o as k,m as c,B as l,ay as F,a3 as A,u as E,e as S,r as d,ax as _,ae as L,aB as M,T as D,s as p}from"./index-BNk_ELpO.js";import{A as T,a as O,b as P,c as z,d as B,e as H,f as R,g as V,h as $}from"./alert-dialog-B6TPqobf.js";import{u as I}from"./useCardHoverEffect-CMU0BC1O.js";import{U as W}from"./user-plus-CD6WyDhy.js";import{M as Q}from"./megaphone-r9R4WjoI.js";import{M as U}from"./message-square-Bf4Ps9kY.js";import{F as X}from"./file-plus-Cj2jdYiG.js";import{F as Z}from"./FormSuccessModal-OaybnLZC.js";import{S as G}from"./share-2-Dja4G2qI.js";import{P as J}from"./pen-square-HhLDL8DZ.js";import"./copy-FB_ryr5R.js";const K=N("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]),f=({icon:o,title:r,description:i,onClick:n})=>{const a=I();return e.jsxs(c.div,{ref:a,whileHover:{y:-5,scale:1.02},transition:{type:"spring",stiffness:300},onClick:n,className:"bg-card rounded-xl p-6 shadow-lg border border-border card-hover-effect flex flex-col items-center text-center cursor-pointer",children:[e.jsx("div",{className:"bg-primary/10 p-4 rounded-full mb-4",children:e.jsx(o,{className:"w-8 h-8 text-primary"})}),e.jsx("h3",{className:"font-semibold text-lg text-foreground mb-2",children:r}),e.jsx("p",{className:"text-sm text-muted-foreground flex-grow",children:i})]})},Y=({isOpen:o,onClose:r,onSelectTemplate:i})=>{const n=[{type:"client_registration",icon:W,title:"Cadastro de Cliente",description:"Ideal para coletar informações básicas de novos clientes de forma rápida e direta."},{type:"client_and_briefing",icon:K,title:"Cadastro + Briefing",description:"Combine o cadastro do cliente com um briefing detalhado para entender suas necessidades."},{type:"lead_campaign",icon:Q,title:"Campanha de Leads",description:"Capture contatos de potenciais clientes para suas campanhas de marketing."},{type:"feedback",icon:U,title:"Pesquisa de Feedback",description:"Receba feedbacks construtivos dos seus clientes para melhorar seus serviços."}];return e.jsx(k,{children:o&&e.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[5000]",children:e.jsxs(c.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{duration:.3,ease:"easeInOut"},className:"bg-background rounded-2xl p-8 w-full max-w-4xl shadow-2xl max-h-[90vh] flex flex-col relative",children:[e.jsx(l,{variant:"ghost",size:"icon",onClick:r,className:"absolute top-4 right-4 text-muted-foreground",children:e.jsx(F,{})}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-foreground",children:"Criar Novo Formulário"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Escolha um modelo para começar ou crie um do zero."})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8 overflow-y-auto pr-2 scrollbar-thin",children:[e.jsx(f,{icon:X,title:"Começar do Zero",description:"Crie um formulário totalmente personalizado, adicionando suas próprias perguntas.",onClick:()=>i("blank")}),n.map(a=>e.jsx(f,{icon:a.icon,title:a.title,description:a.description,onClick:()=>i(a.type)},a.type))]})]})})})},ee={client_registration:{title:"Cadastro de Cliente",description:"Formulário para coletar informações básicas de novos clientes.",questions:[{question_text:"Nome completo",question_type:"short_text",is_required:!0,maps_to_field:"name"},{question_text:"E-mail",question_type:"email",is_required:!0,maps_to_field:"email"},{question_text:"Telefone com WhatsApp",question_type:"phone",is_required:!0,maps_to_field:"phone"},{question_text:"Tipo de ensaio ou evento",question_type:"short_text",is_required:!1},{question_text:"Data do evento (se houver)",question_type:"short_text",is_required:!1},{question_text:"Local do evento (cidade/bairro)",question_type:"short_text",is_required:!1},{question_text:"Como chegou até mim?",question_type:"short_text",is_required:!1},{question_text:"Observações adicionais",question_type:"long_text",is_required:!1}]},client_and_briefing:{title:"Cadastro + Briefing",description:"Combine o cadastro do cliente com um briefing detalhado.",questions:[{question_text:"Nome completo",question_type:"short_text",is_required:!0,maps_to_field:"name"},{question_text:"E-mail",question_type:"email",is_required:!0,maps_to_field:"email"},{question_text:"WhatsApp",question_type:"phone",is_required:!0,maps_to_field:"phone"},{question_text:"Data do evento/ensaio",question_type:"short_text",is_required:!0},{question_text:"Local (cidade/bairro)",question_type:"short_text",is_required:!1},{question_text:"Tipo de ensaio (ex: casal, gestante, aniversário)",question_type:"short_text",is_required:!0},{question_text:"Objetivo do ensaio",question_type:"long_text",is_required:!1},{question_text:"Estilo preferido de fotos (espontâneo, clássicas, etc.)",question_type:"short_text",is_required:!1},{question_text:"Sugestão de roupas ou cores",question_type:"long_text",is_required:!1},{question_text:"Link de pastinha do Pinterest (se tiver)",question_type:"short_text",is_required:!1},{question_text:"Observações extras",question_type:"long_text",is_required:!1}]},lead_campaign:{title:"Campanha de Leads",description:"Formulário rápido para capturar leads em campanhas de marketing.",questions:[{question_text:"Nome completo",question_type:"short_text",is_required:!0,maps_to_field:"name"},{question_text:"WhatsApp",question_type:"phone",is_required:!0,maps_to_field:"phone"},{question_text:"E-mail",question_type:"email",is_required:!0,maps_to_field:"email"},{question_text:"Tipo de ensaio que você quer",question_type:"short_text",is_required:!1},{question_text:"Cidade / região",question_type:"short_text",is_required:!1},{question_text:"Quando pretende fazer o ensaio?",question_type:"short_text",is_required:!1}]},feedback:{title:"Pesquisa de Feedback",description:"Receba feedbacks construtivos dos seus clientes.",questions:[{question_text:"Nome (opcional)",question_type:"short_text",is_required:!1},{question_text:"Qual foi o tipo do seu ensaio/evento?",question_type:"short_text",is_required:!0},{question_text:"Como você avalia sua experiência geral? (1 a 5 estrelas)",question_type:"short_text",is_required:!0},{question_text:"O que mais gostou no serviço?",question_type:"long_text",is_required:!0},{question_text:"Algo que podemos melhorar?",question_type:"long_text",is_required:!1},{question_text:"Você indicaria meu trabalho para alguém?",question_type:"short_text",is_required:!1},{question_text:"Podemos usar esse feedback em nossas redes sociais?",question_type:"short_text",is_required:!1}]}},pe=()=>{const{user:o}=A(),r=E(),{toast:i}=S(),[n,a]=d.useState([]),[h,x]=d.useState(!0),[g,u]=d.useState(!1),[q,b]=d.useState(!1),[y,te]=d.useState("");d.useEffect(()=>{(async()=>{if(o){x(!0);try{const{data:s,error:m}=await p.from("client_forms").select("*").eq("user_id",o.id).order("created_at",{ascending:!1});if(m)throw m;a(s)}catch(s){i({title:"Erro ao buscar formulários",description:s.message,variant:"destructive"})}finally{x(!1)}}})()},[o,i]);const j=t=>{if(u(!1),t==="blank")r("/forms/edit/new");else{const s=ee[t];r("/forms/edit/new",{state:{template:s,templateType:t}})}},v=async t=>{try{await p.from("lead_submissions").delete().eq("form_id",t),await p.from("feedback_submissions").delete().eq("form_id",t);const{error:s}=await p.from("client_forms").delete().eq("id",t);if(s)throw s;a(n.filter(m=>m.id!==t)),i({title:"Formulário excluído com sucesso!"})}catch(s){i({title:"Erro ao excluir formulário",description:s.message,variant:"destructive"})}},C=t=>{const s=`${window.location.origin}/f/${t}`;navigator.clipboard.writeText(s),i({title:"Link copiado!",description:"O link do formulário foi copiado para a área de transferência."})},w=t=>{switch(t){case"client_registration":return"Cadastro de Cliente";case"client_and_briefing":return"Cadastro + Briefing";case"lead_campaign":return"Campanha de Leads";case"feedback":return"Pesquisa de Feedback";default:return"Briefing"}};return h?e.jsx("div",{children:"Carregando..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Y,{isOpen:g,onClose:()=>u(!1),onSelectTemplate:j}),e.jsx(Z,{isOpen:q,onClose:()=>b(!1),shareableLink:y}),e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs(c.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground titulo-gradiente",children:"Formulários de Captação"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:"Crie e gerencie seus formulários de briefing e cadastro."})]}),e.jsxs(l,{onClick:()=>u(!0),className:"btn-custom-gradient text-white shadow-lg w-full sm:w-auto",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Criar Novo Formulário"]})]}),n.length===0?e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 bg-card rounded-xl p-6 shadow-lg border border-border",children:[e.jsx(L,{className:"w-12 h-12 sm:w-16 sm:h-16 text-muted-foreground mx-auto mb-4"}),e.jsx("h3",{className:"text-md sm:text-lg font-medium text-foreground mb-2",children:"Nenhum formulário criado ainda"}),e.jsx("p",{className:"text-muted-foreground mb-4 text-sm sm:text-base",children:"Comece a captar clientes de forma inteligente."}),e.jsxs(l,{onClick:()=>u(!0),className:"btn-custom-gradient text-white",children:[e.jsx(_,{className:"w-4 h-4 mr-2"}),"Criar seu primeiro formulário"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(t=>e.jsxs(c.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card rounded-xl p-6 shadow-lg border border-border flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsx("h3",{className:"font-semibold text-lg text-foreground mb-1",children:t.title}),e.jsx("span",{className:"text-xs bg-secondary text-secondary-foreground px-2 py-1 rounded-full whitespace-nowrap",children:w(t.form_type)})]}),t.campaign_tag&&e.jsx("span",{className:"text-xs font-semibold bg-primary/20 text-primary-foreground px-2 py-1 rounded-full",children:t.campaign_tag}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2 line-clamp-2",children:t.description||"Sem descrição"})]}),e.jsxs("div",{className:"flex items-center justify-end space-x-2 mt-4 pt-4 border-t border-border",children:[t.form_type!=="feedback"&&e.jsx(l,{variant:"outline",size:"icon",title:"Ver Envios",onClick:()=>r(`/campaigns/${t.id}`),children:e.jsx(M,{className:"w-4 h-4"})}),e.jsx(l,{variant:"outline",size:"icon",title:"Compartilhar",onClick:()=>C(t.shareable_link_id),children:e.jsx(G,{className:"w-4 h-4"})}),e.jsx(l,{variant:"outline",size:"icon",title:"Editar",onClick:()=>r(`/forms/edit/${t.id}`),children:e.jsx(J,{className:"w-4 h-4"})}),e.jsxs(T,{children:[e.jsx(O,{asChild:!0,children:e.jsx(l,{variant:"destructive",size:"icon",title:"Excluir",children:e.jsx(D,{className:"w-4 h-4"})})}),e.jsxs(P,{children:[e.jsxs(z,{children:[e.jsx(B,{children:"Você tem certeza?"}),e.jsx(H,{children:"Esta ação não pode ser desfeita. Isso excluirá permanentemente o formulário e todas as suas respostas/leads."})]}),e.jsxs(R,{children:[e.jsx(V,{children:"Cancelar"}),e.jsx($,{onClick:()=>v(t.id),children:"Excluir"})]})]})]})]})]},t.id))})]})};export{pe as default};
