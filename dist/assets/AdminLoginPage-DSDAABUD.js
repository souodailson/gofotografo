import{r,e as y,u as N,j as e,m as n,M as E,I as h,L as A,B as I,s as l}from"./index-BLSLQMBf.js";import{A as S}from"./alert-circle-CyCnbfGM.js";import{L}from"./log-in-B0KCAdPT.js";const P=()=>{const[d,f]=r.useState(""),[c,b]=r.useState(""),[o,m]=r.useState(!1),[u,x]=r.useState(""),{toast:w}=y(),j=N(),v=async a=>{a.preventDefault(),m(!0),x("");try{const{data:{user:s,session:t},error:p}=await l.auth.signInWithPassword({email:d,password:c});if(p)throw p;if(!s)throw new Error("UsuÃ¡rio nÃ£o encontrado apÃ³s o login.");const{data:g,error:i}=await l.from("settings").select("role").eq("user_id",s.id).single();if(i)throw i.code==="PGRST116"?new Error("ConfiguraÃ§Ãµes nÃ£o encontradas para este usuÃ¡rio."):i;if(g&&g.role==="ADMIN")localStorage.setItem("gofotografo_admin_auth","true"),w({title:"Login de Admin bem-sucedido! ðŸš€",description:"Redirecionando para o painel de controle..."}),j("/control-acess/dashboard");else throw await l.auth.signOut(),new Error("Acesso negado. Esta conta nÃ£o possui privilÃ©gios de administrador.")}catch(s){let t="Credenciais de administrador invÃ¡lidas ou erro inesperado.";s.message.includes("privilÃ©gios de administrador")?t=s.message:s.message.includes("Invalid login credentials")&&(t="Email ou senha incorretos."),x(t)}finally{m(!1)}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-background p-4",children:e.jsx(n.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full max-w-md mx-auto",children:e.jsxs("div",{className:"bg-card border border-border rounded-2xl shadow-2xl p-8 space-y-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-2xl font-bold text-foreground",children:"Acesso Restrito"}),e.jsx("p",{className:"text-muted-foreground mt-2",children:"Painel de Controle GO.FOTÃ“GRAFO"})]}),e.jsxs("form",{onSubmit:v,className:"space-y-6",children:[u&&e.jsxs(n.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-destructive/10 border border-destructive/50 text-destructive px-4 py-3 rounded-md flex items-start",role:"alert",children:[e.jsx(S,{className:"w-5 h-5 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"text-sm",children:u})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-muted-foreground/70"}),e.jsx(h,{id:"email",type:"email",value:d,onChange:a=>f(a.target.value),placeholder:"admin@email.com",required:!0,className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-muted-foreground/70"}),e.jsx(h,{id:"password",type:"password",value:c,onChange:a=>b(a.target.value),placeholder:"Sua senha",required:!0,className:"pl-10"})]})]}),e.jsxs(I,{type:"submit",className:"w-full shadow-lg py-3 text-base font-semibold",disabled:o,children:[o?e.jsx(n.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-5 h-5 border-2 border-primary-foreground border-t-transparent rounded-full mr-2"}):e.jsx(L,{className:"w-5 h-5 mr-2"}),o?"Acessando...":"Acessar"]})]})]})})})};export{P as default};
