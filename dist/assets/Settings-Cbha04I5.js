import{c as da,j as e,m as se,i as ps,K as ua,r as A,I as vt,B as N,n as ze,s as X,a7 as oe,L as Be,k as ma,d as fa,f as Ce,q as Tt,X as pa,C as rs,a as ha,a8 as ga,o as hs,aa as ce,O as xa,ag as ba,H as gs,a9 as _a,z as os,G as is,F as Ta,p as xs,t as ft,v as pt,w as ht,x as gt,y as xt,g as Aa,u as Sa,b as va,aU as Ea}from"./index-DHBNVHsv.js";import{g as ya,e as Na}from"./googleCalendar-B6sFUS35.js";import{S as bs}from"./switch-C0tIeEyV.js";import{G as ja}from"./globe-CfJKnq5Y.js";import{M as _s}from"./message-square-ZkAFTajl.js";import{A as Ts,b as As,c as Ss,d as vs,e as Es,f as ys,a as wa,g as Ca,h as Oa}from"./alert-dialog-CA3sahhm.js";import{T as We,a as qe,b as Ye,c as $e}from"./tooltip-DrghJOUq.js";import{F as Ve}from"./FeatureRestrictionModal-eN81Qxj_.js";import{S as At}from"./shield-jz4Bek5Y.js";import{B as Ra}from"./bell-CAtwB1qs.js";import{P as St}from"./palette-BFstn63C.js";import{P as Da}from"./plus-circle-BRMk-46g.js";import{R as Ns}from"./refresh-cw-CwaUc2my.js";import{f as js}from"./formatDistanceToNow-B9rgzkoT.js";import{C as Ma}from"./chevron-up-Dga819J-.js";import{L as Et}from"./life-buoy-DSdmBROM.js";import{L as La}from"./lightbulb-B1EcMlsQ.js";import{S as ls}from"./settings-BihSyCWF.js";import"./extends-CF3RwP-h.js";import"./constructNow-DKKJTFER.js";import"./endOfDay-B9Vn3X1G.js";import"./endOfMonth-FRBqcOZp.js";const cs=da("Blocks",[["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["path",{d:"M10 21V8a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1H3",key:"1fpvtg"}]]),Ia="w-full px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-customPurple focus:border-transparent",He=(a,d,n,h,f,m="Selecione...")=>e.jsxs("div",{children:[e.jsx("label",{htmlFor:d,className:"block text-sm font-medium text-muted-foreground mb-1",children:a}),e.jsxs("select",{id:d,value:n||"",onChange:u=>h(u.target.value),className:Ia,children:[e.jsx("option",{value:"",disabled:!0,children:m}),f.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))]})]}),Pa=({formData:a,handleInputChange:d})=>e.jsxs(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1*.05},className:"bg-card rounded-xl p-6 shadow-lg border border-border lg:col-span-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-customPurple to-customGreen rounded-lg flex items-center justify-center",children:e.jsx(ja,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:"Preferências da Conta"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[He("Idioma","language",a.language,n=>d("language",n),[{label:"Português (Brasil)",value:"pt-BR"},{label:"English (US)",value:"en-US"}],"Selecione o Idioma"),He("Moeda Padrão","currency",a.currency,n=>d("currency",n),[{label:"Real Brasileiro (R$)",value:"BRL"},{label:"Dólar Americano ($)",value:"USD"},{label:"Euro (€)",value:"EUR"}],"Selecione a Moeda"),He("Fuso Horário","timezone",a.timezone,n=>d("timezone",n),[{label:"Brasília (GMT-3)",value:"America/Sao_Paulo"},{label:"Nova York (GMT-4/-5)",value:"America/New_York"},{label:"Londres (GMT+0/+1)",value:"Europe/London"}],"Selecione seu fuso horário"),He("Formato de Data","date_format",a.date_format,n=>d("date_format",n),[{label:"DD/MM/AAAA",value:"dd/mm/yyyy"},{label:"MM/DD/AAAA",value:"mm/dd/yyyy"}],"Selecione o Formato de Data"),e.jsx("div",{className:"md:col-span-2 border-t border-border pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(ps,{htmlFor:"show-greetings",className:"font-medium text-card-foreground flex items-center",children:[e.jsx(_s,{className:"w-4 h-4 mr-2 text-customPurple"}),"Exibir Saudações Iniciais"]}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Mostrar saudações criativas no topo do dashboard."})]}),e.jsx(bs,{id:"show-greetings",checked:a.show_greetings,onCheckedChange:n=>d("show_greetings",n)})]})})]})]});/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */var bt,ds;function us(){if(ds)return bt;ds=1;const{entries:a,setPrototypeOf:d,isFrozen:n,getPrototypeOf:h,getOwnPropertyDescriptor:f}=Object;let{freeze:m,seal:u,create:T}=Object,{apply:E,construct:O}=typeof Reflect<"u"&&Reflect;m||(m=function(l){return l}),u||(u=function(l){return l}),E||(E=function(l,_,x){return l.apply(_,x)}),O||(O=function(l,_){return new l(..._)});const b=r(Array.prototype.forEach),j=r(Array.prototype.lastIndexOf),S=r(Array.prototype.pop),M=r(Array.prototype.push),y=r(Array.prototype.splice),w=r(String.prototype.toLowerCase),q=r(String.prototype.toString),ie=r(String.prototype.match),$=r(String.prototype.replace),Y=r(String.prototype.indexOf),_e=r(String.prototype.trim),F=r(Object.prototype.hasOwnProperty),R=r(RegExp.prototype.test),K=p(TypeError);function r(g){return function(l){l instanceof RegExp&&(l.lastIndex=0);for(var _=arguments.length,x=new Array(_>1?_-1:0),U=1;U<_;U++)x[U-1]=arguments[U];return E(g,l,x)}}function p(g){return function(){for(var l=arguments.length,_=new Array(l),x=0;x<l;x++)_[x]=arguments[x];return O(g,_)}}function o(g,l){let _=arguments.length>2&&arguments[2]!==void 0?arguments[2]:w;d&&d(g,null);let x=l.length;for(;x--;){let U=l[x];if(typeof U=="string"){const Q=_(U);Q!==U&&(n(l)||(l[x]=Q),U=Q)}g[U]=!0}return g}function Z(g){for(let l=0;l<g.length;l++)F(g,l)||(g[l]=null);return g}function L(g){const l=T(null);for(const[_,x]of a(g))F(g,_)&&(Array.isArray(x)?l[_]=Z(x):x&&typeof x=="object"&&x.constructor===Object?l[_]=L(x):l[_]=x);return l}function ae(g,l){for(;g!==null;){const x=f(g,l);if(x){if(x.get)return r(x.get);if(typeof x.value=="function")return r(x.value)}g=h(g)}function _(){return null}return _}const Oe=m(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),ne=m(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),de=m(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),ws=m(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xe=m(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Cs=m(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),yt=m(["#text"]),Nt=m(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Ke=m(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),jt=m(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Re=m(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Os=u(/\{\{[\w\W]*|[\w\W]*\}\}/gm),Rs=u(/<%[\w\W]*|[\w\W]*%>/gm),Ds=u(/\$\{[\w\W]*/gm),Ms=u(/^data-[\-\w.\u00B7-\uFFFF]+$/),Ls=u(/^aria-[\-\w]+$/),wt=u(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Is=u(/^(?:\w+script|data):/i),Ps=u(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),Ct=u(/^html$/i),ks=u(/^[a-z][.\w]*(-[.\w]+)+$/i);var Ot=Object.freeze({__proto__:null,ARIA_ATTR:Ls,ATTR_WHITESPACE:Ps,CUSTOM_ELEMENT:ks,DATA_ATTR:Ms,DOCTYPE_NAME:Ct,ERB_EXPR:Rs,IS_ALLOWED_URI:wt,IS_SCRIPT_OR_DATA:Is,MUSTACHE_EXPR:Os,TMPLIT_EXPR:Ds});const Te={element:1,text:3,progressingInstruction:7,comment:8,document:9},Fs=function(){return typeof window>"u"?null:window},Us=function(l,_){if(typeof l!="object"||typeof l.createPolicy!="function")return null;let x=null;const U="data-tt-policy-suffix";_&&_.hasAttribute(U)&&(x=_.getAttribute(U));const Q="dompurify"+(x?"#"+x:"");try{return l.createPolicy(Q,{createHTML(ue){return ue},createScriptURL(ue){return ue}})}catch{return console.warn("TrustedTypes policy "+Q+" could not be created."),null}},Rt=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Dt(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Fs();const l=c=>Dt(c);if(l.version="3.2.6",l.removed=[],!g||!g.document||g.document.nodeType!==Te.document||!g.Element)return l.isSupported=!1,l;let{document:_}=g;const x=_,U=x.currentScript,{DocumentFragment:Q,HTMLTemplateElement:ue,Node:Ze,Element:Mt,NodeFilter:Ae,NamedNodeMap:Hs=g.NamedNodeMap||g.MozNamedAttrMap,HTMLFormElement:zs,DOMParser:Bs,trustedTypes:De}=g,Se=Mt.prototype,Ws=ae(Se,"cloneNode"),qs=ae(Se,"remove"),Ys=ae(Se,"nextSibling"),$s=ae(Se,"childNodes"),Me=ae(Se,"parentNode");if(typeof ue=="function"){const c=_.createElement("template");c.content&&c.content.ownerDocument&&(_=c.content.ownerDocument)}let z,ve="";const{implementation:Qe,createNodeIterator:Vs,createDocumentFragment:Xs,getElementsByTagName:Ks}=_,{importNode:Zs}=x;let B=Rt();l.isSupported=typeof a=="function"&&typeof Me=="function"&&Qe&&Qe.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:Je,ERB_EXPR:et,TMPLIT_EXPR:tt,DATA_ATTR:Qs,ARIA_ATTR:Js,IS_SCRIPT_OR_DATA:ea,ATTR_WHITESPACE:Lt,CUSTOM_ELEMENT:ta}=Ot;let{IS_ALLOWED_URI:It}=Ot,I=null;const Pt=o({},[...Oe,...ne,...de,...Xe,...yt]);let k=null;const kt=o({},[...Nt,...Ke,...jt,...Re]);let C=Object.seal(T(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Ee=null,st=null,Ft=!0,at=!0,Ut=!1,Gt=!0,me=!1,Le=!0,le=!1,nt=!1,rt=!1,fe=!1,Ie=!1,Pe=!1,Ht=!0,zt=!1;const sa="user-content-";let ot=!0,ye=!1,pe={},he=null;const Bt=o({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Wt=null;const qt=o({},["audio","video","img","source","image","track"]);let it=null;const Yt=o({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),ke="http://www.w3.org/1998/Math/MathML",Fe="http://www.w3.org/2000/svg",J="http://www.w3.org/1999/xhtml";let ge=J,lt=!1,ct=null;const aa=o({},[ke,Fe,J],q);let Ue=o({},["mi","mo","mn","ms","mtext"]),Ge=o({},["annotation-xml"]);const na=o({},["title","style","font","a","script"]);let Ne=null;const ra=["application/xhtml+xml","text/html"],oa="text/html";let P=null,xe=null;const ia=_.createElement("form"),$t=function(t){return t instanceof RegExp||t instanceof Function},dt=function(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(xe&&xe===t)){if((!t||typeof t!="object")&&(t={}),t=L(t),Ne=ra.indexOf(t.PARSER_MEDIA_TYPE)===-1?oa:t.PARSER_MEDIA_TYPE,P=Ne==="application/xhtml+xml"?q:w,I=F(t,"ALLOWED_TAGS")?o({},t.ALLOWED_TAGS,P):Pt,k=F(t,"ALLOWED_ATTR")?o({},t.ALLOWED_ATTR,P):kt,ct=F(t,"ALLOWED_NAMESPACES")?o({},t.ALLOWED_NAMESPACES,q):aa,it=F(t,"ADD_URI_SAFE_ATTR")?o(L(Yt),t.ADD_URI_SAFE_ATTR,P):Yt,Wt=F(t,"ADD_DATA_URI_TAGS")?o(L(qt),t.ADD_DATA_URI_TAGS,P):qt,he=F(t,"FORBID_CONTENTS")?o({},t.FORBID_CONTENTS,P):Bt,Ee=F(t,"FORBID_TAGS")?o({},t.FORBID_TAGS,P):L({}),st=F(t,"FORBID_ATTR")?o({},t.FORBID_ATTR,P):L({}),pe=F(t,"USE_PROFILES")?t.USE_PROFILES:!1,Ft=t.ALLOW_ARIA_ATTR!==!1,at=t.ALLOW_DATA_ATTR!==!1,Ut=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Gt=t.ALLOW_SELF_CLOSE_IN_ATTR!==!1,me=t.SAFE_FOR_TEMPLATES||!1,Le=t.SAFE_FOR_XML!==!1,le=t.WHOLE_DOCUMENT||!1,fe=t.RETURN_DOM||!1,Ie=t.RETURN_DOM_FRAGMENT||!1,Pe=t.RETURN_TRUSTED_TYPE||!1,rt=t.FORCE_BODY||!1,Ht=t.SANITIZE_DOM!==!1,zt=t.SANITIZE_NAMED_PROPS||!1,ot=t.KEEP_CONTENT!==!1,ye=t.IN_PLACE||!1,It=t.ALLOWED_URI_REGEXP||wt,ge=t.NAMESPACE||J,Ue=t.MATHML_TEXT_INTEGRATION_POINTS||Ue,Ge=t.HTML_INTEGRATION_POINTS||Ge,C=t.CUSTOM_ELEMENT_HANDLING||{},t.CUSTOM_ELEMENT_HANDLING&&$t(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(C.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&$t(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(C.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(C.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),me&&(at=!1),Ie&&(fe=!0),pe&&(I=o({},yt),k=[],pe.html===!0&&(o(I,Oe),o(k,Nt)),pe.svg===!0&&(o(I,ne),o(k,Ke),o(k,Re)),pe.svgFilters===!0&&(o(I,de),o(k,Ke),o(k,Re)),pe.mathMl===!0&&(o(I,Xe),o(k,jt),o(k,Re))),t.ADD_TAGS&&(I===Pt&&(I=L(I)),o(I,t.ADD_TAGS,P)),t.ADD_ATTR&&(k===kt&&(k=L(k)),o(k,t.ADD_ATTR,P)),t.ADD_URI_SAFE_ATTR&&o(it,t.ADD_URI_SAFE_ATTR,P),t.FORBID_CONTENTS&&(he===Bt&&(he=L(he)),o(he,t.FORBID_CONTENTS,P)),ot&&(I["#text"]=!0),le&&o(I,["html","head","body"]),I.table&&(o(I,["tbody"]),delete Ee.tbody),t.TRUSTED_TYPES_POLICY){if(typeof t.TRUSTED_TYPES_POLICY.createHTML!="function")throw K('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof t.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw K('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');z=t.TRUSTED_TYPES_POLICY,ve=z.createHTML("")}else z===void 0&&(z=Us(De,U)),z!==null&&typeof ve=="string"&&(ve=z.createHTML(""));m&&m(t),xe=t}},Vt=o({},[...ne,...de,...ws]),Xt=o({},[...Xe,...Cs]),la=function(t){let s=Me(t);(!s||!s.tagName)&&(s={namespaceURI:ge,tagName:"template"});const i=w(t.tagName),v=w(s.tagName);return ct[t.namespaceURI]?t.namespaceURI===Fe?s.namespaceURI===J?i==="svg":s.namespaceURI===ke?i==="svg"&&(v==="annotation-xml"||Ue[v]):!!Vt[i]:t.namespaceURI===ke?s.namespaceURI===J?i==="math":s.namespaceURI===Fe?i==="math"&&Ge[v]:!!Xt[i]:t.namespaceURI===J?s.namespaceURI===Fe&&!Ge[v]||s.namespaceURI===ke&&!Ue[v]?!1:!Xt[i]&&(na[i]||!Vt[i]):!!(Ne==="application/xhtml+xml"&&ct[t.namespaceURI]):!1},V=function(t){M(l.removed,{element:t});try{Me(t).removeChild(t)}catch{qs(t)}},be=function(t,s){try{M(l.removed,{attribute:s.getAttributeNode(t),from:s})}catch{M(l.removed,{attribute:null,from:s})}if(s.removeAttribute(t),t==="is")if(fe||Ie)try{V(s)}catch{}else try{s.setAttribute(t,"")}catch{}},Kt=function(t){let s=null,i=null;if(rt)t="<remove></remove>"+t;else{const D=ie(t,/^[\r\n\t ]+/);i=D&&D[0]}Ne==="application/xhtml+xml"&&ge===J&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");const v=z?z.createHTML(t):t;if(ge===J)try{s=new Bs().parseFromString(v,Ne)}catch{}if(!s||!s.documentElement){s=Qe.createDocument(ge,"template",null);try{s.documentElement.innerHTML=lt?ve:v}catch{}}const G=s.body||s.documentElement;return t&&i&&G.insertBefore(_.createTextNode(i),G.childNodes[0]||null),ge===J?Ks.call(s,le?"html":"body")[0]:le?s.documentElement:G},Zt=function(t){return Vs.call(t.ownerDocument||t,t,Ae.SHOW_ELEMENT|Ae.SHOW_COMMENT|Ae.SHOW_TEXT|Ae.SHOW_PROCESSING_INSTRUCTION|Ae.SHOW_CDATA_SECTION,null)},ut=function(t){return t instanceof zs&&(typeof t.nodeName!="string"||typeof t.textContent!="string"||typeof t.removeChild!="function"||!(t.attributes instanceof Hs)||typeof t.removeAttribute!="function"||typeof t.setAttribute!="function"||typeof t.namespaceURI!="string"||typeof t.insertBefore!="function"||typeof t.hasChildNodes!="function")},Qt=function(t){return typeof Ze=="function"&&t instanceof Ze};function ee(c,t,s){b(c,i=>{i.call(l,t,s,xe)})}const Jt=function(t){let s=null;if(ee(B.beforeSanitizeElements,t,null),ut(t))return V(t),!0;const i=P(t.nodeName);if(ee(B.uponSanitizeElement,t,{tagName:i,allowedTags:I}),Le&&t.hasChildNodes()&&!Qt(t.firstElementChild)&&R(/<[/\w!]/g,t.innerHTML)&&R(/<[/\w!]/g,t.textContent)||t.nodeType===Te.progressingInstruction||Le&&t.nodeType===Te.comment&&R(/<[/\w]/g,t.data))return V(t),!0;if(!I[i]||Ee[i]){if(!Ee[i]&&ts(i)&&(C.tagNameCheck instanceof RegExp&&R(C.tagNameCheck,i)||C.tagNameCheck instanceof Function&&C.tagNameCheck(i)))return!1;if(ot&&!he[i]){const v=Me(t)||t.parentNode,G=$s(t)||t.childNodes;if(G&&v){const D=G.length;for(let W=D-1;W>=0;--W){const te=Ws(G[W],!0);te.__removalCount=(t.__removalCount||0)+1,v.insertBefore(te,Ys(t))}}}return V(t),!0}return t instanceof Mt&&!la(t)||(i==="noscript"||i==="noembed"||i==="noframes")&&R(/<\/no(script|embed|frames)/i,t.innerHTML)?(V(t),!0):(me&&t.nodeType===Te.text&&(s=t.textContent,b([Je,et,tt],v=>{s=$(s,v," ")}),t.textContent!==s&&(M(l.removed,{element:t.cloneNode()}),t.textContent=s)),ee(B.afterSanitizeElements,t,null),!1)},es=function(t,s,i){if(Ht&&(s==="id"||s==="name")&&(i in _||i in ia))return!1;if(!(at&&!st[s]&&R(Qs,s))){if(!(Ft&&R(Js,s))){if(!k[s]||st[s]){if(!(ts(t)&&(C.tagNameCheck instanceof RegExp&&R(C.tagNameCheck,t)||C.tagNameCheck instanceof Function&&C.tagNameCheck(t))&&(C.attributeNameCheck instanceof RegExp&&R(C.attributeNameCheck,s)||C.attributeNameCheck instanceof Function&&C.attributeNameCheck(s))||s==="is"&&C.allowCustomizedBuiltInElements&&(C.tagNameCheck instanceof RegExp&&R(C.tagNameCheck,i)||C.tagNameCheck instanceof Function&&C.tagNameCheck(i))))return!1}else if(!it[s]){if(!R(It,$(i,Lt,""))){if(!((s==="src"||s==="xlink:href"||s==="href")&&t!=="script"&&Y(i,"data:")===0&&Wt[t])){if(!(Ut&&!R(ea,$(i,Lt,"")))){if(i)return!1}}}}}}return!0},ts=function(t){return t!=="annotation-xml"&&ie(t,ta)},ss=function(t){ee(B.beforeSanitizeAttributes,t,null);const{attributes:s}=t;if(!s||ut(t))return;const i={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:k,forceKeepAttr:void 0};let v=s.length;for(;v--;){const G=s[v],{name:D,namespaceURI:W,value:te}=G,je=P(D),mt=te;let H=D==="value"?mt:_e(mt);if(i.attrName=je,i.attrValue=H,i.keepAttr=!0,i.forceKeepAttr=void 0,ee(B.uponSanitizeAttribute,t,i),H=i.attrValue,zt&&(je==="id"||je==="name")&&(be(D,t),H=sa+H),Le&&R(/((--!?|])>)|<\/(style|title)/i,H)){be(D,t);continue}if(i.forceKeepAttr)continue;if(!i.keepAttr){be(D,t);continue}if(!Gt&&R(/\/>/i,H)){be(D,t);continue}me&&b([Je,et,tt],ns=>{H=$(H,ns," ")});const as=P(t.nodeName);if(!es(as,je,H)){be(D,t);continue}if(z&&typeof De=="object"&&typeof De.getAttributeType=="function"&&!W)switch(De.getAttributeType(as,je)){case"TrustedHTML":{H=z.createHTML(H);break}case"TrustedScriptURL":{H=z.createScriptURL(H);break}}if(H!==mt)try{W?t.setAttributeNS(W,D,H):t.setAttribute(D,H),ut(t)?V(t):S(l.removed)}catch{be(D,t)}}ee(B.afterSanitizeAttributes,t,null)},ca=function c(t){let s=null;const i=Zt(t);for(ee(B.beforeSanitizeShadowDOM,t,null);s=i.nextNode();)ee(B.uponSanitizeShadowNode,s,null),Jt(s),ss(s),s.content instanceof Q&&c(s.content);ee(B.afterSanitizeShadowDOM,t,null)};return l.sanitize=function(c){let t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=null,i=null,v=null,G=null;if(lt=!c,lt&&(c="<!-->"),typeof c!="string"&&!Qt(c))if(typeof c.toString=="function"){if(c=c.toString(),typeof c!="string")throw K("dirty is not a string, aborting")}else throw K("toString is not a function");if(!l.isSupported)return c;if(nt||dt(t),l.removed=[],typeof c=="string"&&(ye=!1),ye){if(c.nodeName){const te=P(c.nodeName);if(!I[te]||Ee[te])throw K("root node is forbidden and cannot be sanitized in-place")}}else if(c instanceof Ze)s=Kt("<!---->"),i=s.ownerDocument.importNode(c,!0),i.nodeType===Te.element&&i.nodeName==="BODY"||i.nodeName==="HTML"?s=i:s.appendChild(i);else{if(!fe&&!me&&!le&&c.indexOf("<")===-1)return z&&Pe?z.createHTML(c):c;if(s=Kt(c),!s)return fe?null:Pe?ve:""}s&&rt&&V(s.firstChild);const D=Zt(ye?c:s);for(;v=D.nextNode();)Jt(v),ss(v),v.content instanceof Q&&ca(v.content);if(ye)return c;if(fe){if(Ie)for(G=Xs.call(s.ownerDocument);s.firstChild;)G.appendChild(s.firstChild);else G=s;return(k.shadowroot||k.shadowrootmode)&&(G=Zs.call(x,G,!0)),G}let W=le?s.outerHTML:s.innerHTML;return le&&I["!doctype"]&&s.ownerDocument&&s.ownerDocument.doctype&&s.ownerDocument.doctype.name&&R(Ct,s.ownerDocument.doctype.name)&&(W="<!DOCTYPE "+s.ownerDocument.doctype.name+`>
`+W),me&&b([Je,et,tt],te=>{W=$(W,te," ")}),z&&Pe?z.createHTML(W):W},l.setConfig=function(){let c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};dt(c),nt=!0},l.clearConfig=function(){xe=null,nt=!1},l.isValidAttribute=function(c,t,s){xe||dt({});const i=P(c),v=P(t);return es(i,v,s)},l.addHook=function(c,t){typeof t=="function"&&M(B[c],t)},l.removeHook=function(c,t){if(t!==void 0){const s=j(B[c],t);return s===-1?void 0:y(B[c],s,1)[0]}return S(B[c])},l.removeHooks=function(c){B[c]=[]},l.removeAllHooks=function(){B=Rt()},l}var Gs=Dt();return bt=Gs,bt}var _t,ms;function ka(){return ms||(ms=1,_t=window.DOMPurify||(window.DOMPurify=us().default||us())),_t}var Fa=ka();const Ua=ua(Fa);function Ga(a){const d=a==null?"":String(a);return Ua.sanitize(d,{ALLOWED_TAGS:["a","b","strong","i","em","u","p","br","ul","ol","li","blockquote","hr","h1","h2","h3","h4","h5","h6","span","div","img","table","thead","tbody","tr","th","td","pre","code","svg","g","path","rect","circle","line","polyline","polygon","defs","clipPath","mask","title","desc","use"],ALLOWED_ATTR:["href","target","rel","src","alt","title","width","height","class","id","viewBox","fill","stroke","stroke-width","stroke-linecap","stroke-linejoin","d","x","y","cx","cy","r","x1","y1","x2","y2","points","transform","preserveAspectRatio","xmlns","xmlns:xlink","version","aria-hidden","focusable","role","opacity","xlink:href","href"],ALLOW_DATA_ATTR:!1,FORBID_TAGS:["script","iframe","object","embed","link","meta","form","input","button","textarea","select"],FORBID_ATTR:["onerror","onload","onclick","onmouseover","onfocus","onpointerover","style"],RETURN_TRUSTED_TYPE:!1})}function Ha({html:a,className:d=""}){const n=Ga(String(a??""));return e.jsx("div",{className:d,dangerouslySetInnerHTML:{__html:n}})}const za=A.memo(Ha),Ba=({isOpen:a,onClose:d,enrollData:n,onSuccess:h,toast:f})=>{const[m,u]=A.useState(""),[T,E]=A.useState(""),[O,b]=A.useState(!1),[j,S]=A.useState("");A.useEffect(()=>{n?.totp?.qr_code?u(n.totp.qr_code):u("")},[n]);const M=async y=>{if(y.preventDefault(),S(""),!T.trim()){S("Por favor, insira o código de verificação.");return}if(!n?.id){S("Fator TOTP não encontrado. Tente iniciar o processo novamente.");return}b(!0);try{const{error:w}=await X.auth.mfa.challenge({factorId:n.id});w&&console.warn("MFA challenge aviso:",w.message);const{error:q}=await X.auth.mfa.verify({factorId:n.id,code:T.trim()});if(q)throw q;typeof h=="function"&&h(),typeof f=="function"&&f({title:"2FA ativada",description:"Sua autenticação em duas etapas foi ativada com sucesso."}),d?.()}catch(w){console.error("Erro ao verificar MFA:",w);const q=w?.message||"Código de verificação inválido ou erro ao ativar 2FA.";S(q),typeof f=="function"&&f({title:"Erro ao verificar MFA",description:q,variant:"destructive"})}finally{b(!1)}};return a?e.jsx(Ts,{open:a,onOpenChange:y=>!y&&d?.(),children:e.jsxs(As,{className:"sm:max-w-[425px]",children:[e.jsxs(Ss,{children:[e.jsx(vs,{children:"Ativar Autenticação de Dois Fatores"}),e.jsx(Es,{children:"Escaneie o QR Code abaixo com um aplicativo autenticador e insira o código gerado para ativar o 2FA."})]}),e.jsxs("form",{onSubmit:M,children:[e.jsxs("div",{className:"py-4 space-y-6",children:[m?e.jsx("div",{className:"mx-auto w-48 h-48 border overflow-hidden",children:e.jsx(za,{className:"prose",html:m})}):e.jsx("p",{className:"text-sm text-center",children:"Gerando QR Code..."}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"mfa-code",className:"block text-sm font-medium",children:"Código de Verificação"}),e.jsx(vt,{id:"mfa-code",type:"text",value:T,onChange:y=>E(y.target.value),placeholder:"Insira o código do autenticador",autoComplete:"one-time-code",inputMode:"numeric"})]}),j&&e.jsx("p",{className:"text-sm text-red-500 dark:text-red-400",children:j})]}),e.jsxs(ys,{children:[e.jsx(N,{type:"button",variant:"secondary",onClick:d,disabled:O,children:"Cancelar"}),e.jsxs(N,{type:"submit",disabled:O,children:[O&&e.jsx(ze,{className:"mr-2 h-4 w-4 animate-spin"}),"Ativar 2FA"]})]})]})]})}):null},Wa=()=>{const{planStatus:a}=oe(),[d,n]=A.useState(!1),[h,f]=A.useState(!1),m=a==="PROFISSIONAL"||a==="STUDIO_PRO",u=()=>{m?n(!0):f(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-foreground",children:"Autenticação de Dois Fatores (MFA)"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Adicione uma camada extra de segurança à sua conta. A autenticação de dois fatores é uma funcionalidade premium."})]}),m?e.jsxs(N,{onClick:u,children:[e.jsx(At,{className:"w-4 h-4 mr-2"}),"Ativar Autenticação de Dois Fatores"]}):e.jsx(We,{children:e.jsxs(qe,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx("div",{className:"inline-block",children:e.jsxs(N,{onClick:u,disabled:!0,className:"cursor-not-allowed",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Ativar Autenticação de Dois Fatores"]})})}),e.jsx($e,{children:e.jsx("p",{children:"Funcionalidade Premium"})})]})})]}),e.jsx(Ba,{isOpen:d,onClose:()=>n(!1)}),e.jsx(Ve,{isOpen:h,onClose:()=>f(!1),featureName:"Autenticação de Dois Fatores",requiredPlans:["PROFISSIONAL","STUDIO_PRO"],currentPlan:a})]})},qa=({formData:a,handleNotificationChange:d})=>e.jsxs(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:4*.05},className:"bg-card rounded-xl p-6 shadow-lg border border-border lg:col-span-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-customPurple to-customGreen rounded-lg flex items-center justify-center",children:e.jsx(Ra,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:"Notificações"})]}),e.jsx("div",{className:"space-y-4",children:["email","whatsapp","calendar"].map(n=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-card-foreground capitalize",children:n==="calendar"?"Calendário (Google)":n}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Receber notificações ",n==="calendar"?"e sincronizar":"por"," ",n]})]}),e.jsx(ma,{checked:a.notifications[n],onCheckedChange:h=>d(n,h),id:`notif-${n}`})]},n))})]}),Ya=()=>{const{theme:a,toggleTheme:d}=fa();return e.jsxs(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:5*.05},className:"bg-card rounded-xl p-6 shadow-lg border border-border lg:col-span-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-customPurple to-customGreen rounded-lg flex items-center justify-center",children:e.jsx(St,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:"Aparência"})]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"Tema"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(N,{variant:a==="light"?"default":"outline",onClick:()=>a!=="light"&&d(),className:`flex items-center space-x-2 ${a==="light"?"btn-custom-gradient text-white":""}`,children:[e.jsx("span",{children:"☀️"}),e.jsx("span",{children:"Claro"})]}),e.jsxs(N,{variant:a==="dark"?"default":"outline",onClick:()=>a!=="dark"&&d(),className:`flex items-center space-x-2 ${a==="dark"?"btn-custom-gradient text-white":""}`,children:[e.jsx("span",{children:"🌙"}),e.jsx("span",{children:"Escuro"})]})]})]})})]})},$a=()=>{const{planStatus:a}=oe(),[d,n]=A.useState(!1),h=a==="STUDIO_PRO",f=()=>{h||n(!0)};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-foreground",children:"Equipe"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Convide membros para sua equipe e gerencie permissões. Disponível no plano STUDIO PRO."})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex -space-x-2 overflow-hidden",children:[e.jsx("img",{className:"inline-block h-8 w-8 rounded-full ring-2 ring-background",src:"https://images.unsplash.com/photo-1491528323818-fdd1faba62cc?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:""}),e.jsx("img",{className:"inline-block h-8 w-8 rounded-full ring-2 ring-background",src:"https://images.unsplash.com/photo-1550525811-e5869dd03032?ixlib=rb-1.2.1&auto=format&fit=facearea&facepad=2&w=256&h=256&q=80",alt:""})]}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Você e mais 1 membro."})]}),h?e.jsxs(N,{onClick:f,children:[e.jsx(Da,{className:"w-4 h-4 mr-2"}),"Convidar Membro"]}):e.jsx(We,{children:e.jsxs(qe,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx("div",{className:"inline-block",children:e.jsxs(N,{disabled:!0,className:"cursor-not-allowed",onClick:f,children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Convidar Membro"]})})}),e.jsx($e,{children:e.jsx("p",{children:"Disponível no plano STUDIO PRO"})})]})}),e.jsx(Ve,{isOpen:d,onClose:()=>n(!1),featureName:"Gestão de Equipe",requiredPlans:["STUDIO_PRO"],currentPlan:a})]})},Va=({formData:a,handleAutomationChange:d})=>{const{googleTokens:n,setGoogleTokens:h,planStatus:f}=oe(),{toast:m}=Ce(),[u,T]=A.useState(!1),[E,O]=A.useState(!1),b=f==="PROFISSIONAL"||f==="STUDIO_PRO",j=async()=>{if(!b){O(!0);return}T(!0);try{const{data:y,error:w}=await X.functions.invoke("google-generate-auth-url");if(w)throw w;window.location.href=y.authUrl}catch(y){m({title:"Erro de Autenticação",description:`Não foi possível iniciar a autenticação com o Google: ${y.message}`,variant:"destructive"}),T(!1)}},S=async()=>{h(null),m({title:"Desconectado",description:"Sua conta Google foi desconectada."})},M=()=>n?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("p",{className:"text-sm text-green-600 dark:text-green-400",children:"Conectado ao Google Calendar."}),e.jsx(N,{onClick:S,variant:"destructive_outline",size:"sm",children:"Desconectar"})]}):b?e.jsxs(N,{onClick:j,disabled:u,className:"bg-gradient-to-r from-blue-500 to-sky-600 hover:from-blue-600 hover:to-sky-700 text-white",children:[e.jsx(Ns,{className:`w-4 h-4 mr-2 ${u?"animate-spin":""}`}),"Autenticar com Google"]}):e.jsx(We,{children:e.jsxs(qe,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx("div",{className:"inline-flex items-center",children:e.jsxs(N,{disabled:!0,className:"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Autenticar com Google"]})})}),e.jsx($e,{children:e.jsx("p",{children:"Funcionalidade Premium"})})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ve,{isOpen:E,onClose:()=>O(!1),featureName:"Integração com Google Calendar",requiredPlans:["PROFISSIONAL","STUDIO_PRO"],currentPlan:f}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Integração com Google Calendar"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Sincronize seus agendamentos e eventos diretamente com sua agenda do Google para nunca perder um compromisso."}),M()]}),e.jsxs("div",{className:"border-t border-border pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-foreground mb-2",children:"Automações de Comunicação"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Ative lembretes automáticos para economizar tempo e manter seus clientes informados. (Funcionalidade em desenvolvimento)"}),e.jsx("div",{className:"space-y-4",children:[{id:"session_reminder",label:"Lembrete de Sessão/Evento"},{id:"payment_reminder",label:"Lembrete de Pagamento Pendente"},{id:"meeting_reminder",label:"Lembrete de Reunião Agendada"},{id:"pre_event_sequence",label:"Sequência de E-mails Pré-Evento"},{id:"post_event_sequence",label:"Sequência de E-mails Pós-Evento (Feedback/Upsell)"}].map(y=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-background rounded-lg border border-border",children:[e.jsx(ps,{htmlFor:y.id,className:"text-sm text-foreground",children:y.label}),e.jsx(bs,{id:y.id,checked:a.automation?.[y.id]||!1,onCheckedChange:w=>d(y.id,w),disabled:!0})]},y.id))})]})]})},Xa=()=>{const{toast:a}=Ce(),{user:d,signOut:n}=oe(),h=async()=>{try{const{error:f}=await X.functions.invoke("delete-user-account");if(f)throw f;a({title:"Conta excluída",description:"Sua conta e todos os dados foram excluídos com sucesso. Você será desconectado."}),setTimeout(()=>{n()},3e3)}catch(f){a({title:"Erro ao excluir a conta",description:`Não foi possível processar sua solicitação: ${f.message}`,variant:"destructive"})}};return e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-foreground",children:"Gerenciamento de Dados e Conta"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Exporte seus dados ou exclua sua conta permanentemente."}),e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"border border-destructive/50 bg-destructive/5 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Tt,{className:"w-5 h-5 text-destructive flex-shrink-0 mt-1"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-destructive",children:"Excluir Conta"}),e.jsx("p",{className:"text-sm text-destructive/80 mb-3",children:"Esta ação é irreversível. Todos os seus dados, incluindo clientes, trabalhos e informações financeiras, serão permanentemente apagados."}),e.jsxs(Ts,{children:[e.jsx(wa,{asChild:!0,children:e.jsxs(N,{variant:"destructive",children:[e.jsx(pa,{className:"w-4 h-4 mr-2"}),"Excluir minha conta"]})}),e.jsxs(As,{children:[e.jsxs(Ss,{children:[e.jsx(vs,{children:"Você tem certeza absoluta?"}),e.jsx(Es,{children:"Esta ação não pode ser desfeita. Isso irá apagar permanentemente sua conta e remover seus dados de nossos servidores."})]}),e.jsxs(ys,{children:[e.jsx(Ca,{children:"Cancelar"}),e.jsx(Oa,{onClick:h,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:"Sim, excluir conta"})]})]})]})]})]})})})]})},Ka=()=>{const{planStatus:a,settings:d,setSettings:n}=oe(),[h,f]=A.useState(!1),[m,u]=A.useState(!1),{toast:T}=Ce(),E=a==="PROFISSIONAL"||a==="STUDIO_PRO",O=d?.google_calendar_credentials?.access_token,b=async()=>{if(!E){f(!0);return}u(!0);try{const{authUrl:S,error:M}=await ya();if(M)throw new Error(M);window.location.href=S}catch(S){T({title:"Erro ao autenticar com Google",description:S.message,variant:"destructive"}),u(!1)}},j=()=>{const S={...d,google_calendar_credentials:null};n(S),T({title:"Google Calendar Desconectado",description:"A integração foi removida com sucesso."})};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg text-foreground",children:"Integrações"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Conecte o GO.FOTÓGRAFO com outras ferramentas para automatizar seu fluxo de trabalho."})]}),e.jsxs("div",{className:"border border-border rounded-lg p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-muted p-3 rounded-full",children:e.jsx(rs,{className:"w-6 h-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-foreground",children:"Google Calendar"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Sincronize seus agendamentos automaticamente."})]})]}),O?e.jsxs(N,{variant:"outline",onClick:j,children:[e.jsx(ha,{className:"w-4 h-4 mr-2 text-green-500"}),"Conectado"]}):E?e.jsxs(N,{onClick:b,disabled:m,children:[m?e.jsx(Ns,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(rs,{className:"w-4 h-4 mr-2"}),m?"Aguardando...":"Autenticar com Google"]}):e.jsx(We,{children:e.jsxs(qe,{children:[e.jsx(Ye,{asChild:!0,children:e.jsx("div",{className:"inline-block",children:e.jsxs(N,{onClick:()=>f(!0),children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Autenticar com Google"]})})}),e.jsx($e,{children:e.jsx("p",{children:"Funcionalidade Premium"})})]})})]}),e.jsx(Ve,{isOpen:h,onClose:()=>f(!1),featureName:"Integração com Google Calendar",requiredPlans:["PROFISSIONAL","STUDIO_PRO"],currentPlan:a})]})},fs=({type:a,onSubmit:d,isSubmitting:n})=>{const[h,f]=A.useState(""),[m,u]=A.useState(""),T=E=>{if(E.preventDefault(),a==="support"&&(!h||!m)){alert("Por favor, preencha o assunto e a mensagem.");return}if(a==="suggestion"&&!m){alert("Por favor, escreva sua sugestão.");return}d({type:a,subject:h,message:m}),f(""),u("")};return e.jsxs("form",{onSubmit:T,className:"space-y-4 p-1",children:[a==="support"&&e.jsxs("div",{children:[e.jsx("label",{htmlFor:"support-subject",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Assunto"}),e.jsx(vt,{id:"support-subject",type:"text",placeholder:"Ex: Dúvida sobre faturamento",value:h,onChange:E=>f(E.target.value),required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:`${a}-message`,className:"block text-sm font-medium text-muted-foreground mb-1",children:a==="support"?"Descreva seu problema":"Sua sugestão"}),e.jsx(ga,{id:`${a}-message`,placeholder:a==="support"?"Detalhe sua dúvida ou problema aqui...":"Como podemos melhorar o GO.FOTÓGRAFO?",value:m,onChange:E=>u(E.target.value),required:!0,rows:5})]}),e.jsxs(N,{type:"submit",className:"w-full btn-custom-gradient text-white",disabled:n,children:[n?e.jsx(ze,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(hs,{className:"w-4 h-4 mr-2"}),n?"Enviando...":"Enviar"]})]})},Za=({ticket:a,onSelect:d,isSelected:n})=>{const h=f=>{switch(f){case"aberto":return"warning";case"fechado":return"success";default:return"secondary"}};return e.jsxs("div",{className:ce("p-4 border rounded-lg cursor-pointer transition-all duration-200",n?"bg-muted border-primary":"hover:bg-muted/50"),onClick:()=>d(a.id),children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm text-foreground",children:a.assunto||"Sugestão"}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Protocolo: ",a.protocolo]})]}),e.jsx(xa,{variant:h(a.status),children:a.status})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:js(new Date(a.created_at),{addSuffix:!0,locale:gs})}),n?e.jsx(Ma,{className:"w-4 h-4"}):e.jsx(ba,{className:"w-4 h-4"})]})]})},Qa=({ticket:a,messages:d,onSendMessage:n,isSending:h,messageSenders:f})=>{const{user:m}=oe(),[u,T]=A.useState(""),E=b=>{b.preventDefault(),u.trim()&&(n(a.id,u),T(""))},O=(b,j)=>{if(j==="admin")return e.jsx(os,{className:"h-8 w-8",children:e.jsx(is,{className:"bg-primary text-primary-foreground",children:e.jsx(Et,{className:"h-5 w-5"})})});const S=f[b];return e.jsxs(os,{className:"h-8 w-8",children:[e.jsx(Ta,{src:S?.profile_photo,alt:S?.user_name}),e.jsx(is,{children:S?.user_name?.charAt(0).toUpperCase()||"U"})]})};return e.jsxs(se.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"mt-2 p-4 bg-muted/30 rounded-lg",children:[e.jsx(_a,{className:"h-64 pr-4",children:e.jsx("div",{className:"space-y-4",children:d.map(b=>{const j=b.sender_id===m.id;return e.jsxs("div",{className:ce("flex items-end gap-2",j?"flex-row-reverse":"flex-row"),children:[O(b.sender_id,b.sender_role),e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("div",{className:ce("p-3 rounded-lg max-w-xs md:max-w-md",j?"bg-primary text-primary-foreground":"bg-background"),children:e.jsx("p",{className:"text-sm",children:b.mensagem})}),e.jsx("p",{className:ce("text-xs text-muted-foreground",j?"text-right":"text-left"),children:js(new Date(b.created_at),{addSuffix:!0,locale:gs})})]})]},b.id)})})}),a.status==="aberto"&&e.jsxs("form",{onSubmit:E,className:"mt-4 flex gap-2",children:[e.jsx(vt,{value:u,onChange:b=>T(b.target.value),placeholder:"Digite sua resposta...",disabled:h}),e.jsx(N,{type:"submit",disabled:h,children:h?e.jsx(ze,{className:"w-4 h-4 animate-spin"}):e.jsx(hs,{className:"w-4 h-4"})})]})]})},Ja=({tickets:a,selectedTicketId:d,onSelectTicket:n,messages:h,onSendMessage:f,isSendingMessage:m,messageSenders:u})=>a.length===0?e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"Você ainda não abriu nenhum chamado."}):e.jsx("div",{className:"space-y-2",children:a.map(T=>e.jsxs("div",{children:[e.jsx(Za,{ticket:T,onSelect:n,isSelected:d===T.id}),d===T.id&&e.jsx(Qa,{ticket:T,messages:h[T.id]||[],onSendMessage:f,isSending:m,messageSenders:u})]},T.id))}),en=()=>{const{user:a}=oe(),{toast:d}=Ce(),[n,h]=A.useState("new"),[f,m]=A.useState([]),[u,T]=A.useState({}),[E,O]=A.useState({}),[b,j]=A.useState(null),[S,M]=A.useState(!0),[y,w]=A.useState(!1),[q,ie]=A.useState(!1),$=A.useCallback(async()=>{if(!a)return;M(!0);const{data:r,error:p}=await X.from("suporte_chamados").select("*").eq("user_id",a.id).order("created_at",{ascending:!1});p?d({title:"Erro ao buscar chamados",description:p.message,variant:"destructive"}):m(r),M(!1)},[a,d]);A.useEffect(()=>{$()},[$]);const Y=async r=>{const{data:p,error:o}=await X.from("suporte_mensagens").select("*").eq("chamado_id",r).order("created_at",{ascending:!0});if(o){d({title:"Erro ao buscar mensagens",description:o.message,variant:"destructive"});return}T(L=>({...L,[r]:p}));const Z=[...new Set(p.map(L=>L.sender_id))];if(Z.length>0){const{data:L,error:ae}=await X.from("settings").select("user_id, user_name, profile_photo").in("user_id",Z);if(ae)d({title:"Erro ao buscar dados dos remetentes",description:ae.message,variant:"destructive"});else{const Oe=L.reduce((ne,de)=>(ne[de.user_id]=de,ne),{});O(ne=>({...ne,...Oe}))}}},_e=r=>{b===r?j(null):(j(r),u[r]||Y(r))},F=async r=>{if(a){w(!0);try{const p=`GO-${Date.now()}`,{data:o,error:Z}=await X.from("suporte_chamados").insert({user_id:a.id,protocolo:p,tipo:r.type,assunto:r.subject,status:"aberto"}).select().single();if(Z)throw Z;const{error:L}=await X.from("suporte_mensagens").insert({chamado_id:o.id,sender_id:a.id,sender_role:"user",mensagem:r.message});if(L)throw L;d({title:"Enviado com sucesso!",description:`Seu protocolo é ${p}.`}),await $(),h("history")}catch(p){d({title:"Erro ao enviar",description:p.message,variant:"destructive"})}finally{w(!1)}}},R=async(r,p)=>{if(a){ie(!0);try{const{error:o}=await X.from("suporte_mensagens").insert({chamado_id:r,sender_id:a.id,sender_role:"user",mensagem:p});if(o)throw o;await Y(r)}catch(o){d({title:"Erro ao enviar mensagem",description:o.message,variant:"destructive"})}finally{ie(!1)}}},K=()=>{if(n==="new")return e.jsxs(ft,{children:[e.jsxs(pt,{children:[e.jsx(ht,{children:"Abrir Novo Chamado"}),e.jsx(gt,{children:"Precisa de ajuda ou tem uma sugestão? Nos diga aqui."})]}),e.jsx(xt,{children:e.jsx(fs,{type:"support",onSubmit:F,isSubmitting:y})})]});if(n==="suggestion")return e.jsxs(ft,{children:[e.jsxs(pt,{children:[e.jsx(ht,{children:"Enviar Sugestão"}),e.jsx(gt,{children:"Adoramos ouvir suas ideias para melhorar o GO.FOTÓGRAFO!"})]}),e.jsx(xt,{children:e.jsx(fs,{type:"suggestion",onSubmit:F,isSubmitting:y})})]});if(n==="history")return e.jsxs(ft,{children:[e.jsxs(pt,{children:[e.jsx(ht,{children:"Histórico de Chamados"}),e.jsx(gt,{children:"Acompanhe suas solicitações e sugestões."})]}),e.jsx(xt,{children:S?e.jsx(ze,{className:"mx-auto my-8 h-8 w-8 animate-spin"}):e.jsx(Ja,{tickets:f,selectedTicketId:b,onSelectTicket:_e,messages:u,onSendMessage:R,isSendingMessage:q,messageSenders:E})})]})};return e.jsxs(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.6},children:[e.jsxs("div",{className:"flex space-x-1 bg-muted p-1 rounded-lg mb-4",children:[e.jsxs(N,{onClick:()=>h("new"),className:ce("flex-1 h-9 text-sm",n==="new"?"bg-background text-foreground shadow-sm":"bg-transparent text-muted-foreground"),children:[e.jsx(Et,{className:"w-4 h-4 mr-2"})," Novo Suporte"]}),e.jsxs(N,{onClick:()=>h("suggestion"),className:ce("flex-1 h-9 text-sm",n==="suggestion"?"bg-background text-foreground shadow-sm":"bg-transparent text-muted-foreground"),children:[e.jsx(La,{className:"w-4 h-4 mr-2"})," Sugestão"]}),e.jsxs(N,{onClick:()=>h("history"),className:ce("flex-1 h-9 text-sm",n==="history"?"bg-background text-foreground shadow-sm":"bg-transparent text-muted-foreground"),children:[e.jsx(_s,{className:"w-4 h-4 mr-2"})," Meus Chamados"]})]}),e.jsx(xs,{mode:"wait",children:e.jsx(se.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:K()},n)})]})},re={language:"pt-BR",currency:"BRL",timezone:"America/Sao_Paulo",date_format:"dd/mm/yyyy",notifications:{email:!0,whatsapp:!0,calendar:!0},automation:{session_reminder:!1,payment_reminder:!1,meeting_reminder:!1,pre_event_sequence:!1,post_event_sequence:!1},user_name:"",business_name:"",photography_type:"",cnpj:"",cpf:"",phones:[{number:""}],contact_email:"",website_social:[{type:"website",url:""}],address:"",profile_photo:null,logo:null,subdomain:"",hide_dashboard_balances:!1,workflow_columns:null,google_calendar_credentials:null,show_greetings:!0},we=({title:a,icon:d,children:n,delay:h,className:f})=>e.jsx(se.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:h},className:`bg-card rounded-xl shadow-lg border border-border ${f}`,children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-customPurple to-customGreen rounded-lg flex items-center justify-center",children:e.jsx(d,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:a})]}),e.jsx("div",{className:"space-y-6",children:n})]})}),En=({isMobile:a,updateUrl:d})=>{const{settings:n,setSettings:h,user:f}=oe(),{toast:m}=Ce(),[u,T]=A.useState(re),E=Aa(),O=Sa(),[b,j]=A.useState("preferences"),{isMobile:S}=va(),M=A.useCallback(async r=>{try{const{tokens:p,error:o}=await Na(r);if(o)throw new Error(o);const Z={...n,google_calendar_credentials:p};await h(Z),m({title:"Google Calendar Conectado!",description:"Sua conta foi autenticada com sucesso."})}catch(p){m({title:"Erro na autenticação",description:`Não foi possível conectar com o Google Calendar: ${p.message}`,variant:"destructive"})}finally{O("/settings?tab=integrations",{replace:!0})}},[n,h,m,O]);A.useEffect(()=>{const r=new URLSearchParams(E.search),p=r.get("code"),o=r.get("tab")||"preferences";p&&M(p),["preferences","functionalities","integrations","security","dataManagement","support"].includes(o)?j(o):j("preferences")},[E.search,M]);const y=r=>{j(r),O(`/settings?tab=${r}`,{replace:!0})};A.useEffect(()=>{if(n){const r={};for(const p in re)n.hasOwnProperty(p)?p==="show_greetings"?r[p]=n[p]===null||n[p]===void 0?!0:n[p]:typeof re[p]=="object"&&re[p]!==null&&!Array.isArray(re[p])?r[p]={...re[p],...n[p]}:r[p]=n[p]:r[p]=re[p];!r.user_name&&f?.user_metadata?.full_name&&(r.user_name=f.user_metadata.full_name),!r.contact_email&&f?.email&&(r.contact_email=f.email),T(r)}},[n,f]);const w=(r,p)=>{T(o=>({...o,[r]:p}))},q=(r,p)=>{T(o=>({...o,notifications:{...o.notifications,[r]:p}}))},ie=(r,p)=>{T(o=>({...o,automation:{...o.automation||re.automation,[r]:p}}))},$=()=>{const r={...u};r.show_greetings=u.show_greetings,delete r.google_calendar_credentials,h(r),m({title:"Configurações salvas 💾",description:"Suas configurações foram atualizadas com sucesso!"})},Y={formData:u,handleInputChange:w,toast:m},_e={...Y,handleNotificationChange:q},F={...Y,handleAutomationChange:ie},R=()=>e.jsxs(N,{onClick:$,className:"btn-custom-gradient text-white shadow-lg w-full sm:w-auto",children:[e.jsx(Ea,{className:"w-4 h-4 mr-2"}),"Salvar Alterações"]}),K=()=>{switch(b){case"preferences":return e.jsxs(we,{title:"Preferências e Aparência",icon:St,delay:.1,children:[e.jsx(Pa,{...Y,formData:u,handleInputChange:w}),e.jsx(Ya,{})]});case"functionalities":return e.jsxs(we,{title:"Funcionalidades do Sistema",icon:ls,delay:.2,children:[e.jsx(qa,{..._e,formData:u}),e.jsx(Va,{...F,formData:u}),e.jsx($a,{...Y,formData:u})]});case"integrations":return e.jsx(we,{title:"Integrações",icon:cs,delay:.3,children:e.jsx(Ka,{...Y})});case"security":return e.jsx(we,{title:"Segurança da Conta",icon:At,delay:.4,children:e.jsx(Wa,{...Y})});case"dataManagement":return e.jsx(we,{title:"Gerenciamento de Dados",icon:Tt,delay:.5,children:e.jsx(Xa,{...Y})});case"support":return e.jsx(en,{});default:return null}};return e.jsxs("div",{className:"space-y-8 pb-12",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs(se.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:S?"hidden":"",children:[e.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Configurações do Sistema"}),e.jsx("p",{className:"text-muted-foreground mt-1",children:"Ajuste suas preferências e funcionalidades."})]}),!S&&e.jsx(R,{})]}),e.jsx("div",{className:"flex space-x-1 border-b border-border mb-6 overflow-x-auto scrollbar-thin pb-px",children:[{id:"preferences",label:"Preferências",icon:St},{id:"functionalities",label:"Funcionalidades",icon:ls},{id:"integrations",label:"Integrações",icon:cs},{id:"security",label:"Segurança",icon:At},{id:"dataManagement",label:"Dados",icon:Tt},{id:"support",label:"Suporte",icon:Et}].map(r=>e.jsxs(N,{variant:b===r.id?"default":"ghost",onClick:()=>y(r.id),className:`rounded-b-none whitespace-nowrap px-3 py-2 h-auto sm:px-4 ${b===r.id?"bg-primary/5 text-primary border-b-2 border-primary":"text-muted-foreground"}`,children:[e.jsx(r.icon,{className:`w-4 h-4 ${S?"":"mr-2"}`}),!S&&r.label]},r.id))}),e.jsx(xs,{mode:"wait",children:e.jsx(se.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{duration:.2},children:K()},b)}),S&&e.jsx("div",{className:"mt-8",children:e.jsx(R,{})})]})};export{En as default};
