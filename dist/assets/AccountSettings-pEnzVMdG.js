import{c as K,j as e,m as y,a7 as z,am as Q,I,B as b,T as L,aA as W,av as X,ae as B,M as V,a3 as Y,r as j,l as G,at as ee,s as $,e as se,f as ae,u as te,o as oe,aP as re}from"./index-qkwE8oul.js";import{M as ie}from"./map-pin-i1kVnY2z.js";import{A as le,b as ne,c as ce,d as de,e as me,f as ue,g as pe,h as xe}from"./alert-dialog-CrFx3DpK.js";import{P as ge}from"./palette-BFhiGEsu.js";import{U as q}from"./upload-d4kurEQA.js";const Z=K("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]),he="w-[120px] px-3 py-2 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-700 text-slate-900 dark:text-slate-100 focus:ring-2 focus:ring-customPurple focus:border-transparent",N=(s,a,c,o,x="",h="text",d)=>{const n=d;return e.jsxs("div",{children:[e.jsx("label",{htmlFor:a,className:"block text-sm font-medium text-muted-foreground mb-1",children:s}),e.jsxs("div",{className:"relative",children:[n&&e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400 dark:text-slate-500"}),e.jsx(I,{id:a,type:h,value:c||"",onChange:t=>o(t.target.value),placeholder:x,className:n?"pl-10":""})]})]})},fe=({formData:s,handleInputChange:a,handleNestedInputChange:c,addNestedItem:o,removeNestedItem:x})=>{const h=[{value:"website",label:"Site"},{value:"instagram",label:"Instagram"},{value:"facebook",label:"Facebook"},{value:"linkedin",label:"LinkedIn"},{value:"other",label:"Outro"}];if(!s)return e.jsx(y.div,{className:"bg-card rounded-xl p-6 shadow-lg border border-border lg:col-span-1",children:"Carregando..."});const d=Array.isArray(s.phones)?s.phones:[],n=Array.isArray(s.website_social)?s.website_social:[];return e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:0*.05},className:"bg-card rounded-xl p-6 shadow-lg border border-border lg:col-span-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-customPurple to-customGreen rounded-lg flex items-center justify-center",children:e.jsx(z,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:"Informações Pessoais e da Empresa"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[N("Nome Completo","user_name",s.user_name,t=>a("user_name",t),"Seu nome completo","text",z),N("Nome da Empresa (Fantasia)","business_name",s.business_name,t=>a("business_name",t),"Nome da sua empresa","text",W),N("Tipo de Fotografia Principal","photography_type",s.photography_type,t=>a("photography_type",t),"Ex: Casamentos, Ensaios","text",X),N("CNPJ (se aplicável)","cnpj",s.cnpj,t=>a("cnpj",t),"00.000.000/0000-00","text",B),N("CPF (para MEI/Autônomo)","cpf",s.cpf,t=>a("cpf",t),"000.000.000-00","text",B),N("E-mail Principal de Contato","contact_email",s.contact_email,t=>a("contact_email",t),"seu@email.com","email",V),N("Endereço Comercial","address",s.address,t=>a("address",t),"Rua, Número, Bairro, Cidade - Estado","text",ie),e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground",children:"Telefone(s)"}),d.map((t,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Q,{className:"w-4 h-4 text-slate-400 dark:text-slate-500 shrink-0"}),e.jsx(I,{type:"tel",value:t?.number||"",onChange:u=>c("phones",r,"number",u.target.value),placeholder:"(99) 99999-9999",className:"flex-grow"}),d.length>1&&e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>x("phones",r),children:e.jsx(L,{className:"w-4 h-4 text-red-500"})})]},r)),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>o("phones",{number:""}),children:"Adicionar Telefone"})]}),e.jsxs("div",{className:"md:col-span-2 space-y-3",children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground",children:"Site / Redes Sociais"}),n.map((t,r)=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Z,{className:"w-4 h-4 text-slate-400 dark:text-slate-500 shrink-0"}),e.jsx("select",{value:t?.type||"website",onChange:u=>c("website_social",r,"type",u.target.value),className:he,children:h.map(u=>e.jsx("option",{value:u.value,children:u.label},u.value))}),e.jsx(I,{type:"url",value:t?.url||"",onChange:u=>c("website_social",r,"url",u.target.value),placeholder:"https://...",className:"flex-grow"}),n.length>1&&e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>x("website_social",r),children:e.jsx(L,{className:"w-4 h-4 text-red-500"})})]},r)),e.jsx(b,{variant:"outline",size:"sm",onClick:()=>o("website_social",{type:"website",url:""}),children:"Adicionar Link"})]})]})]})},be=(s,a,c,o,x="",h="text",d)=>{const n=d;return e.jsxs("div",{children:[e.jsx("label",{htmlFor:a,className:"block text-sm font-medium text-muted-foreground mb-1",children:s}),e.jsxs("div",{className:"relative",children:[n&&e.jsx(n,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400 dark:text-slate-500"}),e.jsx(I,{id:a,type:h,value:c||"",onChange:t=>o(t.target.value),placeholder:x,className:n?"pl-10":""})]})]})},je=({formData:s,handleInputChange:a,toast:c})=>{const{user:o,setSettings:x,settings:h}=Y(),d=j.useRef(null),n=j.useRef(null),[t,r]=j.useState(!1),[u,_]=j.useState(!1),[v,P]=j.useState({type:null,url:null}),[T,k]=j.useState(!1),A=5,E=A*1024*1024,w=["image/png","image/jpeg","image/gif","image/webp"],i=async(g,l)=>{const p=g.target.files?.[0];if(!p||!o)return;if(p.size>E){c({title:"Arquivo Muito Grande",description:`O arquivo deve ter no máximo ${A}MB.`,variant:"destructive"});return}if(!w.includes(p.type)){c({title:"Tipo de Arquivo Inválido",description:"Por favor, selecione um arquivo PNG, JPG, GIF ou WEBP.",variant:"destructive"});return}l==="profile"&&r(!0),l==="logo"&&_(!0);const F=p.name,R=ee(F).split(".").pop(),D=`${l==="profile"?"profile_photo":"logo"}_${Date.now()}${R?"."+R:""}`,O=`public/${o.id}/${D}`;try{const{error:S}=await $.storage.from("user_assets").upload(O,p,{cacheControl:"3600",upsert:!0});if(S)throw S;const{data:C}=$.storage.from("user_assets").getPublicUrl(O);if(!C||!C.publicUrl)throw new Error("Não foi possível obter a URL pública do arquivo.");const U={...h,...s};l==="profile"?U.profile_photo=C.publicUrl:l==="logo"&&(U.logo=C.publicUrl),await x(U),a(l==="profile"?"profile_photo":"logo",C.publicUrl),c({title:`${l==="profile"?"Foto de Perfil":"Logotipo"} Atualizado(a)!`,description:"Sua imagem foi enviada com sucesso."})}catch(S){console.error(`Error uploading ${l}:`,S),c({title:`Erro ao Enviar ${l==="profile"?"Foto de Perfil":"Logotipo"}`,description:S.message||"Ocorreu um problema ao enviar sua imagem.",variant:"destructive"})}finally{l==="profile"&&r(!1),l==="logo"&&_(!1),d.current&&(d.current.value=""),n.current&&(n.current.value="")}},m=(g,l)=>{l&&(P({type:g,url:l}),k(!0))},f=async()=>{if(!v.type||!v.url||!o)return;const g=v.url.substring(v.url.lastIndexOf("/")+1),l=`public/${o.id}/${g}`;try{const{error:p}=await $.storage.from("user_assets").remove([l]);if(p&&p.message!=="The resource was not found"&&!p.message.includes("No objects found"))throw p;const F=v.type==="profile"?"profile_photo":"logo",M={...h,...s,[F]:null};await x(M),a(F,null),c({title:"Imagem Removida",description:`Sua ${v.type==="profile"?"foto de perfil":"logotipo"} foi removida.`})}catch(p){console.error(`Error deleting ${v.type}:`,p),c({title:"Erro ao Remover Imagem",description:p.message||"Ocorreu um problema ao remover a imagem.",variant:"destructive"})}finally{k(!1),P({type:null,url:null})}};return e.jsxs(e.Fragment,{children:[e.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-card rounded-xl p-6 shadow-lg border border-border lg:col-span-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-customPurple to-customGreen rounded-lg flex items-center justify-center",children:e.jsx(ge,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-xl font-semibold text-card-foreground",children:"Marca (Branding)"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"Foto de Perfil"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-customPurple to-customGreen rounded-full flex items-center justify-center text-white font-semibold text-xl overflow-hidden",children:s.profile_photo?e.jsx("img",{src:s.profile_photo,alt:"Profile",className:"w-full h-full object-cover"}):s.user_name?s.user_name.charAt(0).toUpperCase():"G"}),e.jsx("input",{type:"file",ref:d,onChange:g=>i(g,"profile"),accept:w.join(","),style:{display:"none"},id:"profilePhotoUpload"}),e.jsxs(b,{onClick:()=>d.current?.click(),variant:"outline",disabled:t,children:[t?e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(q,{className:"w-4 h-4 mr-2"}),t?"Enviando...":"Alterar Foto"]}),s.profile_photo&&e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>m("profile",s.profile_photo),className:"text-red-500 hover:text-red-600",children:e.jsx(L,{size:16})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-muted-foreground mb-2",children:"Logotipo da Empresa"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-slate-100 dark:bg-slate-700 rounded-lg flex items-center justify-center border-2 border-dashed border-border overflow-hidden",children:s.logo?e.jsx("img",{src:s.logo,alt:"Logo",className:"w-14 h-14 object-contain"}):e.jsx(X,{className:"w-8 h-8 text-slate-400"})}),e.jsx("input",{type:"file",ref:n,onChange:g=>i(g,"logo"),accept:w.join(","),style:{display:"none"},id:"logoUpload"}),e.jsxs(b,{onClick:()=>n.current?.click(),variant:"outline",disabled:u,children:[u?e.jsx(G,{className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(q,{className:"w-4 h-4 mr-2"}),u?"Enviando...":s.logo?"Alterar Logo":"Adicionar Logo"]}),s.logo&&e.jsx(b,{variant:"ghost",size:"icon",onClick:()=>m("logo",s.logo),className:"text-red-500 hover:text-red-600",children:e.jsx(L,{size:16})})]}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Substitui a marca GO.FOTÓGRAFO quando definido."})]}),be("Subdomínio Personalizado","subdomain",s.subdomain,g=>a("subdomain",g),"meusite","text",Z),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Crie um subdomínio como ",e.jsx("code",{className:"bg-muted px-1 rounded",children:"meusite.gofotografo.com"})," (funcionalidade futura)."]})]})]}),e.jsx(le,{open:T,onOpenChange:k,children:e.jsxs(ne,{children:[e.jsxs(ce,{children:[e.jsx(de,{children:"Confirmar Remoção"}),e.jsx(me,{children:"Tem certeza que deseja remover esta imagem? A imagem será excluída do armazenamento."})]}),e.jsxs(ue,{children:[e.jsx(pe,{onClick:()=>P({type:null,url:null}),children:"Cancelar"}),e.jsx(xe,{onClick:f,className:"bg-red-600 hover:bg-red-700",children:"Remover Imagem"})]})]})})]})},H={user_name:"",business_name:"",photography_type:"",cnpj:"",cpf:"",phones:[{number:""}],contact_email:"",website_social:[{type:"website",url:""}],address:"",profile_photo:null,logo:null,subdomain:""},J=({title:s,icon:a,children:c,delay:o,className:x})=>e.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o},className:`bg-card rounded-xl shadow-lg border border-border ${x}`,children:e.jsxs("div",{className:"p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-customPurple to-customGreen rounded-lg flex items-center justify-center",children:e.jsx(a,{className:"w-5 h-5 text-white"})}),e.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-card-foreground",children:s})]}),e.jsx("div",{className:"space-y-4 sm:space-y-6",children:c})]})}),ke=({isMobile:s})=>{const{settings:a,setSettings:c,user:o}=Y(),{toast:x}=se(),[h,d]=j.useState(H),n=ae(),t=te(),[r,u]=j.useState("profile");j.useEffect(()=>{const m=new URLSearchParams(n.search).get("tab");u(m==="profile"||m==="branding"?m:"profile")},[n.search]);const _=i=>{u(i);const m=new URLSearchParams(n.search);m.set("tab",i),t(`${n.pathname}?${m.toString()}`,{replace:!0})};j.useEffect(()=>{a?d(i=>({...H,...i,...a,user_name:a.user_name||o?.user_metadata?.full_name||o?.email||"",contact_email:a.contact_email||o?.email||"",phones:a.phones&&a.phones.length>0?a.phones:[{number:""}],website_social:a.website_social&&a.website_social.length>0?a.website_social:[{type:"website",url:""}]})):o&&d(i=>({...i,user_name:o?.user_metadata?.full_name||o?.email||"",contact_email:o?.email||""}))},[a,o]);const v=(i,m)=>{d(f=>({...f,[i]:m}))},P=(i,m,f,g)=>{d(l=>{const p=[...l[i]||[]];return p[m]={...p[m],[f]:g},{...l,[i]:p}})},T=(i,m)=>{d(f=>({...f,[i]:[...f[i]||[],m]}))},k=(i,m)=>{d(f=>({...f,[i]:(f[i]||[]).filter((g,l)=>l!==m)}))},A=()=>{c(h),x({title:"Configurações da Conta Salvas 💾",description:"Suas informações foram atualizadas com sucesso!"})},E={formData:h,handleInputChange:v,handleNestedInputChange:P,addNestedItem:T,removeNestedItem:k,toast:x},w=()=>e.jsxs(b,{onClick:A,className:"btn-custom-gradient text-white shadow-lg w-full sm:w-auto text-sm sm:text-base",children:[e.jsx(re,{className:"w-4 h-4 mr-2"}),"Salvar Alterações"]});return e.jsxs("div",{className:"space-y-6 sm:space-y-8 pb-12",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs(y.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:"Minha Conta"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:"Gerencie suas informações pessoais e da sua marca."})]}),!s&&e.jsx(w,{})]}),e.jsxs("div",{className:"flex space-x-1 border-b border-border mb-6",children:[e.jsx(b,{variant:"ghost",onClick:()=>_("profile"),className:`rounded-b-none ${r==="profile"?"bg-muted text-foreground":"text-muted-foreground"}`,children:"Perfil"}),e.jsx(b,{variant:"ghost",onClick:()=>_("branding"),className:`rounded-b-none ${r==="branding"?"bg-muted text-foreground":"text-muted-foreground"}`,children:"Marca"})]}),e.jsx(oe,{mode:"wait",children:e.jsxs(y.div,{initial:{opacity:0,x:r==="profile"?-20:20},animate:{opacity:1,x:0},exit:{opacity:0,x:r==="profile"?20:-20},transition:{duration:.2},children:[r==="profile"&&e.jsx(J,{title:"Informações Pessoais",icon:z,delay:.1,children:e.jsx(fe,{...E})}),r==="branding"&&e.jsx(J,{title:"Marca e Empresa",icon:W,delay:.1,children:e.jsx(je,{...E})})]},r)}),s&&e.jsx("div",{className:"mt-8",children:e.jsx(w,{})})]})};export{ke as default};
