import{c as Ce,D as Ae,j as e,m as E,C as Se,R as te,K as Te,N as De,B as P,O as _e,P as re,T as ce,ab as I,J as q,a3 as J,e as F,r as p,aR as Pe,al as Le,aS as de,a7 as Ee,Q as Re,V as Me,W as Be,X as Ie,Y as Oe,h as M,I as W,Z as Q,_ as Z,$ as K,a0 as X,a1 as $,i as Ge,av as $e,o as ne,q as ze,t as We,v as qe,x as Ve,aA as Ue,aJ as Ye,b as Je,at as oe}from"./index-4y5FCHHl.js";import{T as ee}from"./trending-up-DBWdzr9z.js";import{T as ae}from"./trending-down-C2BV_wf8.js";import{F as He}from"./filter-k8xRknSZ.js";import{A as ie,b as me,c as ue,d as xe,e as pe,f as he,g as ge,h as fe}from"./alert-dialog-DhXlLYQ6.js";import{T as Qe,a as Ze,b as Ke,c as Xe}from"./tooltip-DRDfD7tc.js";import{H as Fe}from"./hourglass-BzmXQq8M.js";import{M as ea}from"./more-vertical-Bu4bVqw0.js";import{P as ye}from"./pen-square-CiA3dyIU.js";import{p as O}from"./pt-BR-BZmCGEt5.js";import{s as aa}from"./startOfMonth-U3noRVTS.js";import{e as sa}from"./endOfMonth-9pjN7R8H.js";import{e as ta}from"./endOfWeek-MHS3Dlbt.js";import{e as ra}from"./endOfDay-C-GA39Ru.js";import{P as na}from"./plus-circle-wCnyduKs.js";import{L as oa}from"./landmark-DmSNNh5Y.js";import{S as la}from"./search-bD9a7EgF.js";import"./extends-CF3RwP-h.js";const ca=Ce("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]),da=({title:a,value:n,icon:c,color:s,bgColor:u,delay:o})=>e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o},className:`${u} bg-card rounded-xl p-6 shadow-lg border border-border card-hover`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:a}),e.jsx("p",{className:"text-2xl font-bold text-foreground mt-1",children:n})]}),e.jsx("div",{className:`w-12 h-12 rounded-lg bg-gradient-to-br ${s} flex items-center justify-center`,children:e.jsx(c,{className:"w-6 h-6 text-white"})})]})}),ia=({summary:a})=>{const n=[{title:"Faturamento Total (Pago)",value:`R$ ${(a.totalRevenue||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,icon:ee,color:"from-green-500 to-emerald-600",bgColor:"dark:bg-green-900/10"},{title:"Despesas Totais (Pagas)",value:`R$ ${(a.totalExpenses||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,icon:ae,color:"from-red-500 to-pink-600",bgColor:"dark:bg-red-900/10"},{title:"Lucro Líquido (Pago)",value:`R$ ${(a.netBalance||0).toLocaleString("pt-BR",{minimumFractionDigits:2})}`,icon:Ae,color:(a.netBalance||0)>=0?"from-blue-500 to-cyan-600":"from-red-500 to-pink-600",bgColor:(a.netBalance||0)>=0?"dark:bg-blue-900/10":"dark:bg-red-900/10"}];return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:n.map((c,s)=>e.jsx(da,{...c,delay:s*.1},c.title))})},le="w-full md:w-auto px-3 py-2 border border-border rounded-lg bg-background text-foreground focus:ring-2 focus:ring-primary focus:border-transparent",ma=({filterType:a,setFilterType:n,filterPeriod:c,setFilterPeriod:s})=>{const u=m=>{n(m==="ALL"?"ALL":m)},o=m=>{s(m==="all-periods"?"all":m)};return e.jsx(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-card rounded-xl p-6 shadow-lg border border-border",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(He,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("select",{value:a,onChange:m=>u(m.target.value),className:le,children:[e.jsx("option",{value:"ALL",children:"Todos os tipos"}),e.jsx("option",{value:"ENTRADA",children:"Entradas"}),e.jsx("option",{value:"SAIDA",children:"Saídas"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4 text-muted-foreground"}),e.jsxs("select",{value:c,onChange:m=>o(m.target.value),className:le,children:[e.jsx("option",{value:"all",children:"Todos os períodos"}),e.jsx("option",{value:"today",children:"Hoje"}),e.jsx("option",{value:"week",children:"Esta semana"}),e.jsx("option",{value:"month",children:"Este mês"})]})]})]})})},ua=({transactions:a,onEdit:n,onDelete:c,isMobile:s})=>{const[u,o]=te.useState(!1),[m,x]=te.useState(null),y=t=>{x(t),o(!0)},h=()=>{m&&c(m),o(!1),x(null)},v=()=>{o(!1),x(null)},k=t=>{if(!t)return"N/A";try{const l=I(t);return isNaN(l.getTime())?"Data inválida":s?q(l,"dd/MM/yy",{locale:O}):q(l,"dd/MM/yyyy",{locale:O})}catch(l){return console.error("Error formatting date:",t,l),"Data inválida"}};return e.jsxs(e.Fragment,{children:[e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-card rounded-xl shadow-lg border border-border",children:[e.jsx("div",{className:"p-6 border-b border-border",children:e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Últimos Lançamentos"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-accent/50 dark:bg-accent/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Data"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Descrição"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider ${s?"hidden":"table-cell"}`,children:"Carteira"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:`px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider ${s?"hidden":"table-cell"}`,children:"Pagamento"}),e.jsx("th",{className:"px-4 sm:px-6 py-3 text-right text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:a.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:s?5:7,className:"px-6 py-8 text-center text-muted-foreground",children:"Nenhum lançamento encontrado."})}):a.map(t=>e.jsxs("tr",{className:`
                      ${t.tipo==="ENTRADA"?"bg-green-500/5 dark:bg-green-500/10":"bg-red-500/5 dark:bg-red-500/10"}
                      hover:bg-accent/50 dark:hover:bg-accent/30
                    `,children:[e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-foreground",children:k(t.data_recebimento||t.release_date||t.data_vencimento||t.created_at)}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-foreground truncate max-w-[100px] sm:max-w-xs",title:t.descricao,children:t.descricao}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-muted-foreground ${s?"hidden":"table-cell"}`,children:t.wallet?e.jsxs("div",{className:"flex items-center",children:[t.wallet.icon_url&&e.jsx("img",{src:t.wallet.icon_url,alt:t.wallet.name,className:"w-4 h-4 mr-2 object-contain"}),e.jsx("span",{className:"truncate",children:t.wallet.name})]}):"N/A"}),e.jsxs("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm font-medium",children:[e.jsxs("span",{className:t.tipo==="ENTRADA"?"text-customGreen":"text-red-500",children:[t.tipo==="SAIDA"?"- R$ ":"+ R$ ",Number(t.valor).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),t.original_value&&e.jsx(Qe,{children:e.jsxs(Ze,{children:[e.jsx(Ke,{asChild:!0,children:e.jsxs("span",{className:"ml-1 text-xs text-muted-foreground cursor-help",children:["(de ",Number(t.original_value).toLocaleString("pt-BR",{style:"currency",currency:"BRL"}),")"]})}),e.jsx(Xe,{children:e.jsxs("p",{children:["Taxa de R$ ",Number(t.fee_value).toLocaleString("pt-BR",{minimumFractionDigits:2})," descontada"]})})]})})]}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-sm text-muted-foreground",children:e.jsxs("span",{className:`inline-flex items-center px-2 py-1 text-xs font-semibold rounded-full ${t.status==="PAGO"?"bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100":t.status==="PENDENTE"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-100":t.status==="AGUARDANDO_LIBERACAO"?"bg-blue-100 text-blue-800 dark:bg-blue-700 dark:text-blue-100":t.status==="CANCELADO"?"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200":"bg-red-100 text-red-800 dark:bg-red-700 dark:text-red-100"}`,children:[t.status==="AGUARDANDO_LIBERACAO"&&e.jsx(Fe,{className:"w-3 h-3 mr-1"}),t.status.replace(/_/g," ")]})}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-muted-foreground ${s?"hidden":"table-cell"}`,children:t.metodo_pagamento||"N/A"}),e.jsx("td",{className:"px-4 sm:px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs(Te,{children:[e.jsx(De,{asChild:!0,children:e.jsx(P,{variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(ea,{className:"h-4 w-4"})})}),e.jsxs(_e,{align:"end",children:[e.jsxs(re,{onClick:()=>n(t),children:[e.jsx(ye,{className:"mr-2 h-4 w-4"})," Editar"]}),e.jsxs(re,{onClick:()=>y(t.id),className:"text-red-600 dark:text-red-400 hover:!text-red-600 dark:hover:!text-red-400",children:[e.jsx(ce,{className:"mr-2 h-4 w-4"})," Excluir"]})]})]})})]},t.id))})]})})]}),e.jsx(ie,{open:u,onOpenChange:o,children:e.jsxs(me,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:"Confirmar Exclusão"}),e.jsx(pe,{children:"Tem certeza que deseja excluir este lançamento? Esta ação não pode ser desfeita."})]}),e.jsxs(he,{children:[e.jsx(ge,{onClick:v,children:"Cancelar"}),e.jsx(fe,{onClick:h,className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})})]})},xa=({data:a})=>e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-card rounded-xl p-6 shadow-lg border border-border",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Resumo de Meses Anteriores (Últimos 3 meses)"})}),e.jsx("div",{className:"space-y-4",children:a.length>0?a.map((n,c)=>{const s=n.revenue+n.expenses,u=s>0?n.revenue/s*100:0,o=s>0?n.expenses/s*100:0;return e.jsxs(E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:c*.1},className:"p-4 bg-background/50 rounded-lg border border-border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"font-semibold text-foreground",children:n.monthYear}),e.jsxs("span",{className:"text-xs text-muted-foreground",children:[n.transactions," transações"]})]}),e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsxs("div",{className:"flex items-center text-sm text-green-600 dark:text-green-400",children:[e.jsx(ee,{size:16,className:"mr-1"}),"Receitas: R$ ",Number(n.revenue).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("div",{className:"flex items-center text-sm text-red-600 dark:text-red-400",children:[e.jsx(ae,{size:16,className:"mr-1"}),"Despesas: R$ ",Number(n.expenses).toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),s>0&&e.jsxs("div",{className:"w-full bg-muted rounded-full h-2.5",children:[e.jsx("div",{className:"bg-green-500 h-2.5 rounded-l-full",style:{width:`${u}%`,display:"inline-block"},title:`Receitas: ${u.toFixed(1)}%`}),e.jsx("div",{className:"bg-red-500 h-2.5 rounded-r-full",style:{width:`${o}%`,display:"inline-block",marginLeft:u>0&&o>0?"-1px":"0"},title:`Despesas: ${o.toFixed(1)}%`})]})]},n.monthYear)}):e.jsx("p",{className:"text-muted-foreground text-center py-4",children:"Nenhum dado para os últimos 3 meses."})})]}),pa=a=>{const{financialData:n,deleteTransaction:c,workflowCards:s,getClientById:u,wallets:o}=J(),{toast:m}=F(),[x,y]=p.useState(!1),[h,v]=p.useState("entrada"),[k,t]=p.useState(null),[l,R]=p.useState(""),[C,b]=p.useState(()=>a&&a.isDashboardClick?a.type==="saida"&&a.status==="pendente"&&a.period==="future"?"SAIDA":a.type==="entrada"&&a.status==="pendente"?"ALL":a.type==="entrada"&&a.status==="pago"?"ENTRADA":a.type==="saida"&&a.status==="pago"?"SAIDA":a.type?.toUpperCase()||"ALL":"ALL"),[j,A]=p.useState(()=>a&&a.isDashboardClick?a.type==="saida"&&a.status==="pendente"&&a.period==="future"?"all":a.period||"all":"all"),[G,N]=p.useState(()=>a&&a.isDashboardClick?a.type==="entrada"&&a.status==="pendente":!1);p.useEffect(()=>{a&&a.isDashboardClick?a.type==="saida"&&a.status==="pendente"&&a.period==="future"?(b("SAIDA"),A("all"),N(!1)):a.type==="entrada"&&a.status==="pendente"?(N(!0),b("ALL"),A("all")):a.type==="entrada"&&a.status==="pago"?(N(!1),b("ENTRADA"),A("all")):a.type==="saida"&&a.status==="pago"?(N(!1),b("SAIDA"),A("all")):(b(a.type?.toUpperCase()||"ALL"),A(a.period||"all"),N(!1)):(!a||Object.keys(a).length===0)&&(N(!1),b("ALL"),A("all"))},[a]);const w=p.useMemo(()=>{const d=n.transactions.filter(f=>f.tipo==="ENTRADA"&&f.status==="PAGO").reduce((f,D)=>f+Number(D.valor),0),r=n.transactions.filter(f=>f.tipo==="SAIDA"&&f.status==="PAGO").reduce((f,D)=>f+Number(D.valor),0),g=d-r;return{totalRevenue:d,totalExpenses:r,netBalance:g}},[n.transactions]),H=p.useMemo(()=>{let d=n.transactions.map(r=>({...r,wallet:o.find(g=>g.id===r.wallet_id)}));if(l){const r=l.toLowerCase();d=d.filter(g=>g.descricao.toLowerCase().includes(r)||g.valor.toString().includes(r))}return d.filter(r=>{let g=C==="ALL"||r.tipo===C;a?.isDashboardClick&&(a.type==="saida"&&a.status==="pendente"&&a.period==="future"&&C==="SAIDA"?g=g&&r.status==="PENDENTE":(a.type==="entrada"&&a.status==="pago"&&C==="ENTRADA"||a.type==="saida"&&a.status==="pago"&&C==="SAIDA")&&(g=g&&r.status==="PAGO"));let f=!0;if(j!=="all"){const D=r.status==="PAGO"&&r.data_recebimento?r.data_recebimento:r.data_vencimento||r.created_at;if(!D)return!1;const _=I(D),L=new Date;switch(j){case"today":const T=Le(L),z=ra(L);f=_>=T&&_<=z;break;case"week":const Ne=Pe(L,{locale:O}),ve=ta(L,{locale:O});f=_>=Ne&&_<=ve;break;case"month":const we=aa(L),ke=sa(L);f=_>=we&&_<=ke;break}}return g&&f}).sort((r,g)=>I(g.created_at).getTime()-I(r.created_at).getTime())},[n.transactions,C,j,a,l,o]),V=d=>{v(d),t(null),y(!0)},i=d=>{v(d.tipo),t(d),y(!0)},S=async d=>{try{await c(d),m({title:"Lançamento Removido",description:"O lançamento financeiro foi removido com sucesso."})}catch(r){m({title:"Erro ao remover",description:r.message,variant:"destructive"})}},B=()=>{y(!1),t(null)},se=d=>["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"].indexOf(d.toLowerCase()),be=p.useMemo(()=>{const d={};return n.transactions.forEach(r=>{const g=I(r.data_recebimento||r.created_at),f=q(g,"MMMM/yyyy",{locale:O});d[f]||(d[f]={revenue:0,expenses:0,transactions:0}),r.tipo==="ENTRADA"&&r.status==="PAGO"&&(d[f].revenue+=Number(r.valor)),r.tipo==="SAIDA"&&r.status==="PAGO"&&(d[f].expenses+=Number(r.valor)),d[f].transactions++}),Object.entries(d).map(([r,g])=>({monthYear:r,...g})).sort((r,g)=>{const[f,D]=r.monthYear.split("/"),[_,L]=g.monthYear.split("/");return new Date(L,se(_))-new Date(D,se(f))}).slice(0,3)},[n.transactions]),je=p.useMemo(()=>s.map(d=>{const r=n.transactions.filter(T=>T.trabalho_id===d.id&&T.tipo==="ENTRADA"),g=r.filter(T=>T.status==="PAGO").reduce((T,z)=>T+Number(z.valor),0);let f=r.filter(T=>T.status==="PENDENTE").reduce((T,z)=>T+Number(z.valor),0),D=Number(d.value)||0,_=0;D>g&&(_=D-g);const L=f>0?f:_;return{...d,pending_amount:L,client:d.client_id?u(d.client_id):null}}).filter(d=>d.pending_amount>0&&d.status!=="concluido"&&!d.archived),[s,n.transactions,u]);return{financialSummary:w,filteredTransactions:H,isModalOpen:x,transactionType:h,editingTransaction:k,filterType:C,setFilterType:b,filterPeriod:j,setFilterPeriod:A,handleAddTransaction:V,handleEditTransaction:i,handleDeleteTransaction:S,closeModal:B,pastMonthsSummaryData:be,showPaymentsToReceive:G,setShowPaymentsToReceive:N,pendingToReceiveWorkflowCards:je,searchTerm:l,setSearchTerm:R}},ha=({cards:a})=>{const{getClientById:n,getServicePackageById:c}=J();return!a||a.length===0?e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"p-6 bg-card rounded-xl shadow-lg border border-border text-center",children:[e.jsx(de,{size:48,className:"mx-auto text-primary mb-4"}),e.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:"Nenhum Pagamento a Receber"}),e.jsx("p",{className:"text-muted-foreground",children:"Não há trabalhos ou transações com valores pendentes no momento."})]}):e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-card rounded-xl shadow-lg border border-border",children:[e.jsxs("div",{className:"p-6 border-b border-border",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Pagamentos a Receber"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Trabalhos e transações com valores pendentes de clientes."})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-accent/50 dark:bg-accent/30",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Trabalho / Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Data Evento/Vencimento"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Pacote/Descrição"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Valor Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Valor Pendente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted-foreground uppercase tracking-wider",children:"Status Contrato/Lanç."})]})}),e.jsx("tbody",{className:"divide-y divide-border",children:a.map(s=>{const u=!!s.title,o=s.client_id?n(s.client_id):null,m=u&&s.service_package_id?c(s.service_package_id):null,x=u?s.title:s.descricao,y=u?s.date?q(I(s.date),"dd/MM/yyyy",{locale:O}):"N/A":s.data_vencimento?q(I(s.data_vencimento),"dd/MM/yyyy",{locale:O}):"N/A",h=u?m?m.name:"N/A":s.descricao,v=u?s.value||0:s.valor||0,k=u?s.pending_amount||0:s.valor||0,t=u?s.contract_status==="signed"?"Assinado":s.contract_status==="sent"?"Enviado":"Pendente":s.status,l=u?s.contract_status==="signed"?"bg-green-100 text-green-800 dark:bg-green-700 dark:text-green-100":s.contract_status==="sent"?"bg-blue-100 text-blue-800 dark:bg-blue-700 dark:text-blue-100":"bg-yellow-100 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-100":s.status==="PENDENTE"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-700 dark:text-yellow-100":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-100";return e.jsxs("tr",{className:"hover:bg-accent/50 dark:hover:bg-accent/30",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-foreground",children:x}),o&&e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center",children:[e.jsx(Ee,{size:12,className:"mr-1"}),o.name]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground",children:y}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-muted-foreground",children:h}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-foreground",children:["R$ ",Number(v).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-orange-600 dark:text-orange-400",children:["R$ ",Number(k).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("span",{className:`inline-flex px-2 py-0.5 text-xs font-semibold rounded-full capitalize ${l}`,children:t})})]},s.id)})})]})})]})},U={bank:[{name:"Nubank",url:"https://logodownload.org/wp-content/uploads/2019/08/nubank-logo-2.png"},{name:"Banco do Brasil",url:"https://logodownload.org/wp-content/uploads/2014/05/banco-do-brasil-logo-4.png"},{name:"Bradesco",url:"https://play-lh.googleusercontent.com/ZgYYL4k5QFHo1lCRUBFzdW5npSfx1EGUqvsB-NzsItCS1WGINGAPM0QK9Cca1q9xsOLh=w240-h480-rw"},{name:"Itaú",url:"https://logodownload.org/wp-content/uploads/2014/05/itau-logo-8.png"},{name:"Caixa Econômica",url:"https://www.caixa.gov.br/PublishingImages/Paginas/LT_T011/app_Caixa.png"}],gateway:[{name:"PicPay",url:"https://play-lh.googleusercontent.com/pTvc9kCumx_24eJDwGUpvcBwljcIBkrsL3qHwhBW2NalMQ-XxTtHRV9YAJanBxkV0Rw"},{name:"Mercado Pago",url:"https://play-lh.googleusercontent.com/6a7KGB_J06Lwct1F2kuwK_GbNm4E8Vkl0MJqzjcddpGjCIsTMOg2nJ3WW-dGCr883FI=w240-h480-rw"},{name:"PagSeguro",url:"https://assets.pagseguro.com.br/registration-fe/5.10.1/_next/static/media/pag-bank-banner.3e81dc45.png"},{name:"SumUp",url:"https://play-lh.googleusercontent.com/QmvpebjqnqTtUuTSDEt8zBmLf87-FpVU1uvuMP2zazqyYoEHZlZUB7QZ4j_klH3igQ"},{name:"Stone",url:"https://images.seeklogo.com/logo-png/36/1/stone-pagamentos-logo-png_seeklogo-364485.png"},{name:"PayPal",url:"https://play-lh.googleusercontent.com/iQ8f5plIFy9rrY46Q2TNRwq_8nCvh9LZVwytqMBpOEcfnIU3vTkICQ6L1-RInWS93oQg"},{name:"Stripe",url:"https://play-lh.googleusercontent.com/2PS6w7uBztfuMys5fgodNkTwTOE6bLVB2cJYbu5GHlARAK36FzO5bUfMDP9cEJk__cE"},{name:"Asaas",url:"https://cdn.asaas.com/asaas-logo.svg"},{name:"Gerencianet",url:"https://gerencianet.com.br/wp-content/themes/gerencianet/assets/img/logo-gerencianet.svg"},{name:"Pagar.me",url:"https://play-lh.googleusercontent.com/_zZlN3sJsEXGEicuECbyCcEuaV9gf2ZJtqz0r5UtBd59-G93hNNiKZEgBwqiBFgflH6T=w240-h480-rw"},{name:"Cielo",url:"https://play-lh.googleusercontent.com/BukKjSZwbGxLLSOkuzNztYXGV2KpEecAWO7TvFdC8-cVGWv_kzJ4I_J5lKwexQlEky4"},{name:"Rede",url:"https://cdn6.aptoide.com/imgs/7/1/8/7184445ac1374f5a1e87a50d56c2b6db_icon.png"},{name:"GetNet",url:"https://play-lh.googleusercontent.com/4tGSaBYJh7I_11w3T8laid5Y62e7jgJIyOeDiJkRPH9s6HJi6XRk_Rqz4vsu1gq_Qg"}],cash:[{name:"Dinheiro",url:"https://cdn-icons-png.flaticon.com/512/5451/5451648.png"}]},Y={"Mercado Pago":[{name:"Recebimento na hora",fee:4.99,release_days:0},{name:"Recebimento em 14 dias",fee:3.79,release_days:14},{name:"Recebimento em 30 dias",fee:3.03,release_days:30}],PagSeguro:[{name:"Recebimento na hora",fee:4.99,release_days:0},{name:"Recebimento em 14 dias",fee:3.89,release_days:14},{name:"Recebimento em 30 dias",fee:3.19,release_days:30}],PicPay:[{name:"Padrão",fee:3.99,release_days:30}],PayPal:[{name:"Padrão",fee:4.79,release_days:1}],SumUp:[{name:"Recebimento em 1 dia útil",fee:4.6,release_days:1},{name:"Recebimento em 30 dias",fee:3.6,release_days:30}],Stone:[{name:"Recebimento imediato",fee:5.49,release_days:0},{name:"Recebimento em 30 dias",fee:3.89,release_days:30}],Stripe:[{name:"Padrão",fee:4.9,release_days:7}],Asaas:[{name:"Recebimento parcelado",fee:4,release_days:30}],Gerencianet:[{name:"Padrão",fee:3.89,release_days:2}],"Pagar.me":[{name:"Padrão",fee:3.79,release_days:30}],Cielo:[{name:"Padrão",fee:3.29,release_days:30}],Rede:[{name:"Padrão",fee:3.09,release_days:30}],GetNet:[{name:"Padrão",fee:3.19,release_days:30}]},ga=({isOpen:a,onClose:n,walletData:c})=>{const{addWallet:s,updateWallet:u}=J(),{toast:o}=F(),[m,x]=p.useState(""),[y,h]=p.useState("bank"),[v,k]=p.useState(""),[t,l]=p.useState(""),[R,C]=p.useState(!1),[b,j]=p.useState({fee:"",release_days:""}),[A,G]=p.useState(!1),[N,w]=p.useState("custom");p.useEffect(()=>{c?(x(c.name),h(c.type),k(c.icon_url),l(c.initial_balance||""),C(c.is_gateway||!1),j(c.gateway_config||{fee:"",release_days:""})):(x(""),h("bank"),k(U.bank[0]?.url||""),l(""),C(!1),j({fee:"",release_days:""})),w("custom")},[c,a]),p.useEffect(()=>{if(a&&!c){const i=U[y]?.[0]?.url||"";k(i)}},[y,a,c]),p.useEffect(()=>{if(N&&N!=="custom"){const[i,S]=N.split("_"),B=Y[i]?.[S];B&&j({fee:B.fee,release_days:B.release_days})}},[N]);const H=async i=>{i.preventDefault(),G(!0);const S={name:m,type:y,icon_url:v,initial_balance:parseFloat(t)||0,is_gateway:R,gateway_config:R?{fee:parseFloat(b.fee)||0,release_days:parseInt(b.release_days,10)||0}:null};try{c?(await u(c.id,S),o({title:"Carteira atualizada!",description:"As informações da carteira foram salvas."})):(await s(S),o({title:"Carteira criada!",description:"Sua nova carteira está pronta para uso."})),n()}catch(B){o({title:"Erro ao salvar",description:B.message,variant:"destructive"})}finally{G(!1)}},V=Y[Object.keys(Y).find(i=>m.toLowerCase().includes(i.toLowerCase()))]||[];return e.jsx(Re,{open:a,onOpenChange:n,children:e.jsxs(Me,{className:"max-h-[90vh] overflow-y-auto",children:[e.jsxs(Be,{children:[e.jsx(Ie,{children:c?"Editar Carteira":"Nova Carteira"}),e.jsx(Oe,{children:c?"Atualize as informações da sua carteira.":"Crie uma nova carteira para organizar suas finanças."})]}),e.jsxs("form",{onSubmit:H,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(M,{htmlFor:"wallet-name",children:"Nome da Carteira"}),e.jsx(W,{id:"wallet-name",value:m,onChange:i=>x(i.target.value),placeholder:"Ex: Conta Principal",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"wallet-type",children:"Tipo"}),e.jsxs(Q,{value:y,onValueChange:h,children:[e.jsx(Z,{children:e.jsx(K,{placeholder:"Selecione o tipo"})}),e.jsxs(X,{children:[e.jsx($,{value:"bank",children:"Banco"}),e.jsx($,{value:"gateway",children:"Gateway de Pagamento"}),e.jsx($,{value:"cash",children:"Dinheiro (Caixa Físico)"})]})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"wallet-icon",children:"Ícone"}),e.jsxs(Q,{value:v,onValueChange:k,children:[e.jsx(Z,{children:e.jsx(K,{children:v?e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:v,alt:"ícone selecionado",className:"w-5 h-5 mr-2 object-contain"}),e.jsx("span",{children:U[y]?.find(i=>i.url===v)?.name||"Ícone"})]}):"Selecione um ícone"})}),e.jsx(X,{children:U[y]?.map(i=>e.jsx($,{value:i.url,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:i.url,alt:i.name,className:"w-5 h-5 mr-2 object-contain"}),e.jsx("span",{children:i.name})]})},i.name))})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"initial-balance",children:"Saldo Inicial (Opcional)"}),e.jsx(W,{id:"initial-balance",type:"number",step:"0.01",value:t,onChange:i=>l(i.target.value),placeholder:"0.00"})]}),e.jsxs("div",{className:"flex items-center space-x-2 pt-2",children:[e.jsx(Ge,{id:"is-gateway",checked:R,onCheckedChange:C}),e.jsx(M,{htmlFor:"is-gateway",className:"font-medium",children:"É um Gateway de Pagamento?"})]}),R&&e.jsxs("div",{className:"p-4 border rounded-lg space-y-4 bg-accent/50",children:[e.jsx("h4",{className:"font-semibold text-foreground",children:"Configuração do Gateway"}),V.length>0&&e.jsxs("div",{children:[e.jsxs(M,{htmlFor:"gateway-suggestion",children:["Sugestões para ",Object.keys(Y).find(i=>m.toLowerCase().includes(i.toLowerCase()))]}),e.jsxs(Q,{value:N,onValueChange:w,children:[e.jsx(Z,{children:e.jsx(K,{placeholder:"Usar sugestão..."})}),e.jsxs(X,{children:[e.jsx($,{value:"custom",children:"Personalizado"}),V.map((i,S)=>e.jsxs($,{value:`${m}_${S}`,children:[i.name," (",i.fee,"% em ",i.release_days,"d)"]},`${m}_${S}`))]})]})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"gateway-fee",children:"Taxa (%)"}),e.jsx(W,{id:"gateway-fee",type:"number",step:"0.01",value:b.fee,onChange:i=>j(S=>({...S,fee:i.target.value})),placeholder:"Ex: 4.99",required:!0})]}),e.jsxs("div",{children:[e.jsx(M,{htmlFor:"gateway-release",children:"Prazo de Liberação (dias)"}),e.jsx(W,{id:"gateway-release",type:"number",step:"1",value:b.release_days,onChange:i=>j(S=>({...S,release_days:i.target.value})),placeholder:"Ex: 14",required:!0})]}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-start",children:[e.jsx(de,{className:"w-4 h-4 mr-2 mt-0.5 shrink-0"}),e.jsx("span",{children:"Ao usar esta carteira em um lançamento, a taxa será descontada e o valor líquido agendado para a data de liberação."})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[e.jsx(P,{type:"button",variant:"ghost",onClick:n,disabled:A,children:"Cancelar"}),e.jsx(P,{type:"submit",disabled:A,children:A?"Salvando...":"Salvar"})]})]})]})})},fa=()=>{const{wallets:a,getWalletBalance:n,deleteWallet:c}=J(),[s,u]=p.useState(!1),[o,m]=p.useState(null),[x,y]=p.useState(null),{toast:h}=F(),v=()=>{m(null),u(!0)},k=l=>{m(l),u(!0)},t=async()=>{if(x)try{await c(x.id),h({title:"Carteira removida!",description:`A carteira "${x.name}" foi removida com sucesso.`})}catch(l){h({title:"Erro ao remover",description:l.message,variant:"destructive"})}finally{y(null)}};return e.jsxs(e.Fragment,{children:[e.jsxs(E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-card rounded-xl p-6 shadow-lg border border-border",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Minhas Carteiras"}),e.jsxs(P,{onClick:v,children:[e.jsx(na,{className:"w-4 h-4 mr-2"}),"Nova Carteira"]})]}),a.length===0?e.jsxs("div",{className:"text-center text-muted-foreground py-8",children:[e.jsx($e,{className:"w-12 h-12 mx-auto mb-4 text-primary"}),e.jsx("p",{children:"Nenhuma carteira encontrada."}),e.jsx("p",{className:"text-sm",children:"Crie sua primeira carteira para organizar suas finanças."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.jsx(ne,{children:a.map(l=>e.jsx(E.div,{layout:!0,initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:{type:"spring",stiffness:260,damping:20},children:e.jsxs(ze,{className:"h-full group relative",children:[e.jsxs(We,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsxs(qe,{className:"text-sm font-medium flex items-center",children:[l.icon_url?e.jsx("img",{src:l.icon_url,alt:l.name,className:"w-5 h-5 mr-2 object-contain"}):e.jsx(oa,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"truncate",title:l.name,children:l.name})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx(P,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:()=>k(l),children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx(P,{variant:"ghost",size:"icon",className:"h-7 w-7 text-destructive",onClick:()=>y(l),children:e.jsx(ce,{className:"w-4 h-4"})})]})]}),e.jsxs(Ve,{children:[e.jsx("div",{className:"text-2xl font-bold",children:Ue(n(l.id))}),e.jsx("p",{className:"text-xs text-muted-foreground capitalize",children:l.type})]})]})},l.id))})})]}),e.jsx(ne,{children:s&&e.jsx(ga,{isOpen:s,onClose:()=>u(!1),walletData:o})}),e.jsx(ie,{open:!!x,onOpenChange:l=>!l&&y(null),children:e.jsxs(me,{children:[e.jsxs(ue,{children:[e.jsx(xe,{children:"Confirmar Exclusão"}),e.jsxs(pe,{children:['Tem certeza que deseja excluir a carteira "',x?.name,'"? Os lançamentos associados a ela não serão excluídos, mas perderão o vínculo.']})]}),e.jsxs(he,{children:[e.jsx(ge,{onClick:()=>y(null),children:"Cancelar"}),e.jsx(fe,{onClick:t,className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]})})]})},Ba=({initialFilter:a,isMobile:n})=>{const{financialSummary:c,filteredTransactions:s,filterType:u,setFilterType:o,filterPeriod:m,setFilterPeriod:x,pastMonthsSummaryData:y,setShowPaymentsToReceive:h,pendingToReceiveWorkflowCards:v,handleDeleteTransaction:k,searchTerm:t,setSearchTerm:l}=pa(a),{openModal:R}=Ye(),{isMobile:C}=Je();p.useEffect(()=>{a&&a.isDashboardClick?a.type==="saida"&&a.status==="pendente"&&a.period==="future"?(j("pagar"),o("SAIDA"),x("all"),h(!1)):a.type==="entrada"&&a.status==="pendente"?(j("receber"),h(!0),o("ALL"),x("all")):a.type==="entrada"&&a.status==="pago"?(j("geral"),h(!1),o("ENTRADA"),x("all")):a.type==="saida"&&a.status==="pago"?(j("geral"),h(!1),o("SAIDA"),x("all")):(j("geral"),o(a.type?.toUpperCase()||"ALL"),x(a.period||"all"),h(!1)):(!a||Object.keys(a).length===0)&&(j("geral"),h(!1),o("ALL"),x("all"))},[a,o,x,h]);const[b,j]=p.useState("geral"),A=w=>{h(!1),R("financial",{type:w,transaction:null})},G=w=>{h(!1),R("financial",{type:w.tipo,transaction:w})},N=w=>{j(w),w==="geral"?(h(!1),o("ALL"),x("all")):w==="pagar"?(h(!1),o("SAIDA"),x("all")):w==="receber"&&(h(!0),o("ALL"),x("all"))};return e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[e.jsxs(E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:C?"hidden":"",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground titulo-gradiente",children:"Gestão Financeira"}),e.jsx("p",{className:"text-muted-foreground mt-1 text-sm sm:text-base",children:"Controle suas receitas, despesas e carteiras."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 w-full sm:w-auto",children:[e.jsxs(P,{onClick:()=>A("entrada"),variant:"success",className:"text-white shadow-lg w-full sm:w-auto",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Nova Entrada"}),e.jsx("span",{className:"sm:hidden",children:"Entrada"})]}),e.jsxs(P,{onClick:()=>A("saida"),className:"bg-red-500 hover:bg-red-600 text-white shadow-lg w-full sm:w-auto",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Nova Saída"}),e.jsx("span",{className:"sm:hidden",children:"Saída"})]})]})]}),e.jsx(ia,{summary:c}),e.jsx(fa,{}),e.jsx(xa,{data:y}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-2 mb-4",children:[e.jsxs(P,{variant:b==="geral"?"default":"outline",onClick:()=>N("geral"),className:`${b==="geral"?"bg-blue-600 hover:bg-blue-700 text-white":"border-border text-muted-foreground hover:bg-accent"} w-full sm:w-auto`,children:[e.jsx(ca,{className:"w-4 h-4 mr-2"})," Lançamentos Gerais"]}),e.jsxs(P,{variant:b==="pagar"?"default":"outline",onClick:()=>N("pagar"),className:`${b==="pagar"?"bg-red-500 hover:bg-red-600 text-white":"border-border text-muted-foreground hover:bg-accent"} w-full sm:w-auto`,children:[e.jsx(ae,{className:"w-4 h-4 mr-2"})," Contas a Pagar"]}),e.jsxs(P,{variant:b==="receber"?"default":"outline",onClick:()=>N("receber"),className:`${b==="receber"?"bg-green-500 hover:bg-green-600 text-white":"border-border text-muted-foreground hover:bg-accent"} w-full sm:w-auto`,children:[e.jsx(ee,{className:"w-4 h-4 mr-2"})," Contas a Receber"]})]}),b!=="receber"&&e.jsxs("div",{className:"bg-card rounded-xl p-4 sm:p-6 shadow-lg border border-border",children:[e.jsxs("div",{className:"flex-1 relative mb-4",children:[e.jsx(la,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground w-4 h-4"}),e.jsx(W,{type:"text",placeholder:"Buscar por descrição ou valor...",value:t,onChange:w=>l(w.target.value),className:"w-full pl-10 pr-4 py-2 rounded-lg bg-background focus:ring-primary focus:border-primary"})]}),e.jsx(ma,{filterType:u,setFilterType:o,filterPeriod:m,setFilterPeriod:x})]}),b==="receber"?e.jsx(ha,{cards:v}):e.jsx(ua,{transactions:s,onEdit:G,onDelete:k,isMobile:C})]})};export{Ba as default};
