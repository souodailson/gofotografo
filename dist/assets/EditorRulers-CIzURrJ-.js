import{c as L,r as j,j as e,af as fn,u as gn,a3 as ke,e as le,s as G,aD as Z,aa as A,by as mn,ae as xn,bz as vn,bA as yn,m as ge,B as N,a5 as Ae,R as H,ap as jn,T as oe,h as T,Z as B,_ as V,$ as q,a0 as W,a1 as S,I as R,a4 as Je,i as Rt,b8 as bn,b9 as Sn,bB as Cn,bf as ye,bb as Ie,bl as je,b7 as wn,bC as ir,bD as Nn,bE as Dn,a6 as Ee,ac as it,L as or,au as Mt,o as lr,at as ot,aY as En,aL as Tn,n as kn,S as In,aV as On}from"./index-4y5FCHHl.js";import{i as k,D as Pn,M as cr,A as zn,a as et,b as tt,c as rt,u as bt,d as Lt,I as dr,F as _n,T as Rn,L as Mn,Y as Ln,e as An}from"./EditorCanvas-CVQSpEpI.js";import{c as Fn,D as Hn,C as Un,P as $n}from"./dnd.esm-D5mNYyyr.js";import{u as Bn}from"./useDebounce-D3aNp6ni.js";import{E as Vn}from"./jspdf.es.min-xjVca6RD.js";import qn from"./html2canvas.esm-BfxBtG_O.js";import{T as lt,a as ct,b as pe,c as fe}from"./tabs-i0DuuDaY.js";import{A as ur,a as hr,b as pr,c as fr,d as gr,e as mr,f as xr,g as vr,h as yr}from"./alert-dialog-DhXlLYQ6.js";import{P as Me}from"./plus-circle-wCnyduKs.js";import{U as be}from"./upload-BTPPFeuV.js";import{S as Ce}from"./switch-Kb-SWC7G.js";import{I as Wn}from"./instagram-DB_gsddV.js";import{M as Gn}from"./message-square-BqWpQ5x6.js";import{I as Fe}from"./image-Dm_nKo32.js";import{L as Xn}from"./link-C5ISt8Y7.js";import{P as He,a as Ue,b as $e}from"./popover-CEtH80eq.js";import{B as jr}from"./ban-BnY-ZroQ.js";import{T as St,a as ne,b as se,c as ae}from"./tooltip-DRDfD7tc.js";import{C as dt}from"./chevron-up-ChCTpsoS.js";import{G as Yn}from"./grip-vertical-CjFKm1TS.js";import{E as br}from"./eye-BUw1QJOJ.js";import{E as Kn}from"./eye-off-C3-15f74.js";import{T as Sr}from"./type-BFgN7Djb.js";import{S as At}from"./settings-BYt_7WJj.js";import{C as Cr}from"./copy-li2Eb7oT.js";import{A as Qn}from"./arrow-left-DkmDkyq6.js";import{H as Zn,a as Jn,B as es,I as ts,U as rs,S as ns,A as ss,b as as,c as is,L as os}from"./underline-DptSXa-F.js";import{S as wr}from"./star-CqjimX2M.js";import{S as ls}from"./share-2-DquNa2Fo.js";import{S as cs}from"./square-CfK5DGkV.js";import{P as ds}from"./palette-BUE3btkq.js";import{A as us}from"./align-justify-Q5VMaNVk.js";import{L as hs}from"./list-tvBeoDTw.js";const ps=L("ArrowRightLeft",[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]]),fs=L("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),gs=L("Brush",[["path",{d:"m9.06 11.9 8.07-8.06a2.85 2.85 0 1 1 4.03 4.03l-8.06 8.08",key:"1styjt"}],["path",{d:"M7.07 14.94c-1.66 0-3 1.35-3 3.02 0 1.33-2.5 1.52-2 2.02 1.08 1.1 2.49 2.02 4 2.02 2.2 0 4-1.8 4-4.04a3.01 3.01 0 0 0-3-3.02z",key:"z0l1mu"}]]),Nr=L("ChevronsDown",[["path",{d:"m7 6 5 5 5-5",key:"1lc07p"}],["path",{d:"m7 13 5 5 5-5",key:"1d48rs"}]]),we=L("ChevronsUp",[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]]),ms=L("ClipboardPaste",[["path",{d:"M15 2H9a1 1 0 0 0-1 1v2c0 .6.4 1 1 1h6c.6 0 1-.4 1-1V3c0-.6-.4-1-1-1Z",key:"1pp7kr"}],["path",{d:"M8 4H6a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2M16 4h2a2 2 0 0 1 2 2v2M11 14h10",key:"2ik1ml"}],["path",{d:"m17 10 4 4-4 4",key:"vp2hj1"}]]),Ft=L("CopyPlus",[["line",{x1:"15",x2:"15",y1:"12",y2:"18",key:"1p7wdc"}],["line",{x1:"12",x2:"18",y1:"15",y2:"15",key:"1nscbv"}],["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),xs=L("Divide",[["circle",{cx:"12",cy:"6",r:"1",key:"1bh7o1"}],["line",{x1:"5",x2:"19",y1:"12",y2:"12",key:"13b5wn"}],["circle",{cx:"12",cy:"18",r:"1",key:"lqb9t5"}]]),vs=L("FileX2",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7.5L14.5 2H6a2 2 0 0 0-2 2v4",key:"702lig"}],["path",{d:"M14 2v6h6",key:"1kof46"}],["path",{d:"m3 12.5 5 5",key:"1qls4r"}],["path",{d:"m8 12.5-5 5",key:"b853mi"}]]),ys=L("FlipHorizontal",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v14c0 1.1.9 2 2 2h3",key:"1i73f7"}],["path",{d:"M16 3h3a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-3",key:"saxlbk"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 14v2",key:"8jcxud"}],["path",{d:"M12 8v2",key:"1woqiv"}],["path",{d:"M12 2v2",key:"tus03m"}]]),js=L("FlipVertical",[["path",{d:"M21 8V5a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v3",key:"14bfxa"}],["path",{d:"M21 16v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-3",key:"14rx03"}],["path",{d:"M4 12H2",key:"rhcxmi"}],["path",{d:"M10 12H8",key:"s88cx1"}],["path",{d:"M16 12h-2",key:"10asgb"}],["path",{d:"M22 12h-2",key:"14jgyd"}]]),bs=L("HelpCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Ss=L("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Cs=L("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),Ht=L("MousePointerClick",[["path",{d:"m9 9 5 12 1.8-5.2L21 14Z",key:"1b76lo"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}]]),Dr=L("Move",[["polyline",{points:"5 9 2 12 5 15",key:"1r5uj5"}],["polyline",{points:"9 5 12 2 15 5",key:"5v383o"}],["polyline",{points:"15 19 12 22 9 19",key:"g7qi8m"}],["polyline",{points:"19 9 22 12 19 15",key:"tpp73q"}],["line",{x1:"2",x2:"22",y1:"12",y2:"12",key:"1dnqot"}],["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}]]),ws=L("PanelLeftClose",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]]),Mo=L("PanelLeftOpen",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]]),Lo=L("PanelRightOpen",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["line",{x1:"15",x2:"15",y1:"3",y2:"21",key:"1hpv9i"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]]),Er=L("Pilcrow",[["path",{d:"M13 4v16",key:"8vvj80"}],["path",{d:"M17 4v16",key:"7dpous"}],["path",{d:"M19 4H9.5a4.5 4.5 0 0 0 0 9H13",key:"sh4n9v"}]]),Ns=L("Replace",[["path",{d:"M14 4c0-1.1.9-2 2-2",key:"1mvvbw"}],["path",{d:"M20 2c1.1 0 2 .9 2 2",key:"1mj6oe"}],["path",{d:"M22 8c0 1.1-.9 2-2 2",key:"v1wql3"}],["path",{d:"M16 10c-1.1 0-2-.9-2-2",key:"821ux0"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5c0-1.7 1.3-3 3-3h1",key:"13af7h"}],["rect",{width:"8",height:"8",x:"2",y:"14",rx:"2",key:"17ihk4"}]]),Ds=L("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]),Es=L("Tablet",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["line",{x1:"12",x2:"12.01",y1:"18",y2:"18",key:"1dp563"}]]),Ts=L("Text",[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]]),Tr=L("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),ks=L("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]);function Is(t,r,n){return r.split(".").reduce((a,s)=>a&&a[s]?a[s]:n||null,t)}function Os(t,r){return t.filter(n=>n!==r)}function kr(t){return typeof t=="object"}function Ps(t,r){const n=new Map,a=i=>{n.set(i,n.has(i)?n.get(i)+1:1)};t.forEach(a),r.forEach(a);const s=[];return n.forEach((i,o)=>{i===1&&s.push(o)}),s}function zs(t,r){return t.filter(n=>r.indexOf(n)>-1)}const Ct="dnd-core/INIT_COORDS",Be="dnd-core/BEGIN_DRAG",wt="dnd-core/PUBLISH_DRAG_SOURCE",Ve="dnd-core/HOVER",qe="dnd-core/DROP",We="dnd-core/END_DRAG";function Ut(t,r){return{type:Ct,payload:{sourceClientOffset:r||null,clientOffset:t||null}}}const _s={type:Ct,payload:{clientOffset:null,sourceClientOffset:null}};function Rs(t){return function(n=[],a={publishSource:!0}){const{publishSource:s=!0,clientOffset:i,getSourceClientOffset:o}=a,l=t.getMonitor(),g=t.getRegistry();t.dispatch(Ut(i)),Ms(n,l,g);const c=Fs(n,l);if(c==null){t.dispatch(_s);return}let h=null;if(i){if(!o)throw new Error("getSourceClientOffset must be defined");Ls(o),h=o(c)}t.dispatch(Ut(i,h));const f=g.getSource(c).beginDrag(l,c);if(f==null)return;As(f),g.pinSource(c);const p=g.getSourceType(c);return{type:Be,payload:{itemType:p,item:f,sourceId:c,clientOffset:i||null,sourceClientOffset:h||null,isSourcePublic:!!s}}}}function Ms(t,r,n){k(!r.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(a){k(n.getSource(a),"Expected sourceIds to be registered.")})}function Ls(t){k(typeof t=="function","When clientOffset is provided, getSourceClientOffset must be a function.")}function As(t){k(kr(t),"Item must be an object.")}function Fs(t,r){let n=null;for(let a=t.length-1;a>=0;a--)if(r.canDragSource(t[a])){n=t[a];break}return n}function Hs(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Us(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),a.forEach(function(s){Hs(t,s,n[s])})}return t}function $s(t){return function(n={}){const a=t.getMonitor(),s=t.getRegistry();Bs(a),Ws(a).forEach((o,l)=>{const g=Vs(o,l,s,a),c={type:qe,payload:{dropResult:Us({},n,g)}};t.dispatch(c)})}}function Bs(t){k(t.isDragging(),"Cannot call drop while not dragging."),k(!t.didDrop(),"Cannot call drop twice during one drag operation.")}function Vs(t,r,n,a){const s=n.getTarget(t);let i=s?s.drop(a,t):void 0;return qs(i),typeof i>"u"&&(i=r===0?{}:a.getDropResult()),i}function qs(t){k(typeof t>"u"||kr(t),"Drop result must either be an object or undefined.")}function Ws(t){const r=t.getTargetIds().filter(t.canDropOnTarget,t);return r.reverse(),r}function Gs(t){return function(){const n=t.getMonitor(),a=t.getRegistry();Xs(n);const s=n.getSourceId();return s!=null&&(a.getSource(s,!0).endDrag(n,s),a.unpinSource()),{type:We}}}function Xs(t){k(t.isDragging(),"Cannot call endDrag while not dragging.")}function ut(t,r){return r===null?t===null:Array.isArray(t)?t.some(n=>n===r):t===r}function Ys(t){return function(n,{clientOffset:a}={}){Ks(n);const s=n.slice(0),i=t.getMonitor(),o=t.getRegistry(),l=i.getItemType();return Zs(s,o,l),Qs(s,i,o),Js(s,i,o),{type:Ve,payload:{targetIds:s,clientOffset:a||null}}}}function Ks(t){k(Array.isArray(t),"Expected targetIds to be an array.")}function Qs(t,r,n){k(r.isDragging(),"Cannot call hover while not dragging."),k(!r.didDrop(),"Cannot call hover after drop.");for(let a=0;a<t.length;a++){const s=t[a];k(t.lastIndexOf(s)===a,"Expected targetIds to be unique in the passed array.");const i=n.getTarget(s);k(i,"Expected targetIds to be registered.")}}function Zs(t,r,n){for(let a=t.length-1;a>=0;a--){const s=t[a],i=r.getTargetType(s);ut(i,n)||t.splice(a,1)}}function Js(t,r,n){t.forEach(function(a){n.getTarget(a).hover(r,a)})}function ea(t){return function(){if(t.getMonitor().isDragging())return{type:wt}}}function ta(t){return{beginDrag:Rs(t),publishDragSource:ea(t),hover:Ys(t),drop:$s(t),endDrag:Gs(t)}}class ra{receiveBackend(r){this.backend=r}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const r=this,{dispatch:n}=this.store;function a(i){return(...o)=>{const l=i.apply(r,o);typeof l<"u"&&n(l)}}const s=ta(this);return Object.keys(s).reduce((i,o)=>{const l=s[o];return i[o]=a(l),i},{})}dispatch(r){this.store.dispatch(r)}constructor(r,n){this.isSetUp=!1,this.handleRefCountChange=()=>{const a=this.store.getState().refCount>0;this.backend&&(a&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!a&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=r,this.monitor=n,r.subscribe(this.handleRefCountChange)}}function na(t,r){return{x:t.x+r.x,y:t.y+r.y}}function Ir(t,r){return{x:t.x-r.x,y:t.y-r.y}}function sa(t){const{clientOffset:r,initialClientOffset:n,initialSourceClientOffset:a}=t;return!r||!n||!a?null:Ir(na(r,a),n)}function aa(t){const{clientOffset:r,initialClientOffset:n}=t;return!r||!n?null:Ir(r,n)}const Ne=[],Nt=[];Ne.__IS_NONE__=!0;Nt.__IS_ALL__=!0;function ia(t,r){return t===Ne?!1:t===Nt||typeof r>"u"?!0:zs(r,t).length>0}class oa{subscribeToStateChange(r,n={}){const{handlerIds:a}=n;k(typeof r=="function","listener must be a function."),k(typeof a>"u"||Array.isArray(a),"handlerIds, when specified, must be an array of strings.");let s=this.store.getState().stateId;const i=()=>{const o=this.store.getState(),l=o.stateId;try{l===s||l===s+1&&!ia(o.dirtyHandlerIds,a)||r()}finally{s=l}};return this.store.subscribe(i)}subscribeToOffsetChange(r){k(typeof r=="function","listener must be a function.");let n=this.store.getState().dragOffset;const a=()=>{const s=this.store.getState().dragOffset;s!==n&&(n=s,r())};return this.store.subscribe(a)}canDragSource(r){if(!r)return!1;const n=this.registry.getSource(r);return k(n,`Expected to find a valid source. sourceId=${r}`),this.isDragging()?!1:n.canDrag(this,r)}canDropOnTarget(r){if(!r)return!1;const n=this.registry.getTarget(r);if(k(n,`Expected to find a valid target. targetId=${r}`),!this.isDragging()||this.didDrop())return!1;const a=this.registry.getTargetType(r),s=this.getItemType();return ut(a,s)&&n.canDrop(this,r)}isDragging(){return!!this.getItemType()}isDraggingSource(r){if(!r)return!1;const n=this.registry.getSource(r,!0);if(k(n,`Expected to find a valid source. sourceId=${r}`),!this.isDragging()||!this.isSourcePublic())return!1;const a=this.registry.getSourceType(r),s=this.getItemType();return a!==s?!1:n.isDragging(this,r)}isOverTarget(r,n={shallow:!1}){if(!r)return!1;const{shallow:a}=n;if(!this.isDragging())return!1;const s=this.registry.getTargetType(r),i=this.getItemType();if(i&&!ut(s,i))return!1;const o=this.getTargetIds();if(!o.length)return!1;const l=o.indexOf(r);return a?l===o.length-1:l>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return!!this.store.getState().dragOperation.isSourcePublic}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return sa(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return aa(this.store.getState().dragOffset)}constructor(r,n){this.store=r,this.registry=n}}const $t=typeof global<"u"?global:self,Or=$t.MutationObserver||$t.WebKitMutationObserver;function Pr(t){return function(){const n=setTimeout(s,0),a=setInterval(s,50);function s(){clearTimeout(n),clearInterval(a),t()}}}function la(t){let r=1;const n=new Or(t),a=document.createTextNode("");return n.observe(a,{characterData:!0}),function(){r=-r,a.data=r}}const ca=typeof Or=="function"?la:Pr;class da{enqueueTask(r){const{queue:n,requestFlush:a}=this;n.length||(a(),this.flushing=!0),n[n.length]=r}constructor(){this.queue=[],this.pendingErrors=[],this.flushing=!1,this.index=0,this.capacity=1024,this.flush=()=>{const{queue:r}=this;for(;this.index<r.length;){const n=this.index;if(this.index++,r[n].call(),this.index>this.capacity){for(let a=0,s=r.length-this.index;a<s;a++)r[a]=r[a+this.index];r.length-=this.index,this.index=0}}r.length=0,this.index=0,this.flushing=!1},this.registerPendingError=r=>{this.pendingErrors.push(r),this.requestErrorThrow()},this.requestFlush=ca(this.flush),this.requestErrorThrow=Pr(()=>{if(this.pendingErrors.length)throw this.pendingErrors.shift()})}}class ua{call(){try{this.task&&this.task()}catch(r){this.onError(r)}finally{this.task=null,this.release(this)}}constructor(r,n){this.onError=r,this.release=n,this.task=null}}class ha{create(r){const n=this.freeTasks,a=n.length?n.pop():new ua(this.onError,s=>n[n.length]=s);return a.task=r,a}constructor(r){this.onError=r,this.freeTasks=[]}}const zr=new da,pa=new ha(zr.registerPendingError);function fa(t){zr.enqueueTask(pa.create(t))}const Dt="dnd-core/ADD_SOURCE",Et="dnd-core/ADD_TARGET",Tt="dnd-core/REMOVE_SOURCE",Ge="dnd-core/REMOVE_TARGET";function ga(t){return{type:Dt,payload:{sourceId:t}}}function ma(t){return{type:Et,payload:{targetId:t}}}function xa(t){return{type:Tt,payload:{sourceId:t}}}function va(t){return{type:Ge,payload:{targetId:t}}}function ya(t){k(typeof t.canDrag=="function","Expected canDrag to be a function."),k(typeof t.beginDrag=="function","Expected beginDrag to be a function."),k(typeof t.endDrag=="function","Expected endDrag to be a function.")}function ja(t){k(typeof t.canDrop=="function","Expected canDrop to be a function."),k(typeof t.hover=="function","Expected hover to be a function."),k(typeof t.drop=="function","Expected beginDrag to be a function.")}function ht(t,r){if(r&&Array.isArray(t)){t.forEach(n=>ht(n,!1));return}k(typeof t=="string"||typeof t=="symbol",r?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var re;(function(t){t.SOURCE="SOURCE",t.TARGET="TARGET"})(re||(re={}));let ba=0;function Sa(){return ba++}function Ca(t){const r=Sa().toString();switch(t){case re.SOURCE:return`S${r}`;case re.TARGET:return`T${r}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function Bt(t){switch(t[0]){case"S":return re.SOURCE;case"T":return re.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function Vt(t,r){const n=t.entries();let a=!1;do{const{done:s,value:[,i]}=n.next();if(i===r)return!0;a=!!s}while(!a);return!1}class wa{addSource(r,n){ht(r),ya(n);const a=this.addHandler(re.SOURCE,r,n);return this.store.dispatch(ga(a)),a}addTarget(r,n){ht(r,!0),ja(n);const a=this.addHandler(re.TARGET,r,n);return this.store.dispatch(ma(a)),a}containsHandler(r){return Vt(this.dragSources,r)||Vt(this.dropTargets,r)}getSource(r,n=!1){return k(this.isSourceId(r),"Expected a valid source ID."),n&&r===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(r)}getTarget(r){return k(this.isTargetId(r),"Expected a valid target ID."),this.dropTargets.get(r)}getSourceType(r){return k(this.isSourceId(r),"Expected a valid source ID."),this.types.get(r)}getTargetType(r){return k(this.isTargetId(r),"Expected a valid target ID."),this.types.get(r)}isSourceId(r){return Bt(r)===re.SOURCE}isTargetId(r){return Bt(r)===re.TARGET}removeSource(r){k(this.getSource(r),"Expected an existing source."),this.store.dispatch(xa(r)),fa(()=>{this.dragSources.delete(r),this.types.delete(r)})}removeTarget(r){k(this.getTarget(r),"Expected an existing target."),this.store.dispatch(va(r)),this.dropTargets.delete(r),this.types.delete(r)}pinSource(r){const n=this.getSource(r);k(n,"Expected an existing source."),this.pinnedSourceId=r,this.pinnedSource=n}unpinSource(){k(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(r,n,a){const s=Ca(r);return this.types.set(s,n),r===re.SOURCE?this.dragSources.set(s,a):r===re.TARGET&&this.dropTargets.set(s,a),s}constructor(r){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=r}}const Na=(t,r)=>t===r;function Da(t,r){return!t&&!r?!0:!t||!r?!1:t.x===r.x&&t.y===r.y}function Ea(t,r,n=Na){if(t.length!==r.length)return!1;for(let a=0;a<t.length;++a)if(!n(t[a],r[a]))return!1;return!0}function Ta(t=Ne,r){switch(r.type){case Ve:break;case Dt:case Et:case Ge:case Tt:return Ne;case Be:case wt:case We:case qe:default:return Nt}const{targetIds:n=[],prevTargetIds:a=[]}=r.payload,s=Ps(n,a);if(!(s.length>0||!Ea(n,a)))return Ne;const o=a[a.length-1],l=n[n.length-1];return o!==l&&(o&&s.push(o),l&&s.push(l)),s}function ka(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Ia(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),a.forEach(function(s){ka(t,s,n[s])})}return t}const qt={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function Oa(t=qt,r){const{payload:n}=r;switch(r.type){case Ct:case Be:return{initialSourceClientOffset:n.sourceClientOffset,initialClientOffset:n.clientOffset,clientOffset:n.clientOffset};case Ve:return Da(t.clientOffset,n.clientOffset)?t:Ia({},t,{clientOffset:n.clientOffset});case We:case qe:return qt;default:return t}}function Pa(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function xe(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),a.forEach(function(s){Pa(t,s,n[s])})}return t}const za={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function _a(t=za,r){const{payload:n}=r;switch(r.type){case Be:return xe({},t,{itemType:n.itemType,item:n.item,sourceId:n.sourceId,isSourcePublic:n.isSourcePublic,dropResult:null,didDrop:!1});case wt:return xe({},t,{isSourcePublic:!0});case Ve:return xe({},t,{targetIds:n.targetIds});case Ge:return t.targetIds.indexOf(n.targetId)===-1?t:xe({},t,{targetIds:Os(t.targetIds,n.targetId)});case qe:return xe({},t,{dropResult:n.dropResult,didDrop:!0,targetIds:[]});case We:return xe({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}}function Ra(t=0,r){switch(r.type){case Dt:case Et:return t+1;case Tt:case Ge:return t-1;default:return t}}function Ma(t=0){return t+1}function La(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Aa(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),a.forEach(function(s){La(t,s,n[s])})}return t}function Fa(t={},r){return{dirtyHandlerIds:Ta(t.dirtyHandlerIds,{type:r.type,payload:Aa({},r.payload,{prevTargetIds:Is(t,"dragOperation.targetIds",[])})}),dragOffset:Oa(t.dragOffset,r),refCount:Ra(t.refCount,r),dragOperation:_a(t.dragOperation,r),stateId:Ma(t.stateId)}}function Ha(t,r=void 0,n={},a=!1){const s=Ua(a),i=new oa(s,new wa(s)),o=new ra(s,i),l=t(o,r,n);return o.receiveBackend(l),o}function Ua(t){const r=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION__;return Fn(Fa,t&&r&&r({name:"dnd-core",instanceId:"dnd-core"}))}function $a(t,r){if(t==null)return{};var n=Ba(t,r),a,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)a=i[s],!(r.indexOf(a)>=0)&&Object.prototype.propertyIsEnumerable.call(t,a)&&(n[a]=t[a])}return n}function Ba(t,r){if(t==null)return{};var n={},a=Object.keys(t),s,i;for(i=0;i<a.length;i++)s=a[i],!(r.indexOf(s)>=0)&&(n[s]=t[s]);return n}let Wt=0;const Le=Symbol.for("__REACT_DND_CONTEXT_INSTANCE__");var Ao=j.memo(function(r){var{children:n}=r,a=$a(r,["children"]);const[s,i]=Va(a);return j.useEffect(()=>{if(i){const o=_r();return++Wt,()=>{--Wt===0&&(o[Le]=null)}}},[]),e.jsx(Pn.Provider,{value:s,children:n})});function Va(t){if("manager"in t)return[{dragDropManager:t.manager},!1];const r=qa(t.backend,t.context,t.options,t.debugMode),n=!t.context;return[r,n]}function qa(t,r=_r(),n,a){const s=r;return s[Le]||(s[Le]={dragDropManager:Ha(t,r,n,a)}),s[Le]}function _r(){return typeof global<"u"?global:window}function Rr(t){let r=null;return()=>(r==null&&(r=t()),r)}function Wa(t,r){return t.filter(n=>n!==r)}function Ga(t,r){const n=new Set,a=i=>n.add(i);t.forEach(a),r.forEach(a);const s=[];return n.forEach(i=>s.push(i)),s}class Xa{enter(r){const n=this.entered.length,a=s=>this.isNodeInDocument(s)&&(!s.contains||s.contains(r));return this.entered=Ga(this.entered.filter(a),[r]),n===0&&this.entered.length>0}leave(r){const n=this.entered.length;return this.entered=Wa(this.entered.filter(this.isNodeInDocument),r),n>0&&this.entered.length===0}reset(){this.entered=[]}constructor(r){this.entered=[],this.isNodeInDocument=r}}class Ya{initializeExposedProperties(){Object.keys(this.config.exposeProperties).forEach(r=>{Object.defineProperty(this.item,r,{configurable:!0,enumerable:!0,get(){return console.warn(`Browser doesn't allow reading "${r}" until the drop event.`),null}})})}loadDataTransfer(r){if(r){const n={};Object.keys(this.config.exposeProperties).forEach(a=>{const s=this.config.exposeProperties[a];s!=null&&(n[a]={value:s(r,this.config.matchesTypes),configurable:!0,enumerable:!0})}),Object.defineProperties(this.item,n)}}canDrag(){return!0}beginDrag(){return this.item}isDragging(r,n){return n===r.getSourceId()}endDrag(){}constructor(r){this.config=r,this.item={},this.initializeExposedProperties()}}const Mr="__NATIVE_FILE__",Lr="__NATIVE_URL__",Ar="__NATIVE_TEXT__",Fr="__NATIVE_HTML__",Gt=Object.freeze(Object.defineProperty({__proto__:null,FILE:Mr,HTML:Fr,TEXT:Ar,URL:Lr},Symbol.toStringTag,{value:"Module"}));function nt(t,r,n){const a=r.reduce((s,i)=>s||t.getData(i),"");return a??n}const pt={[Mr]:{exposeProperties:{files:t=>Array.prototype.slice.call(t.files),items:t=>t.items,dataTransfer:t=>t},matchesTypes:["Files"]},[Fr]:{exposeProperties:{html:(t,r)=>nt(t,r,""),dataTransfer:t=>t},matchesTypes:["Html","text/html"]},[Lr]:{exposeProperties:{urls:(t,r)=>nt(t,r,"").split(`
`),dataTransfer:t=>t},matchesTypes:["Url","text/uri-list"]},[Ar]:{exposeProperties:{text:(t,r)=>nt(t,r,""),dataTransfer:t=>t},matchesTypes:["Text","text/plain"]}};function Ka(t,r){const n=pt[t];if(!n)throw new Error(`native type ${t} has no configuration`);const a=new Ya(n);return a.loadDataTransfer(r),a}function st(t){if(!t)return null;const r=Array.prototype.slice.call(t.types||[]);return Object.keys(pt).filter(n=>{const a=pt[n];return a?.matchesTypes?a.matchesTypes.some(s=>r.indexOf(s)>-1):!1})[0]||null}const Qa=Rr(()=>/firefox/i.test(navigator.userAgent)),Hr=Rr(()=>!!window.safari);class Xt{interpolate(r){const{xs:n,ys:a,c1s:s,c2s:i,c3s:o}=this;let l=n.length-1;if(r===n[l])return a[l];let g=0,c=o.length-1,h;for(;g<=c;){h=Math.floor(.5*(g+c));const p=n[h];if(p<r)g=h+1;else if(p>r)c=h-1;else return a[h]}l=Math.max(0,c);const d=r-n[l],f=d*d;return a[l]+s[l]*d+i[l]*f+o[l]*d*f}constructor(r,n){const{length:a}=r,s=[];for(let p=0;p<a;p++)s.push(p);s.sort((p,m)=>r[p]<r[m]?-1:1);const i=[],o=[];let l,g;for(let p=0;p<a-1;p++)l=r[p+1]-r[p],g=n[p+1]-n[p],i.push(l),o.push(g/l);const c=[o[0]];for(let p=0;p<i.length-1;p++){const m=o[p],v=o[p+1];if(m*v<=0)c.push(0);else{l=i[p];const u=i[p+1],y=l+u;c.push(3*y/((y+u)/m+(y+l)/v))}}c.push(o[o.length-1]);const h=[],d=[];let f;for(let p=0;p<c.length-1;p++){f=o[p];const m=c[p],v=1/i[p],u=m+c[p+1]-f-f;h.push((f-m-u)*v),d.push(u*v*v)}this.xs=r,this.ys=n,this.c1s=c,this.c2s=h,this.c3s=d}}const Za=1;function Ur(t){const r=t.nodeType===Za?t:t.parentElement;if(!r)return null;const{top:n,left:a}=r.getBoundingClientRect();return{x:a,y:n}}function ze(t){return{x:t.clientX,y:t.clientY}}function Ja(t){var r;return t.nodeName==="IMG"&&(Qa()||!(!((r=document.documentElement)===null||r===void 0)&&r.contains(t)))}function ei(t,r,n,a){let s=t?r.width:n,i=t?r.height:a;return Hr()&&t&&(i/=window.devicePixelRatio,s/=window.devicePixelRatio),{dragPreviewWidth:s,dragPreviewHeight:i}}function ti(t,r,n,a,s){const i=Ja(r),l=Ur(i?t:r),g={x:n.x-l.x,y:n.y-l.y},{offsetWidth:c,offsetHeight:h}=t,{anchorX:d,anchorY:f}=a,{dragPreviewWidth:p,dragPreviewHeight:m}=ei(i,r,c,h),v=()=>{let b=new Xt([0,.5,1],[g.y,g.y/h*m,g.y+m-h]).interpolate(f);return Hr()&&i&&(b+=(window.devicePixelRatio-1)*m),b},u=()=>new Xt([0,.5,1],[g.x,g.x/c*p,g.x+p-c]).interpolate(d),{offsetX:y,offsetY:E}=s,w=y===0||y,C=E===0||E;return{x:w?y:u(),y:C?E:v()}}class ri{get window(){if(this.globalContext)return this.globalContext;if(typeof window<"u")return window}get document(){var r;return!((r=this.globalContext)===null||r===void 0)&&r.document?this.globalContext.document:this.window?this.window.document:void 0}get rootElement(){var r;return((r=this.optionsArgs)===null||r===void 0?void 0:r.rootElement)||this.window}constructor(r,n){this.ownerDocument=null,this.globalContext=r,this.optionsArgs=n}}function ni(t,r,n){return r in t?Object.defineProperty(t,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[r]=n,t}function Yt(t){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?arguments[r]:{},a=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable}))),a.forEach(function(s){ni(t,s,n[s])})}return t}class si{profile(){var r,n;return{sourcePreviewNodes:this.sourcePreviewNodes.size,sourcePreviewNodeOptions:this.sourcePreviewNodeOptions.size,sourceNodeOptions:this.sourceNodeOptions.size,sourceNodes:this.sourceNodes.size,dragStartSourceIds:((r=this.dragStartSourceIds)===null||r===void 0?void 0:r.length)||0,dropTargetIds:this.dropTargetIds.length,dragEnterTargetIds:this.dragEnterTargetIds.length,dragOverTargetIds:((n=this.dragOverTargetIds)===null||n===void 0?void 0:n.length)||0}}get window(){return this.options.window}get document(){return this.options.document}get rootElement(){return this.options.rootElement}setup(){const r=this.rootElement;if(r!==void 0){if(r.__isReactDndBackendSetUp)throw new Error("Cannot have two HTML5 backends at the same time.");r.__isReactDndBackendSetUp=!0,this.addEventListeners(r)}}teardown(){const r=this.rootElement;if(r!==void 0&&(r.__isReactDndBackendSetUp=!1,this.removeEventListeners(this.rootElement),this.clearCurrentDragSourceNode(),this.asyncEndDragFrameId)){var n;(n=this.window)===null||n===void 0||n.cancelAnimationFrame(this.asyncEndDragFrameId)}}connectDragPreview(r,n,a){return this.sourcePreviewNodeOptions.set(r,a),this.sourcePreviewNodes.set(r,n),()=>{this.sourcePreviewNodes.delete(r),this.sourcePreviewNodeOptions.delete(r)}}connectDragSource(r,n,a){this.sourceNodes.set(r,n),this.sourceNodeOptions.set(r,a);const s=o=>this.handleDragStart(o,r),i=o=>this.handleSelectStart(o);return n.setAttribute("draggable","true"),n.addEventListener("dragstart",s),n.addEventListener("selectstart",i),()=>{this.sourceNodes.delete(r),this.sourceNodeOptions.delete(r),n.removeEventListener("dragstart",s),n.removeEventListener("selectstart",i),n.setAttribute("draggable","false")}}connectDropTarget(r,n){const a=o=>this.handleDragEnter(o,r),s=o=>this.handleDragOver(o,r),i=o=>this.handleDrop(o,r);return n.addEventListener("dragenter",a),n.addEventListener("dragover",s),n.addEventListener("drop",i),()=>{n.removeEventListener("dragenter",a),n.removeEventListener("dragover",s),n.removeEventListener("drop",i)}}addEventListeners(r){r.addEventListener&&(r.addEventListener("dragstart",this.handleTopDragStart),r.addEventListener("dragstart",this.handleTopDragStartCapture,!0),r.addEventListener("dragend",this.handleTopDragEndCapture,!0),r.addEventListener("dragenter",this.handleTopDragEnter),r.addEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.addEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.addEventListener("dragover",this.handleTopDragOver),r.addEventListener("dragover",this.handleTopDragOverCapture,!0),r.addEventListener("drop",this.handleTopDrop),r.addEventListener("drop",this.handleTopDropCapture,!0))}removeEventListeners(r){r.removeEventListener&&(r.removeEventListener("dragstart",this.handleTopDragStart),r.removeEventListener("dragstart",this.handleTopDragStartCapture,!0),r.removeEventListener("dragend",this.handleTopDragEndCapture,!0),r.removeEventListener("dragenter",this.handleTopDragEnter),r.removeEventListener("dragenter",this.handleTopDragEnterCapture,!0),r.removeEventListener("dragleave",this.handleTopDragLeaveCapture,!0),r.removeEventListener("dragover",this.handleTopDragOver),r.removeEventListener("dragover",this.handleTopDragOverCapture,!0),r.removeEventListener("drop",this.handleTopDrop),r.removeEventListener("drop",this.handleTopDropCapture,!0))}getCurrentSourceNodeOptions(){const r=this.monitor.getSourceId(),n=this.sourceNodeOptions.get(r);return Yt({dropEffect:this.altKeyPressed?"copy":"move"},n||{})}getCurrentDropEffect(){return this.isDraggingNativeItem()?"copy":this.getCurrentSourceNodeOptions().dropEffect}getCurrentSourcePreviewNodeOptions(){const r=this.monitor.getSourceId(),n=this.sourcePreviewNodeOptions.get(r);return Yt({anchorX:.5,anchorY:.5,captureDraggingState:!1},n||{})}isDraggingNativeItem(){const r=this.monitor.getItemType();return Object.keys(Gt).some(n=>Gt[n]===r)}beginDragNativeItem(r,n){this.clearCurrentDragSourceNode(),this.currentNativeSource=Ka(r,n),this.currentNativeHandle=this.registry.addSource(r,this.currentNativeSource),this.actions.beginDrag([this.currentNativeHandle])}setCurrentDragSourceNode(r){this.clearCurrentDragSourceNode(),this.currentDragSourceNode=r;const n=1e3;this.mouseMoveTimeoutTimer=setTimeout(()=>{var a;return(a=this.rootElement)===null||a===void 0?void 0:a.addEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)},n)}clearCurrentDragSourceNode(){if(this.currentDragSourceNode){if(this.currentDragSourceNode=null,this.rootElement){var r;(r=this.window)===null||r===void 0||r.clearTimeout(this.mouseMoveTimeoutTimer||void 0),this.rootElement.removeEventListener("mousemove",this.endDragIfSourceWasRemovedFromDOM,!0)}return this.mouseMoveTimeoutTimer=null,!0}return!1}handleDragStart(r,n){r.defaultPrevented||(this.dragStartSourceIds||(this.dragStartSourceIds=[]),this.dragStartSourceIds.unshift(n))}handleDragEnter(r,n){this.dragEnterTargetIds.unshift(n)}handleDragOver(r,n){this.dragOverTargetIds===null&&(this.dragOverTargetIds=[]),this.dragOverTargetIds.unshift(n)}handleDrop(r,n){this.dropTargetIds.unshift(n)}constructor(r,n,a){this.sourcePreviewNodes=new Map,this.sourcePreviewNodeOptions=new Map,this.sourceNodes=new Map,this.sourceNodeOptions=new Map,this.dragStartSourceIds=null,this.dropTargetIds=[],this.dragEnterTargetIds=[],this.currentNativeSource=null,this.currentNativeHandle=null,this.currentDragSourceNode=null,this.altKeyPressed=!1,this.mouseMoveTimeoutTimer=null,this.asyncEndDragFrameId=null,this.dragOverTargetIds=null,this.lastClientOffset=null,this.hoverRafId=null,this.getSourceClientOffset=s=>{const i=this.sourceNodes.get(s);return i&&Ur(i)||null},this.endDragNativeItem=()=>{this.isDraggingNativeItem()&&(this.actions.endDrag(),this.currentNativeHandle&&this.registry.removeSource(this.currentNativeHandle),this.currentNativeHandle=null,this.currentNativeSource=null)},this.isNodeInDocument=s=>!!(s&&this.document&&this.document.body&&this.document.body.contains(s)),this.endDragIfSourceWasRemovedFromDOM=()=>{const s=this.currentDragSourceNode;s==null||this.isNodeInDocument(s)||(this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover())},this.scheduleHover=s=>{this.hoverRafId===null&&typeof requestAnimationFrame<"u"&&(this.hoverRafId=requestAnimationFrame(()=>{this.monitor.isDragging()&&this.actions.hover(s||[],{clientOffset:this.lastClientOffset}),this.hoverRafId=null}))},this.cancelHover=()=>{this.hoverRafId!==null&&typeof cancelAnimationFrame<"u"&&(cancelAnimationFrame(this.hoverRafId),this.hoverRafId=null)},this.handleTopDragStartCapture=()=>{this.clearCurrentDragSourceNode(),this.dragStartSourceIds=[]},this.handleTopDragStart=s=>{if(s.defaultPrevented)return;const{dragStartSourceIds:i}=this;this.dragStartSourceIds=null;const o=ze(s);this.monitor.isDragging()&&(this.actions.endDrag(),this.cancelHover()),this.actions.beginDrag(i||[],{publishSource:!1,getSourceClientOffset:this.getSourceClientOffset,clientOffset:o});const{dataTransfer:l}=s,g=st(l);if(this.monitor.isDragging()){if(l&&typeof l.setDragImage=="function"){const h=this.monitor.getSourceId(),d=this.sourceNodes.get(h),f=this.sourcePreviewNodes.get(h)||d;if(f){const{anchorX:p,anchorY:m,offsetX:v,offsetY:u}=this.getCurrentSourcePreviewNodeOptions(),w=ti(d,f,o,{anchorX:p,anchorY:m},{offsetX:v,offsetY:u});l.setDragImage(f,w.x,w.y)}}try{l?.setData("application/json",{})}catch{}this.setCurrentDragSourceNode(s.target);const{captureDraggingState:c}=this.getCurrentSourcePreviewNodeOptions();c?this.actions.publishDragSource():setTimeout(()=>this.actions.publishDragSource(),0)}else if(g)this.beginDragNativeItem(g);else{if(l&&!l.types&&(s.target&&!s.target.hasAttribute||!s.target.hasAttribute("draggable")))return;s.preventDefault()}},this.handleTopDragEndCapture=()=>{this.clearCurrentDragSourceNode()&&this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleTopDragEnterCapture=s=>{if(this.dragEnterTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(s.dataTransfer)}if(!this.enterLeaveCounter.enter(s.target)||this.monitor.isDragging())return;const{dataTransfer:l}=s,g=st(l);g&&this.beginDragNativeItem(g,l)},this.handleTopDragEnter=s=>{const{dragEnterTargetIds:i}=this;if(this.dragEnterTargetIds=[],!this.monitor.isDragging())return;this.altKeyPressed=s.altKey,i.length>0&&this.actions.hover(i,{clientOffset:ze(s)}),i.some(l=>this.monitor.canDropOnTarget(l))&&(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect()))},this.handleTopDragOverCapture=s=>{if(this.dragOverTargetIds=[],this.isDraggingNativeItem()){var i;(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(s.dataTransfer)}},this.handleTopDragOver=s=>{const{dragOverTargetIds:i}=this;if(this.dragOverTargetIds=[],!this.monitor.isDragging()){s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none");return}this.altKeyPressed=s.altKey,this.lastClientOffset=ze(s),this.scheduleHover(i),(i||[]).some(l=>this.monitor.canDropOnTarget(l))?(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect=this.getCurrentDropEffect())):this.isDraggingNativeItem()?s.preventDefault():(s.preventDefault(),s.dataTransfer&&(s.dataTransfer.dropEffect="none"))},this.handleTopDragLeaveCapture=s=>{this.isDraggingNativeItem()&&s.preventDefault(),this.enterLeaveCounter.leave(s.target)&&(this.isDraggingNativeItem()&&setTimeout(()=>this.endDragNativeItem(),0),this.cancelHover())},this.handleTopDropCapture=s=>{if(this.dropTargetIds=[],this.isDraggingNativeItem()){var i;s.preventDefault(),(i=this.currentNativeSource)===null||i===void 0||i.loadDataTransfer(s.dataTransfer)}else st(s.dataTransfer)&&s.preventDefault();this.enterLeaveCounter.reset()},this.handleTopDrop=s=>{const{dropTargetIds:i}=this;this.dropTargetIds=[],this.actions.hover(i,{clientOffset:ze(s)}),this.actions.drop({dropEffect:this.getCurrentDropEffect()}),this.isDraggingNativeItem()?this.endDragNativeItem():this.monitor.isDragging()&&this.actions.endDrag(),this.cancelHover()},this.handleSelectStart=s=>{const i=s.target;typeof i.dragDrop=="function"&&(i.tagName==="INPUT"||i.tagName==="SELECT"||i.tagName==="TEXTAREA"||i.isContentEditable||(s.preventDefault(),i.dragDrop()))},this.options=new ri(n,a),this.actions=r.getActions(),this.monitor=r.getMonitor(),this.registry=r.getRegistry(),this.enterLeaveCounter=new Xa(this.isNodeInDocument)}}const Fo=function(r,n,a){return new si(r,n,a)},ve={nome_da_proposta:"Nova Proposta",client_id:null,sections:[{id:A(),name:"Seção 1",height:842,styles:{}}],blocksBySection:{},layouts:{desktop:{},tablet:{},mobile:{}},theme:{backgroundColor:"#FFFFFF",textColor:"#333333",headingColor:"#111111",accentColor:"#3B82F6",fontFamily:{key:"playfair_lato",heading:"Playfair Display",body:"Lato",import:"Playfair+Display:wght@700&family=Lato:wght@400;700"}},is_published:!1,published_at:null},ai=async t=>{try{const a=await(await mn(t).promise).getPage(1),s=a.getViewport({scale:.5}),i=document.createElement("canvas"),o=i.getContext("2d");i.height=s.height,i.width=s.width;const l={canvasContext:o,viewport:s};return await a.render(l).promise,i.toDataURL("image/jpeg",.8)}catch(r){return console.error("Error generating PDF thumbnail:",r),null}},ii=t=>`${t.toLowerCase().normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}-${A().slice(0,6)}`,Ho=({isAdmin:t=!1})=>{const{proposalId:r}=fn(),n=gn(),{user:a}=ke(),{toast:s}=le(),[i,o]=j.useState(null),[l,g]=j.useState(r),[c,h]=j.useState(!r),[d,f]=j.useState(!0),[p,m]=j.useState(!1),[v,u]=j.useState("Salvo!"),[y,E]=j.useState(null),[w,C]=j.useState([]),[x,b]=j.useState(!1),D=j.useRef(null),I=t?"/control-acess/proposal-templates":"/studio",M=j.useCallback(async P=>{if(!(!a||!P)){b(!0);try{const{data:z,error:O}=await G.storage.from("propostas").list(`${a.id}/${P}`,{limit:100,offset:0,sortBy:{column:"created_at",order:"desc"}});if(O)throw O;const K=z.map(_=>G.storage.from("propostas").getPublicUrl(`${a.id}/${P}/${_.name}`).data.publicUrl);C(K)}catch(z){console.error("Error fetching uploads:",z),s({title:"Erro ao buscar imagens",description:z.message,variant:"destructive"})}finally{b(!1)}}},[a,s]);j.useEffect(()=>{(async()=>{if(f(!0),c){const z=Z.cloneDeep(ve);o(z),E(z.sections[0]?.id),D.current=Z.cloneDeep(z),f(!1)}else try{const z=t?"proposal_templates":"propostas",{data:O,error:K}=await G.from(z).select("*").eq("id",l).maybeSingle();if(K)throw K;if(!O){s({title:"Proposta não encontrada",variant:"destructive"}),n(I);return}let _={...ve,...O};O.dados_json?(_.sections=O.dados_json.sections||ve.sections,_.blocksBySection=O.dados_json.blocksBySection||{},_.theme=O.dados_json.theme||ve.theme):O.state&&(_.sections=O.state.sections||ve.sections,_.blocksBySection=O.state.blocksBySection||{},_.theme=O.state.theme||ve.theme,_.layouts=O.state.layouts||_.layouts),_.layouts=O.layouts||_.layouts,_.slug=O.slug||_.slug,o(_),E(_.sections[0]?.id),D.current=Z.cloneDeep(_),M(l)}catch(z){console.error("Error loading proposal:",z),s({title:"Erro ao carregar proposta",description:z.message,variant:"destructive"}),n(I)}finally{f(!1)}})()},[l,c,t]);const X=j.useCallback(async(P,z=!1)=>{if(!P||!a)return;if(Z.isEqual(P,D.current))return u("Salvo!"),z&&I&&n(I),P;m(!0),u("Salvando...");const{sections:O,blocksBySection:K,theme:_,layouts:ce,nome_da_proposta:me,client_id:ln,is_published:cn,published_at:dn}=P,un={sections:O,blocksBySection:K,theme:_};let Ke=P.thumbnail_url;const Oe=O?.[0],Pt=(K?.[Oe?.id]||[]).find(te=>te.type==="pdf"&&te.content?.src),zt=Oe?.styles?.backgroundImage?.startsWith("url(")?Oe.styles.backgroundImage.slice(5,-2):Oe?.styles?.backgroundImage;if(zt)Ke=zt;else if(Pt){const te=await ai(Pt.content.src);te&&(Ke=te)}const hn=P.slug||ii(me),Qe={nome_da_proposta:me,client_id:ln,user_id:a.id,updated_at:new Date().toISOString(),thumbnail_url:Ke,dados_json:un,layouts:ce,slug:hn,is_published:cn,published_at:dn};t&&(Qe.template_name=me);const _t=t?"proposal_templates":"propostas";let ee,Pe;if(c){const te={...Qe};delete te.id;const{data:Ze,error:pn}=await G.from(_t).insert(te).select().single();ee=Ze,Pe=pn}else{const{data:te,error:Ze}=await G.from(_t).update(Qe).eq("id",l).select().single();ee=te,Pe=Ze}if(m(!1),Pe)return u("Erro ao Salvar!"),s({title:"Erro ao salvar",description:Pe.message,variant:"destructive"}),null;u("Salvo!");let ie={...ee};if(ee.dados_json?ie={...ie,...ee.dados_json}:ee.state&&(ie={...ie,...ee.state}),ie.slug=ee.slug,ie.layouts=ee.layouts||ie.layouts,D.current=Z.cloneDeep(ie),c){h(!1),g(ee.id),o(ie);const te=t?`/studio/proposals/edit/${ee.id}?isAdmin=true`:`/studio/proposals/edit/${ee.id}`;n(te,{replace:!0})}else o(ie);return z&&I&&n(I),ie},[a,c,l,s,n,I,t]),U=j.useCallback(async()=>{if(t)return s({title:"Apenas propostas de usuários podem ser publicadas."}),null;m(!0),u("Publicando...");const P=await X(i);if(!P||!P.id)return m(!1),u("Erro ao Salvar!"),s({title:"Falha na Publicação",description:"Não foi possível salvar a proposta antes de publicar.",variant:"destructive"}),null;const{error:z}=await G.from("propostas").update({is_published:!0,published_at:new Date().toISOString()}).eq("id",P.id);if(m(!1),z)return u("Erro ao Publicar!"),s({title:"Erro ao publicar",description:z.message,variant:"destructive"}),null;u("Publicado!");const O={...i,is_published:!0,published_at:new Date().toISOString()};return o(O),D.current=Z.cloneDeep(O),`${window.location.origin}/p/${P.slug}`},[X,s,i,t]),J=Bn(i,5e3);return j.useEffect(()=>{J&&!c&&X(J)},[J,c,X]),j.useEffect(()=>{const P=z=>{Z.isEqual(i,D.current)||(z.preventDefault(),z.returnValue="")};return window.addEventListener("beforeunload",P),()=>window.removeEventListener("beforeunload",P)},[i]),{proposal:i,setProposal:o,proposalId:l,isNew:c,activeSection:y,setActiveSection:E,loading:d,saving:p,saveStatus:v,uploads:w,loadingUploads:x,handleSave:P=>X(i,P),handlePublish:U,fetchUploads:M,navigateBackPath:I}},Uo=t=>{const[r,n]=j.useState(null),[a,s]=j.useState("desktop"),[i,o]=j.useState(1024),[l,g]=j.useState(!0),[c,h]=j.useState(!0),[d,f]=j.useState(!1),[p,m]=j.useState({top:0,left:0}),[v,u]=j.useState([]);j.useEffect(()=>{r&&f(!0)},[r]),j.useEffect(()=>{a==="desktop"?o(1024):a==="tablet"?o(768):a==="mobile"&&o(375)},[a]);const y=j.useCallback(E=>{n(E),(E?.type==="text"||E?.type==="image")&&setTimeout(()=>{const w=document.querySelector(`[data-block-id="${E.id}"]`);if(w){const C=w.getBoundingClientRect();m({top:C.top-60,left:C.left+C.width/2})}},0)},[]);return{selectedBlock:r,setSelectedBlock:n,handleSetSelectedBlock:y,viewMode:a,setViewMode:s,canvasWidth:i,setCanvasWidth:o,showGrid:l,setShowGrid:g,isLeftSidebarOpen:c,setIsLeftSidebarOpen:h,isRightSidebarOpen:d,setIsRightSidebarOpen:f,toolbarPosition:p,setToolbarPosition:m,snapLines:v,setSnapLines:u}},$o=(t,r,n)=>{const{toast:a}=le(),s=j.useCallback((o,l,g)=>{const c=g||n;t(h=>{if(!h)return null;const d=Object.keys(h.blocksBySection).find(m=>h.blocksBySection[m].some(v=>v.id===o));if(!d)return h;if(l===null){r(null);const m=h.blocksBySection[d].filter(v=>v.id!==o);return{...h,blocksBySection:{...h.blocksBySection,[d]:m}}}const f=h.blocksBySection[d].map(m=>{if(m.id!==o)return m;if(c==="desktop")return Z.merge({},m,l);const v=Z.cloneDeep(m);return v.layouts||(v.layouts={}),v.layouts[c]||(v.layouts[c]={}),Z.merge(v.layouts[c],l),v}),p=f.find(m=>m.id===o);return p&&r(p),{...h,blocksBySection:{...h.blocksBySection,[d]:f}}})},[t,r,n]);return{addBlock:j.useCallback((o,l,g)=>{if(!l){a({title:"Nenhuma seção selecionada",description:"Por favor, selecione uma seção antes de adicionar um bloco.",variant:"destructive"});return}const c={...Z.cloneDeep(o),id:A(),position:g||{x:"20%",y:"20%"},size:o.size||{width:"50%",height:"auto"},layouts:{desktop:{},tablet:{},mobile:{}}};c.type==="text"&&(c.size.height="auto",c.content.level==="h1"?c.size.width="60%":c.content.level==="h2"?c.size.width="50%":c.size.width="40%"),t(h=>{if(!h)return null;const f=[...h.blocksBySection[l]||[],c];return{...h,blocksBySection:{...h.blocksBySection,[l]:f}}}),r(c)},[t,a,r]),updateBlock:s}},Bo=({selectedBlock:t,updateBlock:r,addBlock:n,activeSection:a,canvasRef:s,viewMode:i,setViewMode:o,proposalName:l})=>{const{toast:g}=le(),[c,h]=j.useState(null),[d,f]=j.useState(null),p=j.useRef(null),m=j.useCallback((w,C)=>{w.preventDefault(),h({x:w.clientX,y:w.clientY,block:C})},[]),v=j.useCallback(()=>h(null),[]),u=j.useCallback((w,C)=>{if(w==="copy")f(C),g({title:"Copiado!"});else if(w==="paste"&&d){const x={x:`${c.x%(s.current?.offsetWidth||800)/(s.current?.offsetWidth||800)*100}%`,y:`${(c.y-(s.current?.getBoundingClientRect().top||0))/(s.current?.offsetHeight||1200)*100}%`};n(d,a,x)}else if(w==="duplicate"){const x={x:`${(parseFloat(C.position?.x)||0)+2}%`,y:`${(parseFloat(C.position?.y)||0)+2}%`};n(C,a,x)}else if(w==="delete")r(C.id,null);else if(w==="toggleLock")r(C.id,{locked:!C.locked});else if(w==="remove_pdf_src")r(C.id,{content:{...C.content,src:null}});else if(w.startsWith("layer_")){const x=C.styles?.zIndex||(C.type==="pdf"?1:10),b={layer_top:999,layer_front:x+1,layer_back:Math.max(0,x-1),layer_bottom:0};if(C.type==="pdf"&&(w==="layer_top"||w==="layer_bottom"))return;r(C.id,{styles:{...C.styles,zIndex:b[w]}})}else g({title:"Ação em desenvolvimento",description:"Esta opção estará disponível em breve."});v()},[d,c,n,r,a,g,v,s]),y=j.useCallback(async()=>{if(!s.current)return;const w=i;o("desktop"),g({title:"Gerando PDF...",description:"Isso pode levar alguns segundos."}),await new Promise(C=>setTimeout(C,500));try{const C=s.current,x=Array.from(C.children),b=new Vn("p","px","a4"),D=b.internal.pageSize.getWidth(),I=b.internal.pageSize.getHeight();for(let M=0;M<x.length;M++){const X=x[M],U=await qn(X,{scale:2,useCORS:!0,logging:!1,allowTaint:!0,windowWidth:X.scrollWidth,windowHeight:X.scrollHeight}),J=U.toDataURL("image/png"),P=U.width,z=U.height,O=Math.min(D/P,I/z),K=P*O,_=z*O;M>0&&b.addPage(),b.addImage(J,"PNG",0,0,K,_)}b.save(`${l||"proposta"}.pdf`)}catch(C){g({title:"Erro ao gerar PDF",description:C.message,variant:"destructive"})}finally{o(w)}},[s,i,o,g,l]),E=j.useCallback(()=>{p.current&&p.current.click()},[]);return{contextMenu:c,handleContextMenu:m,closeContextMenu:v,handleContextMenuAction:u,handleExportPdf:y,fileInputRef:p,handleFileInputClick:E}};A();const $={backgroundColor:"transparent",backgroundOpacity:0},oi=[{type:"text",label:"Adicionar um título",icon:e.jsx(Zn,{size:18}),content:{text:"Título",level:"h1"},styles:{...$,fontSize:"48px",fontWeight:"bold"}},{type:"text",label:"Adicionar um subtítulo",icon:e.jsx(Jn,{size:18}),content:{text:"Subtítulo",level:"h2"},styles:{...$,fontSize:"32px",fontWeight:"bold"}},{type:"text",label:"Adicionar um parágrafo",icon:e.jsx(Er,{size:18}),content:{text:"Clique para adicionar seu texto. Use este espaço para detalhar sua oferta, contar sua história ou apresentar informações importantes.",level:"p"},styles:{...$,fontSize:"16px"}}],li=[{type:"image",label:"Imagem",icon:e.jsx(Fe,{size:18}),content:{src:"",alt:"Placeholder de imagem"},styles:{...$,paddingTop:"0px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px",width:"100%",borderRadius:"0px"}},{type:"pdf",label:"PDF",icon:e.jsx(xn,{size:18}),content:{src:""},styles:{...$,paddingTop:"0px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px",width:"100%",height:"600px"}},{type:"packages",label:"Pacotes",icon:e.jsx(vn,{size:18}),content:{packageIds:[],layout:"grid",title:"Nossos Pacotes"},styles:{...$,paddingTop:"40px",paddingBottom:"40px",paddingLeft:"20px",paddingRight:"20px"}},{type:"video",label:"Vídeo",icon:e.jsx(ks,{size:18}),content:{src:"https://www.youtube.com/embed/dQw4w9WgXcQ"},styles:{...$,paddingTop:"0px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px"}},{type:"testimonial",label:"Depoimento",icon:e.jsx(wr,{size:18}),content:{items:[{id:A(),name:"Cliente Satisfeito",role:"Casamento dos Sonhos",text:"Uma experiência incrível do início ao fim. As fotos ficaram maravilhosas!",avatarUrl:""}],layout:"card"},styles:{...$,paddingTop:"40px",paddingBottom:"40px",paddingLeft:"20px",paddingRight:"20px"}},{type:"faq",label:"FAQ",icon:e.jsx(bs,{size:18}),content:{items:[{id:A(),question:"Qual o prazo de entrega?",answer:"O prazo de entrega das fotos editadas é de 30 dias úteis após a data do evento."},{id:A(),question:"Você fotografa em outras cidades?",answer:"Sim, atendo em todo o Brasil. Custos de deslocamento e hospedagem são combinados à parte."}]},styles:{...$,paddingTop:"40px",paddingBottom:"40px",paddingLeft:"20px",paddingRight:"20px"}},{type:"cta",label:"Chamada à Ação",icon:e.jsx(Ht,{size:18}),content:{title:"Gostou da proposta?",subtitle:"Vamos dar o próximo passo para registrar seus momentos inesquecíveis.",buttons:[{id:A(),text:"Aceitar Proposta",actionType:"accept",link:""},{id:A(),text:"Falar no WhatsApp",actionType:"whatsapp",link:"5511999998888"}]},styles:{...$,paddingTop:"50px",paddingBottom:"50px",paddingLeft:"20px",paddingRight:"20px",color:"#333333",textAlign:"center"}},{type:"social",label:"Redes Sociais",icon:e.jsx(ls,{size:18}),content:{items:[{id:A(),platform:"instagram",url:"https://instagram.com"},{id:A(),platform:"facebook",url:"https://facebook.com"},{id:A(),platform:"site",url:"https://seusite.com"}]},styles:{...$,paddingTop:"20px",paddingBottom:"20px",iconColor:"#333333",alignment:"center"}},{type:"button",label:"Botão",icon:e.jsx(Ht,{size:18}),content:{text:"Clique aqui",href:"#"},styles:{...$,paddingTop:"0px",paddingBottom:"0px",paddingLeft:"0px",paddingRight:"0px",textAlign:"center",color:"#3B82F6",borderWidth:"0px"}},{type:"divider",label:"Divisor",icon:e.jsx(xs,{size:18}),content:{},styles:{...$,paddingTop:"10px",paddingBottom:"10px",paddingLeft:"20px",paddingRight:"20px"}},{type:"spacer",label:"Espaçador",icon:e.jsx(ps,{size:18}),content:{height:40},styles:{...$}}],ci=[{type:"box",label:"Caixa",icon:e.jsx(fs,{size:18}),content:{},styles:{...$,borderRadius:"8px",borderWidth:"1px",borderStyle:"solid",borderColor:"#e0e0e0"}},{type:"shape",label:"Retângulo",icon:e.jsx(cs,{size:18}),content:{shapeType:"rectangle"},styles:{...$}},{type:"shape",label:"Círculo",icon:e.jsx(yn,{size:18}),content:{shapeType:"circle"},styles:{...$}},{type:"shape",label:"Linha",icon:e.jsx(cr,{size:18}),content:{shapeType:"line"},styles:{...$,borderColor:"#000000",borderWidth:"2px"}},{type:"icon",label:"Ícone",icon:e.jsx(wr,{size:18}),content:{iconName:"Star"},styles:{...$,color:"#000000"}}],di=[{value:"Playfair Display",label:"Playfair Display"},{value:"Lato",label:"Lato"},{value:"DM Serif Display",label:"DM Serif Display"},{value:"Source Sans Pro",label:"Source Sans Pro"},{value:"Cormorant Garamond",label:"Cormorant Garamond"},{value:"Open Sans",label:"Open Sans"},{value:"Prata",label:"Prata"},{value:"Nunito",label:"Nunito"},{value:"EB Garamond",label:"EB Garamond"},{value:"Raleway",label:"Raleway"},{value:"Libre Baskerville",label:"Libre Baskerville"},{value:"Inter",label:"Inter"},{value:"Abril Fatface",label:"Abril Fatface"},{value:"Karla",label:"Karla"},{value:"Marcellus",label:"Marcellus"},{value:"Noto Sans",label:"Noto Sans"},{value:"Josefin Slab",label:"Josefin Slab"},{value:"Work Sans",label:"Work Sans"},{value:"Cinzel",label:"Cinzel"},{value:"Quicksand",label:"Quicksand"},{value:"Arial",label:"Arial"},{value:"Verdana",label:"Verdana"},{value:"Georgia",label:"Georgia"},{value:"Times New Roman",label:"Times New Roman"}],at=({block:t,onAddBlock:r,activeSection:n})=>{const[{isDragging:a},s]=bt(()=>({type:dr.BLOCK,item:()=>Z.cloneDeep(t),collect:o=>({isDragging:o.isDragging()})})),i=o=>{o.preventDefault(),r(t,n,{x:"20%",y:"20%"})};return e.jsxs("div",{ref:s,className:"flex items-center gap-3 p-2 rounded-md border bg-background hover:bg-muted cursor-grab transition-all",style:{opacity:a?.5:1},onClick:i,onKeyDown:o=>{o.key==="Enter"&&i(o)},role:"button",tabIndex:0,title:"Clique para adicionar ou arraste para a posição desejada.",children:[t.icon||e.jsx(Er,{size:18}),e.jsx("span",{className:"text-sm font-medium",children:t.label})]})},ui=({uploads:t,loading:r,proposalId:n,onUploadComplete:a,isNew:s,handleSave:i,onAddBlock:o,activeSection:l})=>{const g=H.useRef(null),{user:c}=ke(),{toast:h}=le(),[d,f]=j.useState(!1),p=async v=>{const u=v.target.files;if(!u||u.length===0||!c)return;let y=n;if(s&&!y)try{h({title:"Salvando rascunho...",description:"É preciso salvar a proposta para fazer uploads."});const b=await i();if(b&&b.id)y=b.id;else{h({title:"Falha ao salvar",description:"Não foi possível salvar a proposta para o upload.",variant:"destructive"});return}}catch{h({title:"Erro ao salvar",description:"Ocorreu um erro ao salvar a proposta.",variant:"destructive"});return}f(!0),h({title:"Enviando arquivos...",description:`Enviando ${u.length} arquivo(s).`});const E=Array.from(u).filter(b=>b.size>10*1024*1024?(h({title:"Arquivo muito grande",description:`O arquivo ${b.name} excede o limite de 10MB e não será enviado.`,variant:"destructive"}),!1):!0);if(E.length===0){f(!1);return}const w=E.map(b=>{const D=jn(b.name),I=`${c.id}/${y}/${A()}-${D}`;return G.storage.from("propostas").upload(I,b)}),x=(await Promise.all(w)).filter(b=>b.error);x.length>0&&h({title:"Erro no Upload",description:`Falha ao enviar ${x.length} arquivo(s). ${x[0].error.message}`,variant:"destructive"}),x.length<E.length&&(h({title:"Upload Concluído!",description:`${E.length-x.length} arquivo(s) enviado(s) com sucesso.`}),a()),f(!1)},m=({imageUrl:v})=>{const[{isDragging:u},y]=bt(()=>({type:dr.IMAGE_UPLOAD,item:()=>Lt(v),collect:C=>({isImageDragging:C.isDragging()})})),E=async C=>{C.stopPropagation();const x=new URL(v).pathname.split("/propostas/")[1],{error:b}=await G.storage.from("propostas").remove([x]);b?h({title:"Erro ao deletar imagem",description:b.message,variant:"destructive"}):(h({title:"Imagem deletada com sucesso!"}),a())},w=()=>{const C=JSON.parse(Lt(v).data);o(C,l,{x:"20%",y:"20%"})};return e.jsxs("div",{ref:y,className:"relative group cursor-grab",style:{opacity:u?.5:1},children:[e.jsx("div",{onClick:w,className:"w-full h-full",children:e.jsx("img",{src:v,alt:"Upload",className:"w-full h-auto object-cover rounded-md aspect-square"})}),e.jsxs(ur,{children:[e.jsx(hr,{asChild:!0,children:e.jsx(N,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-0 group-hover:opacity-100 transition-opacity",onClick:C=>C.stopPropagation(),children:e.jsx(oe,{size:12})})}),e.jsxs(pr,{onClick:C=>C.stopPropagation(),children:[e.jsxs(fr,{children:[e.jsx(gr,{children:"Excluir Imagem?"}),e.jsx(mr,{children:"Esta ação não pode ser desfeita. A imagem será removida permanentemente do seu armazenamento."})]}),e.jsxs(xr,{children:[e.jsx(vr,{children:"Cancelar"}),e.jsx(yr,{onClick:E,children:"Excluir"})]})]})]})]})};return e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs(N,{onClick:()=>g.current?.click(),disabled:d,children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),d?"Enviando...":"Fazer Upload (Max 10MB)"]}),e.jsx("input",{type:"file",ref:g,className:"hidden",multiple:!0,onChange:p,accept:"image/*,application/pdf"}),e.jsx(Ae,{className:"mt-4 flex-1",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2 pr-2",children:[r&&e.jsx("p",{children:"Carregando..."}),t.map(v=>e.jsx(m,{imageUrl:v},v))]})})]})},Vo=({onAddBlock:t,activeSection:r,uploads:n,loadingUploads:a,onUploadComplete:s,proposalId:i,isNew:o,handleSave:l,onToggle:g})=>e.jsxs(ge.aside,{initial:{x:0},exit:{x:"-100%"},transition:{type:"spring",stiffness:300,damping:30},className:"w-72 bg-background border-r p-0 flex flex-col flex-shrink-0 studio-sidebar",children:[e.jsxs("div",{className:"flex items-center justify-between p-2 border-b",children:[e.jsx("h3",{className:"font-semibold text-lg ml-2",children:"Adicionar"}),e.jsx(N,{variant:"ghost",size:"icon",onClick:g,children:e.jsx(ws,{})})]}),e.jsxs(lt,{defaultValue:"add",className:"flex flex-col h-full",children:[e.jsxs(ct,{className:"grid w-full grid-cols-2 rounded-none",children:[e.jsxs(pe,{value:"add",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"})," Adicionar"]}),e.jsxs(pe,{value:"uploads",children:[e.jsx(be,{className:"w-4 h-4 mr-2"})," Uploads"]})]}),e.jsx(fe,{value:"add",className:"flex-1 overflow-hidden p-4",children:e.jsx(Ae,{className:"h-full pr-4 -mr-4",children:e.jsxs(zn,{type:"multiple",defaultValue:["text","media"],className:"w-full",children:[e.jsxs(et,{value:"text",children:[e.jsx(tt,{className:"font-semibold text-sm",children:"Texto"}),e.jsx(rt,{className:"pt-2 space-y-2",children:oi.map(c=>e.jsx(at,{block:c,onAddBlock:t,activeSection:r},c.label))})]}),e.jsxs(et,{value:"media",children:[e.jsx(tt,{className:"font-semibold text-sm",children:"Mídia & Conteúdo"}),e.jsx(rt,{className:"pt-2 space-y-2",children:li.map(c=>e.jsx(at,{block:c,onAddBlock:t,activeSection:r},c.type))})]}),e.jsxs(et,{value:"elements",children:[e.jsx(tt,{className:"font-semibold text-sm",children:"Formas & Elementos"}),e.jsx(rt,{className:"pt-2 space-y-2",children:ci.map(c=>e.jsx(at,{block:c,onAddBlock:t,activeSection:r},c.label))})]})]})})}),e.jsx(fe,{value:"uploads",className:"flex-1 overflow-hidden p-4",children:e.jsx(ui,{uploads:n,loading:a,onUploadComplete:s,proposalId:i,isNew:o,handleSave:l,onAddBlock:t,activeSection:r})})]})]}),Kt=[{value:"instagram",label:"Instagram",icon:e.jsx(Wn,{size:16}),baseUrl:"https://instagram.com/"},{value:"facebook",label:"Facebook",icon:e.jsx(_n,{size:16}),baseUrl:"https://facebook.com/"},{value:"whatsapp",label:"WhatsApp",icon:e.jsx(Gn,{size:16}),baseUrl:"55"},{value:"twitter",label:"Twitter / X",icon:e.jsx(Rn,{size:16}),baseUrl:"https://x.com/"},{value:"linkedin",label:"LinkedIn",icon:e.jsx(Mn,{size:16}),baseUrl:"https://linkedin.com/in/"},{value:"youtube",label:"YouTube",icon:e.jsx(Ln,{size:16}),baseUrl:"https://youtube.com/"},{value:"pinterest",label:"Pinterest",icon:e.jsx(Fe,{size:16}),baseUrl:"https://pinterest.com/"},{value:"site",label:"Site / Link",icon:e.jsx(Xn,{size:16}),baseUrl:"https://"}],hi=({selectedBlock:t,updateBlock:r,isAdmin:n,proposalId:a,onUploadComplete:s})=>{const{servicePackages:i,user:o}=ke(),{toast:l}=le(),g=j.useRef(null),c=j.useRef(null),h=j.useRef(null),d=t.content||{},f=(x,b)=>{if(!t)return;const D={...t.content,[x]:b};r(t.id,{content:D})},p=(x,b,D,I)=>{const M=[...d[x]||[]];M[b]={...M[b],[D]:I},f(x,M)},m=(x,b)=>{const D=[...d[x]||[],b];f(x,D)},v=(x,b)=>{const D=(d[x]||[]).filter((I,M)=>M!==b);f(x,D)},u=(x,b)=>{if(!t)return;const D=t.content?.packageIds||[],I=b?[...D,x]:D.filter(M=>M!==x);f("packageIds",I)},y=async x=>{const b=x.target.files?.[0];if(!b||!o)return;if(b.size>5*1024*1024){l({title:"Arquivo muito grande",description:"A imagem excede o limite de 5MB.",variant:"destructive"});return}l({title:"Enviando imagem...",description:"Aguarde um momento."});const D=`${o.id}/${a||"new"}/${A()}-${b.name}`,{error:I}=await G.storage.from("propostas").upload(D,b);if(I){l({title:"Erro no upload",description:I.message,variant:"destructive"});return}const{data:{publicUrl:M}}=G.storage.from("propostas").getPublicUrl(D);f("src",M),s&&s(),l({title:"Imagem atualizada!",variant:"success"})},E=async x=>{const b=x.target.files?.[0];if(!b||!o)return;if(b.type!=="application/pdf"){l({title:"Formato inválido",description:"Por favor, selecione um arquivo PDF.",variant:"destructive"});return}if(b.size>10*1024*1024){l({title:"Arquivo muito grande",description:"O PDF excede o limite de 10MB.",variant:"destructive"});return}l({title:"Enviando PDF...",description:"Aguarde um momento."});const D=`${o.id}/${a||"new"}/pdfs/${A()}-${b.name}`,{error:I}=await G.storage.from("propostas").upload(D,b);if(I){l({title:"Erro no upload",description:I.message,variant:"destructive"});return}const{data:{publicUrl:M}}=G.storage.from("propostas").getPublicUrl(D);f("src",M),s&&s(),l({title:"PDF carregado!",variant:"success"})},w=async(x,b)=>{const D=x.target.files?.[0];if(!D||!o)return;if(D.size>5*1024*1024){l({title:"Arquivo muito grande",description:"A imagem excede o limite de 5MB.",variant:"destructive"});return}l({title:"Enviando foto...",description:"Aguarde um momento."});const I=`${o.id}/${a||"new"}/testimonials/${A()}-${D.name}`,{error:M}=await G.storage.from("propostas").upload(I,D);if(M){l({title:"Erro no upload",description:M.message,variant:"destructive"});return}const{data:{publicUrl:X}}=G.storage.from("propostas").getPublicUrl(I);p("items",b,"avatarUrl",X),l({title:"Foto do cliente atualizada!",variant:"success"})},C=(x,b)=>{const D=Kt.find(M=>M.value===b),I=[...d.items||[]];I[x]={...I[x],platform:b,url:D?.baseUrl||""},f("items",I)};switch(t.type){case"text":return e.jsxs(e.Fragment,{children:[e.jsxs(T,{children:["Texto (use ","{{CLIENT_NAME}}"," para nome do cliente)"]}),e.jsx(Je,{value:d.text,onChange:x=>f("text",x.target.value)}),e.jsx(T,{children:"Nível"}),e.jsxs(B,{value:d.level||"p",onValueChange:x=>f("level",x),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"h1",children:"Título 1"}),e.jsx(S,{value:"h2",children:"Título 2"}),e.jsx(S,{value:"h3",children:"Título 3"}),e.jsx(S,{value:"p",children:"Parágrafo"})]})]})]});case"image":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(N,{onClick:()=>g.current?.click(),className:"w-full",children:"Alterar Imagem (Max 5MB)"}),e.jsx("input",{type:"file",ref:g,className:"hidden",onChange:y,accept:"image/*"}),e.jsx(T,{children:"Texto Alternativo (SEO)"}),e.jsx(R,{value:d.alt,onChange:x=>f("alt",x.target.value),placeholder:"Descreva a imagem"}),e.jsx(T,{children:"URL da Imagem (Opcional)"}),e.jsx(R,{value:d.src?.startsWith("http")?d.src:"",onChange:x=>f("src",x.target.value),placeholder:"Cole um link de imagem aqui"})]});case"pdf":return e.jsxs("div",{className:"space-y-2",children:[e.jsxs(N,{onClick:()=>h.current?.click(),className:"w-full",children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),d.src?"Alterar PDF (Max 10MB)":"Fazer upload de PDF (Max 10MB)"]}),e.jsx("input",{type:"file",ref:h,className:"hidden",onChange:E,accept:"application/pdf"}),e.jsx(T,{children:"URL do PDF (Opcional)"}),e.jsx(R,{value:d.src?.startsWith("http")?d.src:"",onChange:x=>f("src",x.target.value),placeholder:"Cole um link de PDF público aqui"}),d.src&&e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["Arquivo atual: ",e.jsx("a",{href:d.src,target:"_blank",rel:"noopener noreferrer",className:"underline",children:d.src.split("/").pop()})]})]});case"button":return e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:"Texto do Botão"}),e.jsx(R,{value:d.text,onChange:x=>f("text",x.target.value)}),e.jsx(T,{children:"Link (URL)"}),e.jsx(R,{type:"url",value:d.href,onChange:x=>f("href",x.target.value)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{id:"target-blank",checked:d.target==="_blank",onCheckedChange:x=>f("target",x?"_blank":"_self")}),e.jsx("label",{htmlFor:"target-blank",className:"text-sm font-medium leading-none",children:"Abrir em nova aba"})]})]});case"packages":return e.jsxs(e.Fragment,{children:[e.jsx(T,{children:"Título da Seção"}),e.jsx(R,{value:d.title,onChange:x=>f("title",x.target.value)}),e.jsx(T,{className:"mt-2",children:"Layout"}),e.jsxs(B,{value:d.layout||"grid",onValueChange:x=>f("layout",x),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"grid",children:"Grade"}),e.jsx(S,{value:"table",children:"Tabela Comparativa"}),e.jsx(S,{value:"accordion",children:"Accordion"})]})]}),!n&&e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"mt-2",children:"Selecionar Pacotes"}),e.jsx("div",{className:"space-y-2 p-2 border rounded-md max-h-60 overflow-y-auto",children:(i||[]).map(x=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rt,{id:`pkg-${x.id}`,checked:(d.packageIds||[]).includes(x.id),onCheckedChange:b=>u(x.id,b)}),e.jsx("label",{htmlFor:`pkg-${x.id}`,className:"text-sm",children:x.name})]},x.id))})]})]});case"testimonial":return e.jsxs("div",{className:"space-y-4",children:[e.jsx(T,{children:"Layout"}),e.jsxs(B,{value:d.layout||"slider",onValueChange:x=>f("layout",x),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"slider",children:"Carrossel"}),e.jsx(S,{value:"grid",children:"Grade"}),e.jsx(S,{value:"card",children:"Cartão Único"}),e.jsx(S,{value:"quote",children:"Citação Única"})]})]}),e.jsx("div",{className:"space-y-4",children:(d.items||[]).map((x,b)=>e.jsxs("div",{className:"p-3 border rounded-md space-y-2 relative",children:[e.jsx(N,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>v("items",b),children:e.jsx(oe,{size:12})}),e.jsx(T,{children:"Nome"}),e.jsx(R,{value:x.name,onChange:D=>p("items",b,"name",D.target.value)}),e.jsx(T,{children:"Título/Cargo"}),e.jsx(R,{value:x.role,onChange:D=>p("items",b,"role",D.target.value)}),e.jsx(T,{children:"Depoimento"}),e.jsx(Je,{value:x.text,onChange:D=>p("items",b,"text",D.target.value)}),e.jsx(T,{children:"Foto do Cliente"}),e.jsx(N,{variant:"outline",className:"w-full",onClick:()=>c.current?.click(),children:"Upload Foto"}),e.jsx("input",{type:"file",ref:c,className:"hidden",onChange:D=>w(D,b),accept:"image/*"}),x.avatarUrl&&e.jsx("img",{src:x.avatarUrl,alt:"Avatar",className:"w-16 h-16 rounded-full object-cover mt-2"})]},x.id))}),e.jsxs(N,{onClick:()=>m("items",{id:A(),name:"Novo Cliente",role:"Título",text:"Depoimento...",avatarUrl:""}),className:"w-full",children:[e.jsx(Me,{size:16,className:"mr-2"})," Adicionar Depoimento"]})]});case"cta":return e.jsxs("div",{className:"space-y-4",children:[e.jsx(T,{children:"Título"}),e.jsx(R,{value:d.title,onChange:x=>f("title",x.target.value)}),e.jsx(T,{children:"Subtítulo"}),e.jsx(Je,{value:d.subtitle,onChange:x=>f("subtitle",x.target.value)}),e.jsx("p",{className:"text-sm font-medium pt-2",children:"Botões"}),(d.buttons||[]).map((x,b)=>e.jsxs("div",{className:"p-3 border rounded-md space-y-2 relative",children:[e.jsx(N,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>v("buttons",b),children:e.jsx(oe,{size:12})}),e.jsx(T,{children:"Texto do Botão"}),e.jsx(R,{value:x.text,onChange:D=>p("buttons",b,"text",D.target.value)}),e.jsx(T,{children:"Ação"}),e.jsxs(B,{value:x.actionType,onValueChange:D=>p("buttons",b,"actionType",D),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"accept",children:"Aceitar Proposta"}),e.jsx(S,{value:"link",children:"Abrir Link"}),e.jsx(S,{value:"whatsapp",children:"Abrir WhatsApp"})]})]}),(x.actionType==="link"||x.actionType==="whatsapp")&&e.jsxs(e.Fragment,{children:[e.jsx(T,{children:"Link ou Telefone"}),e.jsx(R,{value:x.link,onChange:D=>p("buttons",b,"link",D.target.value),placeholder:x.actionType==="whatsapp"?"5511999998888":"https://..."})]})]},x.id)),e.jsxs(N,{onClick:()=>m("buttons",{id:A(),text:"Novo Botão",actionType:"link",link:"#"}),className:"w-full",children:[e.jsx(Me,{size:16,className:"mr-2"})," Adicionar Botão"]})]});case"social":return e.jsxs("div",{className:"space-y-4",children:[(d.items||[]).map((x,b)=>e.jsxs("div",{className:"p-3 border rounded-md space-y-2 relative",children:[e.jsx(N,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>v("items",b),children:e.jsx(oe,{size:12})}),e.jsx(T,{children:"Plataforma"}),e.jsxs(B,{value:x.platform,onValueChange:D=>C(b,D),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsx(W,{children:Kt.map(D=>e.jsxs(S,{value:D.value,children:[D.icon,e.jsx("span",{className:"ml-2",children:D.label})]},D.value))})]}),e.jsx(T,{children:"URL ou Usuário"}),e.jsx(R,{value:x.url,onChange:D=>p("items",b,"url",D.target.value)})]},x.id)),e.jsxs(N,{onClick:()=>m("items",{id:A(),platform:"instagram",url:"https://instagram.com/"}),className:"w-full",children:[e.jsx(Me,{size:16,className:"mr-2"})," Adicionar Rede Social"]})]});default:return e.jsx("p",{className:"text-sm text-muted-foreground",children:"Este bloco não possui conteúdo editável."})}};var $r=["PageUp","PageDown"],Br=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Vr={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},Se="Slider",[ft,pi,fi]=Cn(Se),[qr,qo]=Sn(Se,[fi]),[gi,Xe]=qr(Se),Wr=j.forwardRef((t,r)=>{const{name:n,min:a=0,max:s=100,step:i=1,orientation:o="horizontal",disabled:l=!1,minStepsBetweenThumbs:g=0,defaultValue:c=[a],value:h,onValueChange:d=()=>{},onValueCommit:f=()=>{},inverted:p=!1,form:m,...v}=t,u=j.useRef(new Set),y=j.useRef(0),w=o==="horizontal"?mi:xi,[C=[],x]=bn({prop:h,defaultProp:c,onChange:U=>{[...u.current][y.current]?.focus(),d(U)}}),b=j.useRef(C);function D(U){const J=Si(C,U);X(U,J)}function I(U){X(U,y.current)}function M(){const U=b.current[y.current];C[y.current]!==U&&f(C)}function X(U,J,{commit:P}={commit:!1}){const z=Di(i),O=Ei(Math.round((U-a)/i)*i+a,z),K=ir(O,[a,s]);x((_=[])=>{const ce=ji(_,K,J);if(Ni(ce,g*i)){y.current=ce.indexOf(K);const me=String(ce)!==String(_);return me&&P&&f(ce),me?ce:_}else return _})}return e.jsx(gi,{scope:t.__scopeSlider,name:n,disabled:l,min:a,max:s,valueIndexToChangeRef:y,thumbs:u.current,values:C,orientation:o,form:m,children:e.jsx(ft.Provider,{scope:t.__scopeSlider,children:e.jsx(ft.Slot,{scope:t.__scopeSlider,children:e.jsx(w,{"aria-disabled":l,"data-disabled":l?"":void 0,...v,ref:r,onPointerDown:ye(v.onPointerDown,()=>{l||(b.current=C)}),min:a,max:s,inverted:p,onSlideStart:l?void 0:D,onSlideMove:l?void 0:I,onSlideEnd:l?void 0:M,onHomeKeyDown:()=>!l&&X(a,0,{commit:!0}),onEndKeyDown:()=>!l&&X(s,C.length-1,{commit:!0}),onStepKeyDown:({event:U,direction:J})=>{if(!l){const O=$r.includes(U.key)||U.shiftKey&&Br.includes(U.key)?10:1,K=y.current,_=C[K],ce=i*O*J;X(_+ce,K,{commit:!0})}}})})})})});Wr.displayName=Se;var[Gr,Xr]=qr(Se,{startEdge:"left",endEdge:"right",size:"width",direction:1}),mi=j.forwardRef((t,r)=>{const{min:n,max:a,dir:s,inverted:i,onSlideStart:o,onSlideMove:l,onSlideEnd:g,onStepKeyDown:c,...h}=t,[d,f]=j.useState(null),p=je(r,w=>f(w)),m=j.useRef(void 0),v=wn(s),u=v==="ltr",y=u&&!i||!u&&i;function E(w){const C=m.current||d.getBoundingClientRect(),x=[0,C.width],D=kt(x,y?[n,a]:[a,n]);return m.current=C,D(w-C.left)}return e.jsx(Gr,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:e.jsx(Yr,{dir:v,"data-orientation":"horizontal",...h,ref:p,style:{...h.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:w=>{const C=E(w.clientX);o?.(C)},onSlideMove:w=>{const C=E(w.clientX);l?.(C)},onSlideEnd:()=>{m.current=void 0,g?.()},onStepKeyDown:w=>{const x=Vr[y?"from-left":"from-right"].includes(w.key);c?.({event:w,direction:x?-1:1})}})})}),xi=j.forwardRef((t,r)=>{const{min:n,max:a,inverted:s,onSlideStart:i,onSlideMove:o,onSlideEnd:l,onStepKeyDown:g,...c}=t,h=j.useRef(null),d=je(r,h),f=j.useRef(void 0),p=!s;function m(v){const u=f.current||h.current.getBoundingClientRect(),y=[0,u.height],w=kt(y,p?[a,n]:[n,a]);return f.current=u,w(v-u.top)}return e.jsx(Gr,{scope:t.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:e.jsx(Yr,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:v=>{const u=m(v.clientY);i?.(u)},onSlideMove:v=>{const u=m(v.clientY);o?.(u)},onSlideEnd:()=>{f.current=void 0,l?.()},onStepKeyDown:v=>{const y=Vr[p?"from-bottom":"from-top"].includes(v.key);g?.({event:v,direction:y?-1:1})}})})}),Yr=j.forwardRef((t,r)=>{const{__scopeSlider:n,onSlideStart:a,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:l,onStepKeyDown:g,...c}=t,h=Xe(Se,n);return e.jsx(Ie.span,{...c,ref:r,onKeyDown:ye(t.onKeyDown,d=>{d.key==="Home"?(o(d),d.preventDefault()):d.key==="End"?(l(d),d.preventDefault()):$r.concat(Br).includes(d.key)&&(g(d),d.preventDefault())}),onPointerDown:ye(t.onPointerDown,d=>{const f=d.target;f.setPointerCapture(d.pointerId),d.preventDefault(),h.thumbs.has(f)?f.focus():a(d)}),onPointerMove:ye(t.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:ye(t.onPointerUp,d=>{const f=d.target;f.hasPointerCapture(d.pointerId)&&(f.releasePointerCapture(d.pointerId),i(d))})})}),Kr="SliderTrack",Qr=j.forwardRef((t,r)=>{const{__scopeSlider:n,...a}=t,s=Xe(Kr,n);return e.jsx(Ie.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...a,ref:r})});Qr.displayName=Kr;var gt="SliderRange",Zr=j.forwardRef((t,r)=>{const{__scopeSlider:n,...a}=t,s=Xe(gt,n),i=Xr(gt,n),o=j.useRef(null),l=je(r,o),g=s.values.length,c=s.values.map(f=>tn(f,s.min,s.max)),h=g>1?Math.min(...c):0,d=100-Math.max(...c);return e.jsx(Ie.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...a,ref:l,style:{...t.style,[i.startEdge]:h+"%",[i.endEdge]:d+"%"}})});Zr.displayName=gt;var mt="SliderThumb",Jr=j.forwardRef((t,r)=>{const n=pi(t.__scopeSlider),[a,s]=j.useState(null),i=je(r,l=>s(l)),o=j.useMemo(()=>a?n().findIndex(l=>l.ref.current===a):-1,[n,a]);return e.jsx(vi,{...t,ref:i,index:o})}),vi=j.forwardRef((t,r)=>{const{__scopeSlider:n,index:a,name:s,...i}=t,o=Xe(mt,n),l=Xr(mt,n),[g,c]=j.useState(null),h=je(r,E=>c(E)),d=g?o.form||!!g.closest("form"):!0,f=Nn(g),p=o.values[a],m=p===void 0?0:tn(p,o.min,o.max),v=bi(a,o.values.length),u=f?.[l.size],y=u?Ci(u,m,l.direction):0;return j.useEffect(()=>{if(g)return o.thumbs.add(g),()=>{o.thumbs.delete(g)}},[g,o.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[l.startEdge]:`calc(${m}% + ${y}px)`},children:[e.jsx(ft.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(Ie.span,{role:"slider","aria-label":t["aria-label"]||v,"aria-valuemin":o.min,"aria-valuenow":p,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:h,style:p===void 0?{display:"none"}:t.style,onFocus:ye(t.onFocus,()=>{o.valueIndexToChangeRef.current=a})})}),d&&e.jsx(en,{name:s??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:p},a)]})});Jr.displayName=mt;var yi="RadioBubbleInput",en=j.forwardRef(({__scopeSlider:t,value:r,...n},a)=>{const s=j.useRef(null),i=je(s,a),o=Dn(r);return j.useEffect(()=>{const l=s.current;if(!l)return;const g=window.HTMLInputElement.prototype,h=Object.getOwnPropertyDescriptor(g,"value").set;if(o!==r&&h){const d=new Event("input",{bubbles:!0});h.call(l,r),l.dispatchEvent(d)}},[o,r]),e.jsx(Ie.input,{style:{display:"none"},...n,ref:i,defaultValue:r})});en.displayName=yi;function ji(t=[],r,n){const a=[...t];return a[n]=r,a.sort((s,i)=>s-i)}function tn(t,r,n){const i=100/(n-r)*(t-r);return ir(i,[0,100])}function bi(t,r){return r>2?`Value ${t+1} of ${r}`:r===2?["Minimum","Maximum"][t]:void 0}function Si(t,r){if(t.length===1)return 0;const n=t.map(s=>Math.abs(s-r)),a=Math.min(...n);return n.indexOf(a)}function Ci(t,r,n){const a=t/2,i=kt([0,50],[0,a]);return(a-i(r)*n)*n}function wi(t){return t.slice(0,-1).map((r,n)=>t[n+1]-r)}function Ni(t,r){if(r>0){const n=wi(t);return Math.min(...n)>=r}return!0}function kt(t,r){return n=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const a=(r[1]-r[0])/(t[1]-t[0]);return r[0]+a*(n-t[0])}}function Di(t){return(String(t).split(".")[1]||"").length}function Ei(t,r){const n=Math.pow(10,r);return Math.round(t*n)/n}var rn=Wr,Ti=Qr,ki=Zr,Ii=Jr;const ue=H.forwardRef(({className:t,...r},n)=>e.jsxs(rn,{ref:n,className:Ee("relative flex w-full touch-none select-none items-center",t),...r,children:[e.jsx(Ti,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:e.jsx(ki,{className:"absolute h-full bg-primary"})}),e.jsx(Ii,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));ue.displayName=rn.displayName;function Ye(){return(Ye=Object.assign||function(t){for(var r=1;r<arguments.length;r++){var n=arguments[r];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])}return t}).apply(this,arguments)}function nn(t,r){if(t==null)return{};var n,a,s={},i=Object.keys(t);for(a=0;a<i.length;a++)r.indexOf(n=i[a])>=0||(s[n]=t[n]);return s}function xt(t){var r=j.useRef(t),n=j.useRef(function(a){r.current&&r.current(a)});return r.current=t,n.current}var Te=function(t,r,n){return r===void 0&&(r=0),n===void 0&&(n=1),t>n?n:t<r?r:t},De=function(t){return"touches"in t},vt=function(t){return t&&t.ownerDocument.defaultView||self},Qt=function(t,r,n){var a=t.getBoundingClientRect(),s=De(r)?function(i,o){for(var l=0;l<i.length;l++)if(i[l].identifier===o)return i[l];return i[0]}(r.touches,n):r;return{left:Te((s.pageX-(a.left+vt(t).pageXOffset))/a.width),top:Te((s.pageY-(a.top+vt(t).pageYOffset))/a.height)}},Zt=function(t){!De(t)&&t.preventDefault()},sn=H.memo(function(t){var r=t.onMove,n=t.onKey,a=nn(t,["onMove","onKey"]),s=j.useRef(null),i=xt(r),o=xt(n),l=j.useRef(null),g=j.useRef(!1),c=j.useMemo(function(){var p=function(u){Zt(u),(De(u)?u.touches.length>0:u.buttons>0)&&s.current?i(Qt(s.current,u,l.current)):v(!1)},m=function(){return v(!1)};function v(u){var y=g.current,E=vt(s.current),w=u?E.addEventListener:E.removeEventListener;w(y?"touchmove":"mousemove",p),w(y?"touchend":"mouseup",m)}return[function(u){var y=u.nativeEvent,E=s.current;if(E&&(Zt(y),!function(C,x){return x&&!De(C)}(y,g.current)&&E)){if(De(y)){g.current=!0;var w=y.changedTouches||[];w.length&&(l.current=w[0].identifier)}E.focus(),i(Qt(E,y,l.current)),v(!0)}},function(u){var y=u.which||u.keyCode;y<37||y>40||(u.preventDefault(),o({left:y===39?.05:y===37?-.05:0,top:y===40?.05:y===38?-.05:0}))},v]},[o,i]),h=c[0],d=c[1],f=c[2];return j.useEffect(function(){return f},[f]),H.createElement("div",Ye({},a,{onTouchStart:h,onMouseDown:h,className:"react-colorful__interactive",ref:s,onKeyDown:d,tabIndex:0,role:"slider"}))}),It=function(t){return t.filter(Boolean).join(" ")},an=function(t){var r=t.color,n=t.left,a=t.top,s=a===void 0?.5:a,i=It(["react-colorful__pointer",t.className]);return H.createElement("div",{className:i,style:{top:100*s+"%",left:100*n+"%"}},H.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:r}}))},Y=function(t,r,n){return r===void 0&&(r=0),n===void 0&&(n=Math.pow(10,r)),Math.round(n*t)/n},Oi=function(t){return Mi(yt(t))},yt=function(t){return t[0]==="#"&&(t=t.substring(1)),t.length<6?{r:parseInt(t[0]+t[0],16),g:parseInt(t[1]+t[1],16),b:parseInt(t[2]+t[2],16),a:t.length===4?Y(parseInt(t[3]+t[3],16)/255,2):1}:{r:parseInt(t.substring(0,2),16),g:parseInt(t.substring(2,4),16),b:parseInt(t.substring(4,6),16),a:t.length===8?Y(parseInt(t.substring(6,8),16)/255,2):1}},Pi=function(t){return Ri(_i(t))},zi=function(t){var r=t.s,n=t.v,a=t.a,s=(200-r)*n/100;return{h:Y(t.h),s:Y(s>0&&s<200?r*n/100/(s<=100?s:200-s)*100:0),l:Y(s/2),a:Y(a,2)}},jt=function(t){var r=zi(t);return"hsl("+r.h+", "+r.s+"%, "+r.l+"%)"},_i=function(t){var r=t.h,n=t.s,a=t.v,s=t.a;r=r/360*6,n/=100,a/=100;var i=Math.floor(r),o=a*(1-n),l=a*(1-(r-i)*n),g=a*(1-(1-r+i)*n),c=i%6;return{r:Y(255*[a,l,o,o,g,a][c]),g:Y(255*[g,a,a,l,o,o][c]),b:Y(255*[o,o,g,a,a,l][c]),a:Y(s,2)}},_e=function(t){var r=t.toString(16);return r.length<2?"0"+r:r},Ri=function(t){var r=t.r,n=t.g,a=t.b,s=t.a,i=s<1?_e(Y(255*s)):"";return"#"+_e(r)+_e(n)+_e(a)+i},Mi=function(t){var r=t.r,n=t.g,a=t.b,s=t.a,i=Math.max(r,n,a),o=i-Math.min(r,n,a),l=o?i===r?(n-a)/o:i===n?2+(a-r)/o:4+(r-n)/o:0;return{h:Y(60*(l<0?l+6:l)),s:Y(i?o/i*100:0),v:Y(i/255*100),a:s}},Li=H.memo(function(t){var r=t.hue,n=t.onChange,a=It(["react-colorful__hue",t.className]);return H.createElement("div",{className:a},H.createElement(sn,{onMove:function(s){n({h:360*s.left})},onKey:function(s){n({h:Te(r+360*s.left,0,360)})},"aria-label":"Hue","aria-valuenow":Y(r),"aria-valuemax":"360","aria-valuemin":"0"},H.createElement(an,{className:"react-colorful__hue-pointer",left:r/360,color:jt({h:r,s:100,v:100,a:1})})))}),Ai=H.memo(function(t){var r=t.hsva,n=t.onChange,a={backgroundColor:jt({h:r.h,s:100,v:100,a:1})};return H.createElement("div",{className:"react-colorful__saturation",style:a},H.createElement(sn,{onMove:function(s){n({s:100*s.left,v:100-100*s.top})},onKey:function(s){n({s:Te(r.s+100*s.left,0,100),v:Te(r.v-100*s.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Y(r.s)+"%, Brightness "+Y(r.v)+"%"},H.createElement(an,{className:"react-colorful__saturation-pointer",top:1-r.v/100,left:r.s/100,color:jt(r)})))}),on=function(t,r){if(t===r)return!0;for(var n in t)if(t[n]!==r[n])return!1;return!0},Fi=function(t,r){return t.toLowerCase()===r.toLowerCase()||on(yt(t),yt(r))};function Hi(t,r,n){var a=xt(n),s=j.useState(function(){return t.toHsva(r)}),i=s[0],o=s[1],l=j.useRef({color:r,hsva:i});j.useEffect(function(){if(!t.equal(r,l.current.color)){var c=t.toHsva(r);l.current={hsva:c,color:r},o(c)}},[r,t]),j.useEffect(function(){var c;on(i,l.current.hsva)||t.equal(c=t.fromHsva(i),l.current.color)||(l.current={hsva:i,color:c},a(c))},[i,t,a]);var g=j.useCallback(function(c){o(function(h){return Object.assign({},h,c)})},[]);return[i,g]}var Ui=typeof window<"u"?j.useLayoutEffect:j.useEffect,$i=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Jt=new Map,Bi=function(t){Ui(function(){var r=t.current?t.current.ownerDocument:document;if(r!==void 0&&!Jt.has(r)){var n=r.createElement("style");n.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Jt.set(r,n);var a=$i();a&&n.setAttribute("nonce",a),r.head.appendChild(n)}},[])},Vi=function(t){var r=t.className,n=t.colorModel,a=t.color,s=a===void 0?n.defaultColor:a,i=t.onChange,o=nn(t,["className","colorModel","color","onChange"]),l=j.useRef(null);Bi(l);var g=Hi(n,s,i),c=g[0],h=g[1],d=It(["react-colorful",r]);return H.createElement("div",Ye({},o,{ref:l,className:d}),H.createElement(Ai,{hsva:c,onChange:h}),H.createElement(Li,{hue:c.h,onChange:h,className:"react-colorful__last-control"}))},qi={defaultColor:"000",toHsva:Oi,fromHsva:function(t){return Pi({h:t.h,s:t.s,v:t.v,a:1})},equal:Fi},Ot=function(t){return H.createElement(Vi,Ye({},t,{colorModel:qi}))};const F=({label:t,children:r})=>e.jsxs("div",{className:"grid grid-cols-3 items-center gap-2 mb-2",children:[e.jsx(T,{className:"col-span-1 text-xs text-muted-foreground truncate",title:t,children:t}),e.jsx("div",{className:"col-span-2",children:r})]}),he=({value:t,onChange:r,onClear:n})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(He,{children:[e.jsx(Ue,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:"h-8 flex-grow justify-start px-2",style:{backgroundColor:t||"transparent"},children:[e.jsx("div",{className:"w-4 h-4 rounded-sm border border-gray-400 mr-2",style:{backgroundColor:t||"white"}}),e.jsx("span",{className:"text-xs",children:t||"Nenhuma"})]})}),e.jsx($e,{className:"w-auto p-0 border-none",children:e.jsx(Ot,{color:t||"#ffffff",onChange:r})})]}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:n,children:e.jsx(jr,{size:16})})]}),er=({label:t,valueTop:r,valueRight:n,valueBottom:a,valueLeft:s,onChange:i})=>{const o=(l,g)=>{const c=parseInt(g)||0;i(l,`${c}px`)};return e.jsxs("div",{children:[e.jsx(T,{className:"text-xs text-muted-foreground mb-1 block",children:t}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx(R,{type:"number",placeholder:"Topo",value:parseInt(r)||"",onChange:l=>o("Top",l.target.value),className:"h-8"}),e.jsx(R,{type:"number",placeholder:"Direita",value:parseInt(n)||"",onChange:l=>o("Right",l.target.value),className:"h-8"}),e.jsx(R,{type:"number",placeholder:"Fundo",value:parseInt(a)||"",onChange:l=>o("Bottom",l.target.value),className:"h-8"}),e.jsx(R,{type:"number",placeholder:"Esquerda",value:parseInt(s)||"",onChange:l=>o("Left",l.target.value),className:"h-8"})]})]})},Re=({value:t,onChange:r,unit:n="px"})=>{const a=parseFloat(t)||0;return e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{type:"number",value:a,onChange:s=>r(`${s.target.value}${n}`),className:"h-8 w-16"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:n})]})},Wi=({selectedBlock:t,updateBlock:r,proposal:n,onUploadComplete:a})=>{const s=t.styles||{},i=t.size||{},{user:o}=ke(),{toast:l}=le(),g=j.useRef(null),c=(u,y)=>{if(!t)return;const E={...t.styles,[u]:y};r(t.id,{styles:E})},h=(u,y)=>{if(!t)return;const E={...t.size,[u]:y};r(t.id,{size:E})},d=(u,y,E)=>{if(!t)return;const w=`${u}${y}`;c(w,E)},f=async u=>{if(!t||!o)return;const y=u.target.files[0];if(!y)return;l({title:"Enviando imagem...",description:"Aguarde um momento."});const E=`${o.id}/${n.id||"new"}/${A()}-${y.name}`,{error:w}=await G.storage.from("propostas").upload(E,y);if(w){l({title:"Erro no upload",description:w.message,variant:"destructive"});return}const{data:{publicUrl:C}}=G.storage.from("propostas").getPublicUrl(E);c("backgroundImage",C),a(),l({title:"Imagem de fundo atualizada!",variant:"success"})},p=()=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-medium mt-4",children:"Texto"}),e.jsx(F,{label:"Cor Texto",children:e.jsx(he,{value:s.color,onChange:u=>c("color",u),onClear:()=>c("color","")})}),e.jsx(F,{label:"Alinhamento",children:e.jsxs(B,{value:s.textAlign||"left",onValueChange:u=>c("textAlign",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"left",children:"Esquerda"}),e.jsx(S,{value:"center",children:"Centro"}),e.jsx(S,{value:"right",children:"Direita"}),e.jsx(S,{value:"justify",children:"Justificado"})]})]})}),e.jsx(F,{label:"Altura Linha",children:e.jsx(Re,{value:s.lineHeight,onChange:u=>c("lineHeight",u),unit:""})}),e.jsx(F,{label:"Espaço Letras",children:e.jsx(Re,{value:s.letterSpacing,onChange:u=>c("letterSpacing",u)})})]}),m=()=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-medium mt-4",children:"Imagem"}),e.jsx(F,{label:"Ajuste",children:e.jsxs(B,{value:s.objectFit||"cover",onValueChange:u=>c("objectFit",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"cover",children:"Cobrir"}),e.jsx(S,{value:"contain",children:"Conter"}),e.jsx(S,{value:"fill",children:"Preencher"}),e.jsx(S,{value:"none",children:"Nenhum"})]})]})}),e.jsx(F,{label:"Posição",children:e.jsx(R,{value:s.objectPosition||"center",onChange:u=>c("objectPosition",u.target.value),placeholder:"ex: 50% 50%"})})]}),v=()=>e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-medium mt-4",children:"Botão"}),e.jsx(F,{label:"Cor Texto",children:e.jsx(he,{value:s.color,onChange:u=>c("color",u),onClear:()=>c("color","")})}),e.jsx(F,{label:"Alinhamento",children:e.jsxs(B,{value:s.textAlign||"center",onValueChange:u=>c("textAlign",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"left",children:"Esquerda"}),e.jsx(S,{value:"center",children:"Centro"}),e.jsx(S,{value:"right",children:"Direita"})]})]})}),e.jsx("p",{className:"text-sm font-medium mt-4",children:"Hover (Mouse Over)"}),e.jsx(F,{label:"Cor Fundo",children:e.jsx(he,{value:s.hoverBackgroundColor,onChange:u=>c("hoverBackgroundColor",u),onClear:()=>c("hoverBackgroundColor","")})}),e.jsx(F,{label:"Cor Texto",children:e.jsx(he,{value:s.hoverColor,onChange:u=>c("hoverColor",u),onClear:()=>c("hoverColor","")})}),e.jsx(F,{label:"Escala",children:e.jsx(R,{type:"number",step:"0.05",value:s.hoverScale||1,onChange:u=>c("hoverScale",parseFloat(u.target.value))})})]});return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"Layout"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:"Largura Total"}),e.jsx(Ce,{checked:s.fullWidth??!1,onCheckedChange:u=>c("fullWidth",u)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:"Altura Automática"}),e.jsx(Ce,{checked:i.height==="auto",onCheckedChange:u=>h("height",u?"auto":"20%")})]}),e.jsx("p",{className:"text-sm font-medium mt-4",children:"Espaçamento"}),e.jsx(er,{label:"Preenchimento (Padding)",valueTop:s.paddingTop,valueRight:s.paddingRight,valueBottom:s.paddingBottom,valueLeft:s.paddingLeft,onChange:(u,y)=>d("padding",u,y)}),e.jsx(er,{label:"Margem (Margin)",valueTop:s.marginTop,valueRight:s.marginRight,valueBottom:s.marginBottom,valueLeft:s.marginLeft,onChange:(u,y)=>d("margin",u,y)}),t.type==="text"&&p(),t.type==="image"&&m(),t.type==="button"&&v(),t.type!=="pdf"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm font-medium mt-4",children:"Fundo"}),e.jsx(F,{label:"Cor Fundo",children:e.jsx(he,{value:s.backgroundColor,onChange:u=>c("backgroundColor",u),onClear:()=>c("backgroundColor","")})}),e.jsx(F,{label:"Opacidade Fundo",children:e.jsx(ue,{value:[s.backgroundOpacity??1],max:1,step:.05,onValueChange:([u])=>c("backgroundOpacity",u)})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:"Imagem de Fundo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{type:"text",placeholder:"URL da imagem",value:s.backgroundImage||"",onChange:u=>c("backgroundImage",u.target.value)}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>g.current.click(),children:e.jsx(be,{size:16})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>c("backgroundImage",""),children:e.jsx(oe,{size:16})}),e.jsx(R,{type:"file",ref:g,onChange:f,className:"hidden",accept:"image/*"})]})]}),s.backgroundImage&&e.jsxs("div",{className:"space-y-4 border-t pt-4 mt-4",children:[e.jsx(F,{label:"Posição",children:e.jsxs(B,{value:s.backgroundPosition||"center",onValueChange:u=>c("backgroundPosition",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"left top",children:"Topo Esquerda"}),e.jsx(S,{value:"center top",children:"Topo Centro"}),e.jsx(S,{value:"right top",children:"Topo Direita"}),e.jsx(S,{value:"left center",children:"Meio Esquerda"}),e.jsx(S,{value:"center center",children:"Centro"}),e.jsx(S,{value:"right center",children:"Meio Direita"}),e.jsx(S,{value:"left bottom",children:"Fundo Esquerda"}),e.jsx(S,{value:"center bottom",children:"Fundo Centro"}),e.jsx(S,{value:"right bottom",children:"Fundo Direita"})]})]})}),e.jsx(F,{label:"Tamanho",children:e.jsxs(B,{value:s.backgroundSize||"cover",onValueChange:u=>c("backgroundSize",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"cover",children:"Cobrir"}),e.jsx(S,{value:"contain",children:"Conter"}),e.jsx(S,{value:"auto",children:"Original"})]})]})}),e.jsx(F,{label:"Repetir",children:e.jsxs(B,{value:s.backgroundRepeat||"no-repeat",onValueChange:u=>c("backgroundRepeat",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"no-repeat",children:"Não Repetir"}),e.jsx(S,{value:"repeat",children:"Repetir"}),e.jsx(S,{value:"repeat-x",children:"Repetir X"}),e.jsx(S,{value:"repeat-y",children:"Repetir Y"})]})]})}),e.jsx(F,{label:"Rolagem",children:e.jsxs(B,{value:s.backgroundAttachment||"scroll",onValueChange:u=>c("backgroundAttachment",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"scroll",children:"Rolar com a página"}),e.jsx(S,{value:"fixed",children:"Fixo (Parallax)"})]})]})}),e.jsx("p",{className:"text-sm font-medium mt-4",children:"Overlay de Cor"}),e.jsx(F,{label:"Cor",children:e.jsx(he,{value:s.overlayColor,onChange:u=>c("overlayColor",u),onClear:()=>c("overlayColor","")})}),e.jsx(F,{label:"Opacidade",children:e.jsx(ue,{value:[s.overlayOpacity||.3],max:1,step:.05,onValueChange:([u])=>c("overlayOpacity",u)})})]})]}),e.jsx("p",{className:"text-sm font-medium mt-4",children:"Borda"}),e.jsx(F,{label:"Cor",children:e.jsx(he,{value:s.borderColor,onChange:u=>c("borderColor",u),onClear:()=>c("borderColor","")})}),e.jsx(F,{label:"Largura",children:e.jsx(Re,{value:s.borderWidth,onChange:u=>c("borderWidth",u)})}),e.jsx(F,{label:"Estilo",children:e.jsxs(B,{value:s.borderStyle||"none",onValueChange:u=>c("borderStyle",u),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"none",children:"Nenhum"}),e.jsx(S,{value:"solid",children:"Sólido"}),e.jsx(S,{value:"dashed",children:"Tracejado"}),e.jsx(S,{value:"dotted",children:"Pontilhado"})]})]})}),e.jsx(F,{label:"Raio da Borda",children:e.jsx(Re,{value:s.borderRadius,onChange:u=>c("borderRadius",u)})})]})},Gi=({selectedBlock:t,updateBlock:r})=>{const n=t.animation||{},a=(o,l)=>{if(!t)return;const g={...t.visibility,[o]:l};r(t.id,{visibility:g})},s=o=>{if(!t)return;const l=t.styles?.zIndex||0;let g;o===1/0?g=999:o===-1/0?g=0:g=Math.max(0,l+o),r(t.id,{styles:{...t.styles,zIndex:g}})},i=(o,l)=>{if(!t)return;const g={...t.animation,[o]:l};r(t.id,{animation:g})};return e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-sm font-medium",children:"Camadas (Z-index)"}),e.jsx(St,{children:e.jsxs("div",{className:"flex items-center justify-between gap-1",children:[e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"outline",size:"icon",className:"flex-1",onClick:()=>s(-1/0),children:e.jsx(Nr,{size:16})})}),e.jsx(ae,{children:"Mover para o fundo"})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"outline",size:"icon",className:"flex-1",onClick:()=>s(-1),children:e.jsx(it,{size:16})})}),e.jsx(ae,{children:"Mover para trás"})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"outline",size:"icon",className:"flex-1",onClick:()=>s(1),children:e.jsx(dt,{size:16})})}),e.jsx(ae,{children:"Mover para frente"})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"outline",size:"icon",className:"flex-1",onClick:()=>s(1/0),children:e.jsx(we,{size:16})})}),e.jsx(ae,{children:"Mover para o topo"})]})]})}),e.jsx("p",{className:"text-sm font-medium pt-4",children:"Animação de Entrada"}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-2 mb-2",children:[e.jsx(T,{className:"col-span-1 text-xs text-muted-foreground",children:"Tipo"}),e.jsx("div",{className:"col-span-2",children:e.jsxs(B,{value:n.type||"none",onValueChange:o=>i("type",o),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"none",children:"Nenhuma"}),e.jsx(S,{value:"fadeIn",children:"Fade In"}),e.jsx(S,{value:"slideInUp",children:"Slide In Up"}),e.jsx(S,{value:"slideInDown",children:"Slide In Down"}),e.jsx(S,{value:"slideInLeft",children:"Slide In Left"}),e.jsx(S,{value:"slideInRight",children:"Slide In Right"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-2 mb-2",children:[e.jsx(T,{className:"col-span-1 text-xs text-muted-foreground",children:"Duração (s)"}),e.jsx("div",{className:"col-span-2",children:e.jsx(R,{type:"number",step:"0.1",value:n.duration||.5,onChange:o=>i("duration",parseFloat(o.target.value))})})]}),e.jsxs("div",{className:"grid grid-cols-3 items-center gap-2 mb-2",children:[e.jsx(T,{className:"col-span-1 text-xs text-muted-foreground",children:"Atraso (s)"}),e.jsx("div",{className:"col-span-2",children:e.jsx(R,{type:"number",step:"0.1",value:n.delay||0,onChange:o=>i("delay",parseFloat(o.target.value))})})]}),e.jsx("p",{className:"text-sm font-medium pt-4",children:"Visibilidade Responsiva"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:"Desktop"}),e.jsx(Ce,{checked:t.visibility?.desktop??!0,onCheckedChange:o=>a("desktop",o)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:"Tablet"}),e.jsx(Ce,{checked:t.visibility?.tablet??!0,onCheckedChange:o=>a("tablet",o)})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(T,{children:"Mobile"}),e.jsx(Ce,{checked:t.visibility?.mobile??!0,onCheckedChange:o=>a("mobile",o)})]})]})},de=({label:t,children:r})=>e.jsxs("div",{className:"grid grid-cols-3 items-center gap-2 mb-2",children:[e.jsx(T,{className:"col-span-1 text-xs text-muted-foreground truncate",title:t,children:t}),e.jsx("div",{className:"col-span-2",children:r})]}),tr=({value:t,onChange:r,onClear:n})=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(He,{children:[e.jsx(Ue,{asChild:!0,children:e.jsxs(N,{variant:"outline",className:"h-8 flex-grow justify-start px-2",style:{backgroundColor:t||"transparent"},children:[e.jsx("div",{className:"w-4 h-4 rounded-sm border border-gray-400 mr-2",style:{backgroundColor:t||"white"}}),e.jsx("span",{className:"text-xs",children:t||"Nenhuma"})]})}),e.jsx($e,{className:"w-auto p-0 border-none",children:e.jsx(Ot,{color:t||"#ffffff",onChange:r})})]}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:n,children:e.jsx(jr,{size:16})})]}),Xi=({selectedSection:t,setProposal:r,proposal:n,onUploadComplete:a,viewMode:s})=>{const i=t.styles||{},{user:o}=ke(),{toast:l}=le(),g=j.useRef(null),c=j.useMemo(()=>s!=="desktop"&&t.layouts?.[s]?.height?t.layouts[s].height:t.height||500,[t,s]),h=(p,m)=>{if(!t)return;let v={...t.styles,[p]:m};p==="backgroundImage"&&m&&(v.zIndex=0),r(u=>({...u,sections:u.sections.map(y=>y.id===t.id?{...y,styles:v}:y)}))},d=p=>{if(!t)return;const m=parseInt(p)||500;r(v=>({...v,sections:v.sections.map(u=>{if(u.id!==t.id)return u;const y={...u};return s==="desktop"?y.height=m:(y.layouts||(y.layouts={}),y.layouts[s]||(y.layouts[s]={}),y.layouts[s].height=m),y})}))},f=async p=>{if(!t||!o)return;const m=p.target.files[0];if(!m)return;l({title:"Enviando imagem...",description:"Aguarde um momento."});const v=`${o.id}/${n.id||"new"}/${A()}-${m.name}`,{error:u}=await G.storage.from("propostas").upload(v,m);if(u){l({title:"Erro no upload",description:u.message,variant:"destructive"});return}const{data:{publicUrl:y}}=G.storage.from("propostas").getPublicUrl(v);h("backgroundImage",y),a&&a(),l({title:"Imagem de fundo atualizada!",variant:"success"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-sm font-medium mt-4",children:["Dimensões da Seção (",s,")"]}),e.jsx(de,{label:"Altura (px)",children:e.jsx(R,{type:"number",value:c,onChange:p=>d(p.target.value),min:"100"})}),e.jsx("p",{className:"text-sm font-medium mt-4",children:"Fundo da Seção"}),e.jsx(de,{label:"Cor Fundo",children:e.jsx(tr,{value:i.backgroundColor,onChange:p=>h("backgroundColor",p),onClear:()=>h("backgroundColor","")})}),e.jsx(de,{label:"Opacidade Fundo",children:e.jsx(ue,{value:[i.backgroundOpacity??1],max:1,step:.05,onValueChange:([p])=>h("backgroundOpacity",p)})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:"Imagem de Fundo"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{type:"text",placeholder:"URL da imagem",value:(i.backgroundImage||"").replace(/url\((['"]?)(.*?)\1\)/,"$2"),onChange:p=>h("backgroundImage",p.target.value)}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>g.current.click(),children:e.jsx(be,{size:16})}),e.jsx(N,{variant:"ghost",size:"icon",onClick:()=>h("backgroundImage",""),children:e.jsx(oe,{size:16})}),e.jsx(R,{type:"file",ref:g,onChange:f,className:"hidden",accept:"image/*"})]})]}),i.backgroundImage&&e.jsxs("div",{className:"space-y-4 border-t pt-4 mt-4",children:[e.jsx(de,{label:"Posição",children:e.jsxs(B,{value:i.backgroundPosition||"center",onValueChange:p=>h("backgroundPosition",p),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"left top",children:"Topo Esquerda"}),e.jsx(S,{value:"center top",children:"Topo Centro"}),e.jsx(S,{value:"right top",children:"Topo Direita"}),e.jsx(S,{value:"left center",children:"Meio Esquerda"}),e.jsx(S,{value:"center center",children:"Centro"}),e.jsx(S,{value:"right center",children:"Meio Direita"}),e.jsx(S,{value:"left bottom",children:"Fundo Esquerda"}),e.jsx(S,{value:"center bottom",children:"Fundo Centro"}),e.jsx(S,{value:"right bottom",children:"Fundo Direita"})]})]})}),e.jsx(de,{label:"Tamanho",children:e.jsxs(B,{value:i.backgroundSize||"cover",onValueChange:p=>h("backgroundSize",p),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"cover",children:"Cobrir"}),e.jsx(S,{value:"contain",children:"Conter"}),e.jsx(S,{value:"auto",children:"Original"})]})]})}),e.jsx(de,{label:"Repetir",children:e.jsxs(B,{value:i.backgroundRepeat||"no-repeat",onValueChange:p=>h("backgroundRepeat",p),children:[e.jsx(V,{children:e.jsx(q,{})}),e.jsxs(W,{children:[e.jsx(S,{value:"no-repeat",children:"Não Repetir"}),e.jsx(S,{value:"repeat",children:"Repetir"}),e.jsx(S,{value:"repeat-x",children:"Repetir X"}),e.jsx(S,{value:"repeat-y",children:"Repetir Y"})]})]})}),e.jsx("p",{className:"text-sm font-medium mt-4",children:"Overlay de Cor"}),e.jsx(de,{label:"Cor",children:e.jsx(tr,{value:i.overlayColor,onChange:p=>h("overlayColor",p),onClear:()=>h("overlayColor","")})}),e.jsx(de,{label:"Opacidade",children:e.jsx(ue,{value:[i.overlayOpacity||.3],max:1,step:.05,onValueChange:([p])=>h("overlayOpacity",p)})})]})]})},rr={text:e.jsx(Sr,{size:16}),image:e.jsx(Fe,{size:16}),default:e.jsx("div",{className:"w-4 h-4 bg-gray-300 rounded-sm"})},Yi=({block:t,index:r,selectedBlockId:n,setSelectedBlock:a,toggleVisibility:s,toggleLock:i,deleteBlock:o,updateBlockContent:l})=>{const[g,c]=j.useState(!1),[h,d]=j.useState(t.content?.text||""),f=()=>{t.type==="text"&&c(!0)},p=u=>{d(u.target.value)},m=()=>{c(!1),l(t.id,{text:h})},v=u=>{u.key==="Enter"&&m()};return e.jsx($n,{draggableId:t.id,index:r,children:(u,y)=>e.jsxs("div",{ref:u.innerRef,...u.draggableProps,className:Ee("flex items-center gap-2 p-2 rounded-md bg-muted/50 border border-transparent",y.isDragging&&"bg-primary/10",n===t.id&&"border-primary"),onClick:()=>a(t),onDoubleClick:f,children:[e.jsx("div",{...u.dragHandleProps,className:"cursor-grab text-muted-foreground hover:text-foreground",children:e.jsx(Yn,{size:16})}),e.jsx("div",{className:"flex-shrink-0 text-muted-foreground",children:rr[t.type]||rr.default}),g?e.jsx(R,{value:h,onChange:p,onBlur:m,onKeyDown:v,autoFocus:!0,className:"h-7 text-sm flex-grow bg-background"}):e.jsx("span",{className:"flex-grow text-sm truncate",children:t.content?.text||t.type}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:E=>{E.stopPropagation(),o(t.id)},children:e.jsx(oe,{size:14,className:"text-muted-foreground hover:text-destructive"})})}),e.jsx(ae,{children:e.jsx("p",{children:"Excluir"})})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:E=>{E.stopPropagation(),i(t.id)},children:t.locked?e.jsx(or,{size:14,className:"text-destructive"}):e.jsx(Tr,{size:14})})}),e.jsx(ae,{children:e.jsx("p",{children:t.locked?"Desbloquear":"Bloquear"})})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:E=>{E.stopPropagation(),s(t.id)},children:t.visible??!0?e.jsx(br,{size:14}):e.jsx(Kn,{size:14,className:"text-muted-foreground"})})}),e.jsx(ae,{children:e.jsx("p",{children:t.visible??!0?"Ocultar":"Mostrar"})})]})]})},t.id)},Ki=({sectionId:t,proposal:r,setProposal:n,setSelectedBlock:a,selectedBlockId:s})=>{const i=(r.blocksBySection[t]||[]).sort((h,d)=>(d.styles?.zIndex||0)-(h.styles?.zIndex||0)),o=h=>{if(!h.destination)return;const d=Array.from(i),[f]=d.splice(h.source.index,1);d.splice(h.destination.index,0,f),n(p=>{const m=[...p.blocksBySection[t]];return d.reverse().forEach((v,u)=>{const y=m.find(E=>E.id===v.id);y&&(y.styles={...y.styles,zIndex:u})}),{...p,blocksBySection:{...p.blocksBySection,[t]:m}}})},l=(h,d,f)=>{n(p=>{const m=p.blocksBySection[t].map(v=>v.id===h?{...v,[d]:f}:v);return{...p,blocksBySection:{...p.blocksBySection,[t]:m}}})},g=(h,d)=>{n(f=>{const p=f.blocksBySection[t].map(m=>m.id===h?{...m,content:{...m.content,...d}}:m);return{...f,blocksBySection:{...f.blocksBySection,[t]:p}}})},c=h=>{n(d=>{const f=d.blocksBySection[t].filter(p=>p.id!==h);return s===h&&a(null),{...d,blocksBySection:{...d.blocksBySection,[t]:f}}})};return e.jsx(Hn,{onDragEnd:o,children:e.jsx(Un,{droppableId:"layers",children:h=>e.jsx("div",{...h.droppableProps,ref:h.innerRef,className:"space-y-1",children:e.jsxs(St,{children:[i.map((d,f)=>e.jsx(Yi,{block:d,index:f,selectedBlockId:s,setSelectedBlock:a,toggleVisibility:p=>l(p,"visible",!(d.visible??!0)),toggleLock:p=>l(p,"locked",!d.locked),deleteBlock:c,updateBlockContent:g},d.id)),h.placeholder]})})})})},Qi={text:"Texto",image:"Imagem",video:"Vídeo",button:"Botão",divider:"Divisor",spacer:"Espaçador",cover:"Capa",packages:"Pacotes",testimonial:"Depoimento",faq:"FAQ",cta:"Chamada à Ação",social:"Redes Sociais",section:"Seção"},Wo=({selectedBlock:t,updateBlock:r,setSelectedBlock:n,globalStyles:a,setGlobalStyles:s,showGrid:i,setShowGrid:o,proposal:l,setProposal:g,isAdmin:c,onToggle:h,onUploadComplete:d,viewMode:f})=>{const[p,m]=j.useState("style");H.useEffect(()=>{t&&t.type==="section"?m(p):t&&m("style")},[t?.id]);const v=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold capitalize",children:Qi[t.type]||"Bloco"}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:h,children:e.jsx(Mt,{size:16})})]}),e.jsxs(lt,{defaultValue:"style",className:"flex-1 flex flex-col",children:[e.jsxs(ct,{className:"grid w-full grid-cols-3",children:[e.jsxs(pe,{value:"content",children:[e.jsx(Sr,{className:"w-4 h-4 mr-1"})," Conteúdo"]}),e.jsxs(pe,{value:"style",children:[e.jsx(Dr,{className:"w-4 h-4 mr-1"})," Estilo"]}),e.jsxs(pe,{value:"advanced",children:[e.jsx(At,{className:"w-4 h-4 mr-1"})," Avançado"]})]}),e.jsxs(Ae,{className:"flex-1 mt-4 -mr-4 pr-4",children:[e.jsx(fe,{value:"style",className:"space-y-4",children:e.jsx(Wi,{selectedBlock:t,updateBlock:r,proposal:l,onUploadComplete:d})}),e.jsx(fe,{value:"content",className:"space-y-4",children:e.jsx(hi,{selectedBlock:t,updateBlock:r,isAdmin:c,proposalId:l.id,onUploadComplete:d})}),e.jsx(fe,{value:"advanced",className:"space-y-4",children:e.jsx(Gi,{selectedBlock:t,updateBlock:r})})]})]})]}),u=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold capitalize",children:"Seção"}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:h,children:e.jsx(Mt,{size:16})})]}),e.jsxs(lt,{value:p,onValueChange:m,className:"flex-1 flex flex-col",children:[e.jsxs(ct,{className:"grid w-full grid-cols-2",children:[e.jsxs(pe,{value:"style",children:[e.jsx(At,{className:"w-4 h-4 mr-1"})," Estilo"]}),e.jsxs(pe,{value:"layers",children:[e.jsx(Ss,{className:"w-4 h-4 mr-1"})," Camadas"]})]}),e.jsxs(Ae,{className:"flex-1 mt-4 -mr-4 pr-4",children:[e.jsx(fe,{value:"style",className:"space-y-4",children:e.jsx(Xi,{selectedSection:t,setProposal:g,proposal:l,onUploadComplete:d,viewMode:f})}),e.jsx(fe,{value:"layers",className:"space-y-4",children:e.jsx(Ki,{sectionId:t.id,proposal:l,setProposal:g,setSelectedBlock:n,selectedBlockId:t.id})})]})]})]}),y=()=>t?t.type==="section"?u():v():null;return e.jsx(ge.aside,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"w-80 bg-background border-l p-4 flex flex-col flex-shrink-0 z-40 shadow-lg",children:y()},t?t.id:"global")},nr={SECTION:"section"},Zi=({section:t,index:r,activeSection:n,setActiveSection:a,moveSection:s,duplicateSection:i,deleteSection:o,blocks:l})=>{const g=H.useRef(null),[{handlerId:c},h]=An({accept:nr.SECTION,collect:u=>({handlerId:u.getHandlerId()}),hover:(u,y)=>{!g.current||u.index===r||(s(u.index,r),u.index=r)}}),[{isDragging:d},f]=bt({type:nr.SECTION,item:()=>({id:t.id,index:r}),collect:u=>({isDragging:u.isDragging()})});f(h(g));const p=!!t.styles?.backgroundImage,m=l&&l.length>0,v=()=>p?e.jsx("img",{src:t.styles.backgroundImage,alt:`Preview da Seção ${r+1}`,className:"w-full h-full object-cover"}):m?e.jsx("div",{style:{backgroundColor:t.styles?.backgroundColor||"#FFFFFF",filter:"blur(2px)"},className:"w-full h-full flex items-center justify-center",children:e.jsx(Fe,{className:"w-10 h-10 text-muted-foreground/50"})}):e.jsx("div",{style:{backgroundColor:t.styles?.backgroundColor||"#FFFFFF",filter:"blur(2px)"},className:"w-full h-full"});return e.jsxs("div",{ref:g,"data-handler-id":c,style:{opacity:d?.5:1},className:Ee("relative group flex-shrink-0 w-28 h-36 border-2 bg-background cursor-pointer flex flex-col items-center justify-center transition-all overflow-hidden",n===t.id?"border-primary":"border-border hover:border-primary/50"),onClick:()=>a(t.id),children:[v(),e.jsx("div",{className:"absolute inset-0 bg-black/10"}),e.jsxs("span",{className:"relative text-xs text-white font-bold z-10 bg-black/50 px-2 py-1 rounded",children:["Seção ",r+1]}),e.jsxs("div",{className:"absolute top-1 right-1 opacity-0 group-hover:opacity-100 transition-opacity flex flex-col gap-1 z-20",children:[e.jsx(N,{variant:"ghost",size:"icon",className:"h-6 w-6 bg-white/80 hover:bg-white",onClick:u=>{u.stopPropagation(),i(t.id)},children:e.jsx(Cr,{size:12})}),e.jsxs(ur,{children:[e.jsx(hr,{asChild:!0,children:e.jsx(N,{variant:"destructive",size:"icon",className:"h-6 w-6",onClick:u=>u.stopPropagation(),children:e.jsx(oe,{size:12})})}),e.jsxs(pr,{children:[e.jsxs(fr,{children:[e.jsx(gr,{children:"Excluir seção?"}),e.jsx(mr,{children:"Esta ação não pode ser desfeita. Isso excluirá permanentemente a seção e todo o seu conteúdo."})]}),e.jsxs(xr,{children:[e.jsx(vr,{children:"Cancelar"}),e.jsx(yr,{onClick:()=>o(t.id),children:"Excluir"})]})]})]})]})]})},Go=({sections:t=[],activeSection:r,setActiveSection:n,setProposal:a,proposal:s})=>{const[i,o]=j.useState(!1),l=()=>{a(d=>{const f={id:A(),name:`Seção ${d.sections.length+1}`,styles:{}};return{...d,sections:[...d.sections,f],blocksBySection:{...d.blocksBySection,[f.id]:[]}}})},g=d=>{a(f=>{const p=f.sections.find(w=>w.id===d),m=f.blocksBySection[d]||[];if(!p)return f;const v={...Z.cloneDeep(p),id:A()},u=Z.cloneDeep(m).map(w=>({...w,id:A()})),y=f.sections.findIndex(w=>w.id===d),E=[...f.sections];return E.splice(y+1,0,v),{...f,sections:E,blocksBySection:{...f.blocksBySection,[v.id]:u}}})},c=d=>{t.length<=1||a(f=>{const p=f.sections.filter(v=>v.id!==d),m={...f.blocksBySection};return delete m[d],r===d&&n(p[0]?.id||null),{...f,sections:p,blocksBySection:m}})},h=(d,f)=>{a(p=>{const m=[...p.sections],[v]=m.splice(d,1);return m.splice(f,0,v),{...p,sections:m}})};return e.jsxs(ge.div,{className:"fixed bottom-0 left-1/2 -translate-x-1/2 z-50",onHoverStart:()=>o(!0),onHoverEnd:()=>o(!1),children:[e.jsx(lr,{children:i&&e.jsxs(ge.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"bg-background/80 backdrop-blur-sm border-t border-x rounded-t-lg p-2 flex items-center gap-4 w-auto max-w-[90vw] overflow-x-auto",children:[t.map((d,f)=>e.jsx(Zi,{section:d,index:f,activeSection:r,setActiveSection:n,moveSection:h,duplicateSection:g,deleteSection:c,blocks:s.blocksBySection[d.id]||[]},d.id)),e.jsxs(N,{variant:"outline",className:"flex-shrink-0",onClick:l,children:[e.jsx(ot,{className:"mr-2 h-4 w-4"})," Adicionar Seção"]})]})}),e.jsxs(ge.div,{initial:!1,animate:{y:i?20:0,opacity:i?0:1},className:"bg-background/80 backdrop-blur-sm border-t border-x rounded-t-lg p-1 flex items-center gap-2",children:[e.jsxs(N,{variant:"ghost",size:"sm",onClick:()=>o(!0),children:[e.jsx(we,{className:"h-4 w-4 mr-2"}),"Seções (",t.length,")"]}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:l,children:e.jsx(ot,{className:"h-4 w-4"})})]})]})},Xo=({navigateBack:t,viewMode:r,setViewMode:n,handleExportPdf:a,handleSave:s,handlePublish:i,saving:o,saveStatus:l,isAdmin:g,proposal:c})=>{const{toast:h}=le(),d=c?.id,f=!d,p=()=>{if(f||!d){h({title:"Salve para visualizar",description:"Você precisa salvar a proposta antes de poder visualizá-la.",variant:"destructive"});return}const m=`${window.location.origin}/studio/view/${d}`;window.open(m,"_blank")};return e.jsxs("header",{className:"bg-background border-b p-2 flex items-center justify-between flex-shrink-0 z-30",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:"ghost",size:"icon",onClick:t,children:e.jsx(Qn,{})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-lg font-semibold",children:c?.nome_da_proposta||"Nova Proposta"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:l})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{variant:r==="mobile"?"secondary":"ghost",size:"icon",onClick:()=>n("mobile"),children:e.jsx(Ds,{})}),e.jsx(N,{variant:r==="tablet"?"secondary":"ghost",size:"icon",onClick:()=>n("tablet"),children:e.jsx(Es,{})}),e.jsx(N,{variant:r==="desktop"?"secondary":"ghost",size:"icon",onClick:()=>n("desktop"),children:e.jsx(Cs,{})})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(N,{variant:"outline",onClick:p,disabled:o||!c?.is_published,children:[e.jsx(br,{className:"w-4 h-4 mr-2"}),"Visualizar"]}),e.jsxs(N,{variant:"outline",onClick:a,disabled:o,children:[e.jsx(En,{className:"w-4 h-4 mr-2"}),"PDF"]}),e.jsxs(N,{onClick:()=>s(),disabled:o,children:[e.jsx(Tn,{className:"w-4 h-4 mr-2"}),o?"Salvando...":"Salvar"]}),e.jsxs(N,{onClick:i,disabled:o,children:[e.jsx(kn,{className:"w-4 h-4 mr-2"}),o?"Publicando...":c?.is_published?"Republicar":"Publicar"]})]})]})},Ji=({selectedBlock:t,updateBlock:r})=>{const{toast:n}=le();if(!t||t.type!=="text")return null;const a=t.styles||{},s=(c,h)=>{r(t.id,{styles:{...t.styles,[c]:h}})},i=c=>{const h=parseInt(a.fontSize)||16;s("fontSize",`${Math.max(1,h+c)}px`)},o=(c,h,d)=>{const f=a[c]===h;s(c,f?d:h)},l=c=>{const h=(a.textDecoration||"").split(" ").filter(p=>p),f=h.includes(c)?h.filter(p=>p!==c):[...h,c];s("textDecoration",f.join(" ").trim())},g=()=>{n({title:"🚧 Funcionalidade em desenvolvimento",description:"Esta opção estará disponível em breve!"})};return e.jsx(St,{children:e.jsxs("div",{className:"bg-background rounded-lg shadow-md p-1 flex items-center gap-1 border",children:[e.jsxs(B,{value:a.fontFamily||"Inter",onValueChange:c=>s("fontFamily",c),children:[e.jsx(V,{className:"w-32 h-8 text-xs",children:e.jsx(q,{})}),e.jsx(W,{children:di.map(c=>e.jsx(S,{value:c.value,style:{fontFamily:c.label},children:c.label},c.value))})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>i(-1),children:e.jsx(cr,{size:14})}),e.jsx(R,{type:"number",value:parseInt(a.fontSize)||16,onChange:c=>s("fontSize",`${Math.max(1,parseInt(c.target.value)||0)}px`),className:"w-12 h-8 text-center"}),e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>i(1),children:e.jsx(ot,{size:14})})]}),e.jsxs(He,{children:[e.jsx(Ue,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(ds,{size:14,style:{color:a.color||"#000000"}})})}),e.jsx($e,{className:"w-auto p-0 border-0",children:e.jsx(Ot,{color:a.color||"#333333",onChange:c=>s("color",c)})})]}),e.jsx("div",{className:"h-6 border-l mx-1"}),e.jsx(N,{variant:a.fontWeight==="bold"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>o("fontWeight","bold","normal"),children:e.jsx(es,{size:14})}),e.jsx(N,{variant:a.fontStyle==="italic"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>o("fontStyle","italic","normal"),children:e.jsx(ts,{size:14})}),e.jsx(N,{variant:a.textDecoration?.includes("underline")?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>l("underline"),children:e.jsx(rs,{size:14})}),e.jsx(N,{variant:a.textDecoration?.includes("line-through")?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>l("line-through"),children:e.jsx(ns,{size:14})}),e.jsx("div",{className:"h-6 border-l mx-1"}),e.jsx(N,{variant:a.textAlign==="left"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>s("textAlign","left"),children:e.jsx(ss,{size:14})}),e.jsx(N,{variant:a.textAlign==="center"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>s("textAlign","center"),children:e.jsx(as,{size:14})}),e.jsx(N,{variant:a.textAlign==="right"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>s("textAlign","right"),children:e.jsx(is,{size:14})}),e.jsx(N,{variant:a.textAlign==="justify"?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:()=>s("textAlign","justify"),children:e.jsx(us,{size:14})}),e.jsx("div",{className:"h-6 border-l mx-1"}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:g,children:e.jsx(hs,{size:14})})}),e.jsx(ae,{children:e.jsx("p",{children:"Lista com marcadores"})})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:g,children:e.jsx(os,{size:14})})}),e.jsx(ae,{children:e.jsx("p",{children:"Lista numerada"})})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:g,children:e.jsx(Ts,{size:14})})}),e.jsx(ae,{children:e.jsx("p",{children:"Espaçamento"})})]}),e.jsx("div",{className:"h-6 border-l mx-1"}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:g,children:e.jsx(In,{size:14})})}),e.jsx(ae,{children:e.jsx("p",{children:"Efeitos"})})]}),e.jsxs(ne,{children:[e.jsx(se,{asChild:!0,children:e.jsx(N,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:g,children:e.jsx(Dr,{size:14})})}),e.jsx(ae,{children:e.jsx("p",{children:"Animar"})})]})]})})},eo=({selectedBlock:t,updateBlock:r,onUploadComplete:n,proposalId:a,user:s})=>{le();const i=H.useRef(null);if(!t||t.type!=="image")return null;const o={brightness:t.styles?.brightness||100,contrast:t.styles?.contrast||100,saturate:t.styles?.saturate||100},l=(h,d)=>{const f={...o,[h]:d},p=`brightness(${f.brightness}%) contrast(${f.contrast}%) saturate(${f.saturate}%)`;r(t.id,{styles:{...t.styles,filter:p,brightness:f.brightness,contrast:f.contrast,saturate:f.saturate}})},g=h=>{const d=t.styles?.transform||"";let f;h==="horizontal"?f=d.includes("scaleX(-1)")?d.replace("scaleX(-1)","").trim():`${d} scaleX(-1)`.trim():f=d.includes("scaleY(-1)")?d.replace("scaleY(-1)","").trim():`${d} scaleY(-1)`.trim(),r(t.id,{styles:{...t.styles,transform:f}})},c=()=>{i.current?.click()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-background rounded-lg shadow-md p-1 flex items-center gap-1 border",children:[e.jsxs(N,{variant:"ghost",size:"sm",onClick:c,children:[e.jsx(Ns,{size:16,className:"mr-2"})," Alterar Imagem"]}),e.jsx("div",{className:"h-6 border-l mx-1"}),e.jsxs(He,{children:[e.jsx(Ue,{asChild:!0,children:e.jsxs(N,{variant:"ghost",size:"sm",children:[e.jsx(gs,{size:16,className:"mr-2"})," Editar Imagem"]})}),e.jsxs($e,{className:"w-64 p-4 space-y-4",children:[e.jsx("h4",{className:"font-medium leading-none",children:"Edição Rápida"}),e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(N,{variant:"outline",onClick:()=>g("horizontal"),children:[e.jsx(ys,{size:16,className:"mr-2"})," Horizontal"]}),e.jsxs(N,{variant:"outline",onClick:()=>g("vertical"),children:[e.jsx(js,{size:16,className:"mr-2"})," Vertical"]})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:"Brilho"}),e.jsx(ue,{defaultValue:[o.brightness],max:200,step:1,onValueChange:([h])=>l("brightness",h)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:"Contraste"}),e.jsx(ue,{defaultValue:[o.contrast],max:200,step:1,onValueChange:([h])=>l("contrast",h)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(T,{children:"Saturação"}),e.jsx(ue,{defaultValue:[o.saturate],max:200,step:1,onValueChange:([h])=>l("saturate",h)})]})]})]})]}),e.jsx("input",{type:"file",ref:i,className:"hidden",accept:"image/*",onChange:n})]})},Yo=({selectedBlock:t,updateBlock:r,toolbarPosition:n,onReplaceImage:a})=>e.jsx(lr,{children:t&&!t.locked&&e.jsxs(ge.div,{initial:{y:-10,opacity:0,scale:.95},animate:{y:0,opacity:1,scale:1},exit:{y:-10,opacity:0,scale:.95},transition:{duration:.2},className:"absolute z-40",style:{top:n.top,left:n.left,transform:"translateX(-50%)"},children:[t.type==="text"&&e.jsx(Ji,{selectedBlock:t,updateBlock:r}),t.type==="image"&&e.jsx(eo,{selectedBlock:t,updateBlock:r,onUploadComplete:a})]})}),Q=({children:t,onClick:r,disabled:n=!1,className:a=""})=>e.jsx("button",{onClick:r,disabled:n,className:`w-full text-left px-3 py-1.5 text-sm flex items-center gap-3 rounded-md hover:bg-muted disabled:opacity-50 disabled:cursor-not-allowed ${a}`,children:t}),sr=({children:t,label:r,icon:n})=>e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"w-full text-left px-3 py-1.5 text-sm flex items-center justify-between gap-3 rounded-md hover:bg-muted",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[n,e.jsx("span",{children:r})]}),e.jsx(On,{size:14})]}),e.jsx("div",{className:"absolute left-full top-0 ml-1 w-48 bg-background/80 backdrop-blur-sm border rounded-lg shadow-lg p-1 invisible group-hover:visible",children:t})]}),Ko=({x:t,y:r,block:n,onClose:a,onAction:s,onFileInputClick:i})=>{const o=j.useRef(null),[l,g]=j.useState({width:window.innerWidth,height:window.innerHeight});j.useEffect(()=>{const m=u=>{o.current&&!o.current.contains(u.target)&&a()},v=()=>{g({width:window.innerWidth,height:window.innerHeight})};return document.addEventListener("mousedown",m),window.addEventListener("resize",v),()=>{document.removeEventListener("mousedown",m),window.removeEventListener("resize",v)}},[a]);const c={top:r,left:t};if(o.current){const m=o.current.getBoundingClientRect();t+m.width>l.width&&(c.left=t-m.width),r+m.height>l.height&&(c.top=r-m.height)}const h=n.type==="section",d=n.type==="pdf",f=()=>e.jsxs(e.Fragment,{children:[e.jsxs(Q,{onClick:()=>s("copy",n),children:[e.jsx(Cr,{size:14})," Copiar"]}),e.jsxs(Q,{onClick:()=>s("paste",n),children:[e.jsx(ms,{size:14})," Colar"]}),e.jsxs(Q,{onClick:()=>s("duplicate",n),children:[e.jsx(Ft,{size:14})," Duplicar"]}),e.jsx("div",{className:"my-1 border-t border-border/50"}),!h&&e.jsxs(sr,{label:"Camada",icon:e.jsx(we,{size:14}),children:[e.jsxs(Q,{onClick:()=>s("layer_top",n),children:[e.jsx(we,{size:14})," Trazer para o Topo"]}),e.jsxs(Q,{onClick:()=>s("layer_front",n),children:[e.jsx(dt,{size:14})," Trazer para Frente"]}),e.jsxs(Q,{onClick:()=>s("layer_back",n),children:[e.jsx(it,{size:14})," Enviar para Trás"]}),e.jsxs(Q,{onClick:()=>s("layer_bottom",n),children:[e.jsx(Nr,{size:14})," Enviar para o Fundo"]})]}),!h&&e.jsxs(Q,{onClick:()=>s("toggleLock",n),children:[n.locked?e.jsx(Tr,{size:14}):e.jsx(or,{size:14}),n.locked?"Desbloquear":"Bloquear"]}),e.jsx("div",{className:"my-1 border-t border-border/50"}),e.jsxs(Q,{onClick:()=>s("delete",n),className:"text-destructive",children:[e.jsx(oe,{size:14})," Excluir"]})]}),p=()=>e.jsxs(e.Fragment,{children:[e.jsxs(Q,{onClick:()=>i(),children:[e.jsx(be,{size:14})," Upload/Alterar PDF"]}),e.jsxs(Q,{onClick:()=>s("remove_pdf_src",n),disabled:!n.content.src,children:[e.jsx(vs,{size:14})," Remover PDF"]}),e.jsx("div",{className:"my-1 border-t border-border/50"}),e.jsxs(sr,{label:"Camada",icon:e.jsx(we,{size:14}),children:[e.jsxs(Q,{onClick:()=>s("layer_front",n),children:[e.jsx(dt,{size:14})," Trazer para Frente"]}),e.jsxs(Q,{onClick:()=>s("layer_back",n),children:[e.jsx(it,{size:14})," Enviar para Trás"]})]}),e.jsx("div",{className:"my-1 border-t border-border/50"}),e.jsxs(Q,{onClick:()=>s("duplicate",n),children:[e.jsx(Ft,{size:14})," Duplicar Elemento"]}),e.jsxs(Q,{onClick:()=>s("delete",n),className:"text-destructive",children:[e.jsx(oe,{size:14})," Excluir Elemento"]})]});return e.jsx(ge.div,{ref:o,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.1},style:c,className:"fixed z-[99999] w-56 bg-background/80 backdrop-blur-sm border rounded-lg shadow-xl p-1.5",children:d?p():f()})},ar=({type:t,scrollPos:r,containerSize:n})=>{const a=j.useRef(null),[s,i]=j.useState([]);j.useEffect(()=>{if(!a.current)return;const l=t==="horizontal"?a.current.offsetWidth:a.current.offsetHeight,g=[],c=100,h=10;for(let d=0;d<l+2e3;d+=h)d%c===0?g.push({pos:d,type:"large"}):d%(c/2)===0?g.push({pos:d,type:"medium"}):g.push({pos:d,type:"small"});i(g)},[t,n]);const o=t==="horizontal"?-r.x:-r.y;return e.jsx("div",{ref:a,className:Ee("absolute bg-background text-muted-foreground text-[10px] pointer-events-none",t==="horizontal"?"w-full h-6 top-0 left-0":"h-full w-6 top-0 left-0"),children:e.jsx("div",{className:"relative w-full h-full",style:{transform:t==="horizontal"?`translateX(${o}px)`:`translateY(${o}px)`},children:s.map(l=>e.jsx("div",{className:Ee("absolute bg-muted-foreground",t==="horizontal"?"bottom-0":"right-0",{"h-4 w-px":t==="horizontal"&&l.type==="large","h-2 w-px":t==="horizontal"&&l.type==="medium","h-1 w-px":t==="horizontal"&&l.type==="small","w-4 h-px":t==="vertical"&&l.type==="large","w-2 h-px":t==="vertical"&&l.type==="medium","w-1 h-px":t==="vertical"&&l.type==="small"}),style:t==="horizontal"?{left:l.pos}:{top:l.pos},children:l.type==="large"&&l.pos>0&&e.jsx("span",{className:"absolute",style:t==="horizontal"?{left:"2px",bottom:"100%"}:{top:"-6px",right:"100%",marginRight:"2px",writingMode:"vertical-rl",textOrientation:"sideways"},children:l.pos})},l.pos))})})},Qo=({scrollContainerRef:t})=>{const[r,n]=j.useState({x:0,y:0}),[a,s]=j.useState({width:0,height:0});return j.useEffect(()=>{const i=t.current;if(!i)return;const o=()=>{n({x:i.scrollLeft,y:i.scrollTop})},l=new ResizeObserver(()=>{s({width:i.offsetWidth,height:i.offsetHeight})});return i.addEventListener("scroll",o),l.observe(i),o(),s({width:i.offsetWidth,height:i.offsetHeight}),()=>{i.removeEventListener("scroll",o),l.unobserve(i)}},[t]),e.jsxs("div",{className:"absolute -top-4 -left-4 right-0 bottom-0 pointer-events-none z-20",children:[e.jsx("div",{className:"sticky top-0 left-0 w-full h-6 z-10",children:e.jsx(ar,{type:"horizontal",scrollPos:r,containerSize:a})}),e.jsx("div",{className:"sticky top-0 left-0 h-full w-6 z-10",children:e.jsx(ar,{type:"vertical",scrollPos:r,containerSize:a})}),e.jsx("div",{className:"absolute top-0 left-0 w-6 h-6 bg-background z-20"})]})};export{Ko as C,Ao as D,Xo as E,Fo as H,Vo as L,Mo as P,Wo as R,Go as S,Uo as a,$o as b,Bo as c,Yo as d,Qo as e,Lo as f,Ho as u};
